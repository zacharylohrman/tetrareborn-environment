/*! For license information please see compiled.js.LICENSE.txt */
(()=>{var t,e,n={766:(t,e,n)=>{var r;!function(){"use strict";var o=function(){this.init()};o.prototype={init:function(){var t=this||i;return t._counter=1e3,t._html5AudioPool=[],t.html5PoolSize=10,t._codecs={},t._howls=[],t._muted=!1,t._volume=1,t._canPlayEvent="canplaythrough",t._navigator="undefined"!=typeof window&&window.navigator?window.navigator:null,t.masterGain=null,t.noAudio=!1,t.usingWebAudio=!0,t.autoSuspend=!0,t.ctx=null,t.autoUnlock=!0,t._setup(),t},volume:function(t){var e=this||i;if(t=parseFloat(t),e.ctx||d(),void 0!==t&&t>=0&&t<=1){if(e._volume=t,e._muted)return e;e.usingWebAudio&&e.masterGain.gain.setValueAtTime(t,i.ctx.currentTime);for(var n=0;n<e._howls.length;n++)if(!e._howls[n]._webAudio)for(var r=e._howls[n]._getSoundIds(),o=0;o<r.length;o++){var s=e._howls[n]._soundById(r[o]);s&&s._node&&(s._node.volume=s._volume*t)}return e}return e._volume},mute:function(t){var e=this||i;e.ctx||d(),e._muted=t,e.usingWebAudio&&e.masterGain.gain.setValueAtTime(t?0:e._volume,i.ctx.currentTime);for(var n=0;n<e._howls.length;n++)if(!e._howls[n]._webAudio)for(var r=e._howls[n]._getSoundIds(),o=0;o<r.length;o++){var s=e._howls[n]._soundById(r[o]);s&&s._node&&(s._node.muted=!!t||s._muted)}return e},stop:function(){for(var t=this||i,e=0;e<t._howls.length;e++)t._howls[e].stop();return t},unload:function(){for(var t=this||i,e=t._howls.length-1;e>=0;e--)t._howls[e].unload();return t.usingWebAudio&&t.ctx&&void 0!==t.ctx.close&&(t.ctx.close(),t.ctx=null,d()),t},codecs:function(t){return(this||i)._codecs[t.replace(/^x-/,"")]},_setup:function(){var t=this||i;if(t.state=t.ctx&&t.ctx.state||"suspended",t._autoSuspend(),!t.usingWebAudio)if("undefined"!=typeof Audio)try{void 0===(new Audio).oncanplaythrough&&(t._canPlayEvent="canplay")}catch(e){t.noAudio=!0}else t.noAudio=!0;try{(new Audio).muted&&(t.noAudio=!0)}catch(t){}return t.noAudio||t._setupCodecs(),t},_setupCodecs:function(){var t=this||i,e=null;try{e="undefined"!=typeof Audio?new Audio:null}catch(e){return t}if(!e||"function"!=typeof e.canPlayType)return t;var n=e.canPlayType("audio/mpeg;").replace(/^no$/,""),r=t._navigator&&t._navigator.userAgent.match(/OPR\/([0-6].)/g),o=r&&parseInt(r[0].split("/")[1],10)<33;return t._codecs={mp3:!(o||!n&&!e.canPlayType("audio/mp3;").replace(/^no$/,"")),mpeg:!!n,opus:!!e.canPlayType('audio/ogg; codecs="opus"').replace(/^no$/,""),ogg:!!e.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),oga:!!e.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),wav:!!(e.canPlayType('audio/wav; codecs="1"')||e.canPlayType("audio/wav")).replace(/^no$/,""),aac:!!e.canPlayType("audio/aac;").replace(/^no$/,""),caf:!!e.canPlayType("audio/x-caf;").replace(/^no$/,""),m4a:!!(e.canPlayType("audio/x-m4a;")||e.canPlayType("audio/m4a;")||e.canPlayType("audio/aac;")).replace(/^no$/,""),m4b:!!(e.canPlayType("audio/x-m4b;")||e.canPlayType("audio/m4b;")||e.canPlayType("audio/aac;")).replace(/^no$/,""),mp4:!!(e.canPlayType("audio/x-mp4;")||e.canPlayType("audio/mp4;")||e.canPlayType("audio/aac;")).replace(/^no$/,""),weba:!!e.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,""),webm:!!e.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,""),dolby:!!e.canPlayType('audio/mp4; codecs="ec-3"').replace(/^no$/,""),flac:!!(e.canPlayType("audio/x-flac;")||e.canPlayType("audio/flac;")).replace(/^no$/,"")},t},_unlockAudio:function(){var t=this||i;if(!t._audioUnlocked&&t.ctx){t._audioUnlocked=!1,t.autoUnlock=!1,t._mobileUnloaded||44100===t.ctx.sampleRate||(t._mobileUnloaded=!0,t.unload()),t._scratchBuffer=t.ctx.createBuffer(1,1,22050);var e=function(n){for(;t._html5AudioPool.length<t.html5PoolSize;)try{var r=new Audio;r._unlocked=!0,t._releaseHtml5Audio(r)}catch(n){t.noAudio=!0;break}for(var o=0;o<t._howls.length;o++)if(!t._howls[o]._webAudio)for(var i=t._howls[o]._getSoundIds(),s=0;s<i.length;s++){var a=t._howls[o]._soundById(i[s]);a&&a._node&&!a._node._unlocked&&(a._node._unlocked=!0,a._node.load())}t._autoResume();var u=t.ctx.createBufferSource();u.buffer=t._scratchBuffer,u.connect(t.ctx.destination),void 0===u.start?u.noteOn(0):u.start(0),"function"==typeof t.ctx.resume&&t.ctx.resume(),u.onended=function(){u.disconnect(0),t._audioUnlocked=!0,document.removeEventListener("touchstart",e,!0),document.removeEventListener("touchend",e,!0),document.removeEventListener("click",e,!0);for(var n=0;n<t._howls.length;n++)t._howls[n]._emit("unlock")}};return document.addEventListener("touchstart",e,!0),document.addEventListener("touchend",e,!0),document.addEventListener("click",e,!0),t}},_obtainHtml5Audio:function(){var t=this||i;if(t._html5AudioPool.length)return t._html5AudioPool.pop();var e=(new Audio).play();return e&&"undefined"!=typeof Promise&&(e instanceof Promise||"function"==typeof e.then)&&e.catch((function(){console.warn("HTML5 Audio pool exhausted, returning potentially locked audio object.")})),new Audio},_releaseHtml5Audio:function(t){var e=this||i;return t._unlocked&&e._html5AudioPool.push(t),e},_autoSuspend:function(){var t=this;if(t.autoSuspend&&t.ctx&&void 0!==t.ctx.suspend&&i.usingWebAudio){for(var e=0;e<t._howls.length;e++)if(t._howls[e]._webAudio)for(var n=0;n<t._howls[e]._sounds.length;n++)if(!t._howls[e]._sounds[n]._paused)return t;return t._suspendTimer&&clearTimeout(t._suspendTimer),t._suspendTimer=setTimeout((function(){if(t.autoSuspend){t._suspendTimer=null,t.state="suspending";var e=function(){t.state="suspended",t._resumeAfterSuspend&&(delete t._resumeAfterSuspend,t._autoResume())};t.ctx.suspend().then(e,e)}}),3e4),t}},_autoResume:function(){var t=this;if(t.ctx&&void 0!==t.ctx.resume&&i.usingWebAudio)return"running"===t.state&&"interrupted"!==t.ctx.state&&t._suspendTimer?(clearTimeout(t._suspendTimer),t._suspendTimer=null):"suspended"===t.state||"running"===t.state&&"interrupted"===t.ctx.state?(t.ctx.resume().then((function(){t.state="running";for(var e=0;e<t._howls.length;e++)t._howls[e]._emit("resume")})),t._suspendTimer&&(clearTimeout(t._suspendTimer),t._suspendTimer=null)):"suspending"===t.state&&(t._resumeAfterSuspend=!0),t}};var i=new o,s=function(t){t.src&&0!==t.src.length?this.init(t):console.error("An array of source files must be passed with any new Howl.")};s.prototype={init:function(t){var e=this;return i.ctx||d(),e._autoplay=t.autoplay||!1,e._format="string"!=typeof t.format?t.format:[t.format],e._html5=t.html5||!1,e._muted=t.mute||!1,e._loop=t.loop||!1,e._pool=t.pool||5,e._preload="boolean"!=typeof t.preload&&"metadata"!==t.preload||t.preload,e._rate=t.rate||1,e._sprite=t.sprite||{},e._src="string"!=typeof t.src?t.src:[t.src],e._volume=void 0!==t.volume?t.volume:1,e._xhr={method:t.xhr&&t.xhr.method?t.xhr.method:"GET",headers:t.xhr&&t.xhr.headers?t.xhr.headers:null,withCredentials:!(!t.xhr||!t.xhr.withCredentials)&&t.xhr.withCredentials},e._duration=0,e._state="unloaded",e._sounds=[],e._endTimers={},e._queue=[],e._playLock=!1,e._onend=t.onend?[{fn:t.onend}]:[],e._onfade=t.onfade?[{fn:t.onfade}]:[],e._onload=t.onload?[{fn:t.onload}]:[],e._onloaderror=t.onloaderror?[{fn:t.onloaderror}]:[],e._onplayerror=t.onplayerror?[{fn:t.onplayerror}]:[],e._onpause=t.onpause?[{fn:t.onpause}]:[],e._onplay=t.onplay?[{fn:t.onplay}]:[],e._onstop=t.onstop?[{fn:t.onstop}]:[],e._onmute=t.onmute?[{fn:t.onmute}]:[],e._onvolume=t.onvolume?[{fn:t.onvolume}]:[],e._onrate=t.onrate?[{fn:t.onrate}]:[],e._onseek=t.onseek?[{fn:t.onseek}]:[],e._onunlock=t.onunlock?[{fn:t.onunlock}]:[],e._onresume=[],e._webAudio=i.usingWebAudio&&!e._html5,void 0!==i.ctx&&i.ctx&&i.autoUnlock&&i._unlockAudio(),i._howls.push(e),e._autoplay&&e._queue.push({event:"play",action:function(){e.play()}}),e._preload&&"none"!==e._preload&&e.load(),e},load:function(){var t=this,e=null;if(i.noAudio)t._emit("loaderror",null,"No audio support.");else{"string"==typeof t._src&&(t._src=[t._src]);for(var n=0;n<t._src.length;n++){var r,o;if(t._format&&t._format[n])r=t._format[n];else{if("string"!=typeof(o=t._src[n])){t._emit("loaderror",null,"Non-string found in selected audio sources - ignoring.");continue}(r=/^data:audio\/([^;,]+);/i.exec(o))||(r=/\.([^.]+)$/.exec(o.split("?",1)[0])),r&&(r=r[1].toLowerCase())}if(r||console.warn('No file extension was found. Consider using the "format" property or specify an extension.'),r&&i.codecs(r)){e=t._src[n];break}}if(e)return t._src=e,t._state="loading","https:"===window.location.protocol&&"http:"===e.slice(0,5)&&(t._html5=!0,t._webAudio=!1),new a(t),t._webAudio&&l(t),t;t._emit("loaderror",null,"No codec support for selected audio sources.")}},play:function(t,e){var n=this,r=null;if("number"==typeof t)r=t,t=null;else{if("string"==typeof t&&"loaded"===n._state&&!n._sprite[t])return null;if(void 0===t&&(t="__default",!n._playLock)){for(var o=0,s=0;s<n._sounds.length;s++)n._sounds[s]._paused&&!n._sounds[s]._ended&&(o++,r=n._sounds[s]._id);1===o?t=null:r=null}}var a=r?n._soundById(r):n._inactiveSound();if(!a)return null;if(r&&!t&&(t=a._sprite||"__default"),"loaded"!==n._state){a._sprite=t,a._ended=!1;var u=a._id;return n._queue.push({event:"play",action:function(){n.play(u)}}),u}if(r&&!a._paused)return e||n._loadQueue("play"),a._id;n._webAudio&&i._autoResume();var l=Math.max(0,a._seek>0?a._seek:n._sprite[t][0]/1e3),c=Math.max(0,(n._sprite[t][0]+n._sprite[t][1])/1e3-l),h=1e3*c/Math.abs(a._rate),f=n._sprite[t][0]/1e3,d=(n._sprite[t][0]+n._sprite[t][1])/1e3;a._sprite=t,a._ended=!1;var p=function(){a._paused=!1,a._seek=l,a._start=f,a._stop=d,a._loop=!(!a._loop&&!n._sprite[t][2])};if(!(l>=d)){var g=a._node;if(n._webAudio){var m=function(){n._playLock=!1,p(),n._refreshBuffer(a);var t=a._muted||n._muted?0:a._volume;g.gain.setValueAtTime(t,i.ctx.currentTime),a._playStart=i.ctx.currentTime,void 0===g.bufferSource.start?a._loop?g.bufferSource.noteGrainOn(0,l,86400):g.bufferSource.noteGrainOn(0,l,c):a._loop?g.bufferSource.start(0,l,86400):g.bufferSource.start(0,l,c),h!==1/0&&(n._endTimers[a._id]=setTimeout(n._ended.bind(n,a),h)),e||setTimeout((function(){n._emit("play",a._id),n._loadQueue()}),0)};"running"===i.state&&"interrupted"!==i.ctx.state?m():(n._playLock=!0,n.once("resume",m),n._clearTimer(a._id))}else{var y=function(){g.currentTime=l,g.muted=a._muted||n._muted||i._muted||g.muted,g.volume=a._volume*i.volume(),g.playbackRate=a._rate;try{var r=g.play();if(r&&"undefined"!=typeof Promise&&(r instanceof Promise||"function"==typeof r.then)?(n._playLock=!0,p(),r.then((function(){n._playLock=!1,g._unlocked=!0,e||(n._emit("play",a._id),n._loadQueue())})).catch((function(){n._playLock=!1,n._emit("playerror",a._id,"Playback was unable to start. This is most commonly an issue on mobile devices and Chrome where playback was not within a user interaction."),a._ended=!0,a._paused=!0}))):e||(n._playLock=!1,p(),n._emit("play",a._id),n._loadQueue()),g.playbackRate=a._rate,g.paused)return void n._emit("playerror",a._id,"Playback was unable to start. This is most commonly an issue on mobile devices and Chrome where playback was not within a user interaction.");"__default"!==t||a._loop?n._endTimers[a._id]=setTimeout(n._ended.bind(n,a),h):(n._endTimers[a._id]=function(){n._ended(a),g.removeEventListener("ended",n._endTimers[a._id],!1)},g.addEventListener("ended",n._endTimers[a._id],!1))}catch(t){n._emit("playerror",a._id,t)}};"data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAAABkYXRhAgAAAAEA"===g.src&&(g.src=n._src,g.load());var v=window&&window.ejecta||!g.readyState&&i._navigator.isCocoonJS;if(g.readyState>=3||v)y();else{n._playLock=!0;var _=function(){y(),g.removeEventListener(i._canPlayEvent,_,!1)};g.addEventListener(i._canPlayEvent,_,!1),n._clearTimer(a._id)}}return a._id}n._ended(a)},pause:function(t){var e=this;if("loaded"!==e._state||e._playLock)return e._queue.push({event:"pause",action:function(){e.pause(t)}}),e;for(var n=e._getSoundIds(t),r=0;r<n.length;r++){e._clearTimer(n[r]);var o=e._soundById(n[r]);if(o&&!o._paused&&(o._seek=e.seek(n[r]),o._rateSeek=0,o._paused=!0,e._stopFade(n[r]),o._node))if(e._webAudio){if(!o._node.bufferSource)continue;void 0===o._node.bufferSource.stop?o._node.bufferSource.noteOff(0):o._node.bufferSource.stop(0),e._cleanBuffer(o._node)}else isNaN(o._node.duration)&&o._node.duration!==1/0||o._node.pause();arguments[1]||e._emit("pause",o?o._id:null)}return e},stop:function(t,e){var n=this;if("loaded"!==n._state||n._playLock)return n._queue.push({event:"stop",action:function(){n.stop(t)}}),n;for(var r=n._getSoundIds(t),o=0;o<r.length;o++){n._clearTimer(r[o]);var i=n._soundById(r[o]);i&&(i._seek=i._start||0,i._rateSeek=0,i._paused=!0,i._ended=!0,n._stopFade(r[o]),i._node&&(n._webAudio?i._node.bufferSource&&(void 0===i._node.bufferSource.stop?i._node.bufferSource.noteOff(0):i._node.bufferSource.stop(0),n._cleanBuffer(i._node)):isNaN(i._node.duration)&&i._node.duration!==1/0||(i._node.currentTime=i._start||0,i._node.pause(),i._node.duration===1/0&&n._clearSound(i._node))),e||n._emit("stop",i._id))}return n},mute:function(t,e){var n=this;if("loaded"!==n._state||n._playLock)return n._queue.push({event:"mute",action:function(){n.mute(t,e)}}),n;if(void 0===e){if("boolean"!=typeof t)return n._muted;n._muted=t}for(var r=n._getSoundIds(e),o=0;o<r.length;o++){var s=n._soundById(r[o]);s&&(s._muted=t,s._interval&&n._stopFade(s._id),n._webAudio&&s._node?s._node.gain.setValueAtTime(t?0:s._volume,i.ctx.currentTime):s._node&&(s._node.muted=!!i._muted||t),n._emit("mute",s._id))}return n},volume:function(){var t,e,n,r=this,o=arguments;if(0===o.length)return r._volume;if(1===o.length||2===o.length&&void 0===o[1]){var s=r._getSoundIds(),a=s.indexOf(o[0]);a>=0?e=parseInt(o[0],10):t=parseFloat(o[0])}else o.length>=2&&(t=parseFloat(o[0]),e=parseInt(o[1],10));if(!(void 0!==t&&t>=0&&t<=1))return(n=e?r._soundById(e):r._sounds[0])?n._volume:0;if("loaded"!==r._state||r._playLock)return r._queue.push({event:"volume",action:function(){r.volume.apply(r,o)}}),r;void 0===e&&(r._volume=t),e=r._getSoundIds(e);for(var u=0;u<e.length;u++)(n=r._soundById(e[u]))&&(n._volume=t,o[2]||r._stopFade(e[u]),r._webAudio&&n._node&&!n._muted?n._node.gain.setValueAtTime(t,i.ctx.currentTime):n._node&&!n._muted&&(n._node.volume=t*i.volume()),r._emit("volume",n._id));return r},fade:function(t,e,n,r){var o=this;if("loaded"!==o._state||o._playLock)return o._queue.push({event:"fade",action:function(){o.fade(t,e,n,r)}}),o;t=Math.min(Math.max(0,parseFloat(t)),1),e=Math.min(Math.max(0,parseFloat(e)),1),n=parseFloat(n),o.volume(t,r);for(var s=o._getSoundIds(r),a=0;a<s.length;a++){var u=o._soundById(s[a]);if(u){if(r||o._stopFade(s[a]),o._webAudio&&!u._muted){var l=i.ctx.currentTime,c=l+n/1e3;u._volume=t,u._node.gain.setValueAtTime(t,l),u._node.gain.linearRampToValueAtTime(e,c)}o._startFadeInterval(u,t,e,n,s[a],void 0===r)}}return o},_startFadeInterval:function(t,e,n,r,o,i){var s=this,a=e,u=n-e,l=Math.abs(u/.01),c=Math.max(4,l>0?r/l:r),h=Date.now();t._fadeTo=n,t._interval=setInterval((function(){var o=(Date.now()-h)/r;h=Date.now(),a+=u*o,a=Math.round(100*a)/100,a=u<0?Math.max(n,a):Math.min(n,a),s._webAudio?t._volume=a:s.volume(a,t._id,!0),i&&(s._volume=a),(n<e&&a<=n||n>e&&a>=n)&&(clearInterval(t._interval),t._interval=null,t._fadeTo=null,s.volume(n,t._id),s._emit("fade",t._id))}),c)},_stopFade:function(t){var e=this,n=e._soundById(t);return n&&n._interval&&(e._webAudio&&n._node.gain.cancelScheduledValues(i.ctx.currentTime),clearInterval(n._interval),n._interval=null,e.volume(n._fadeTo,t),n._fadeTo=null,e._emit("fade",t)),e},loop:function(){var t,e,n,r=this,o=arguments;if(0===o.length)return r._loop;if(1===o.length){if("boolean"!=typeof o[0])return!!(n=r._soundById(parseInt(o[0],10)))&&n._loop;t=o[0],r._loop=t}else 2===o.length&&(t=o[0],e=parseInt(o[1],10));for(var i=r._getSoundIds(e),s=0;s<i.length;s++)(n=r._soundById(i[s]))&&(n._loop=t,r._webAudio&&n._node&&n._node.bufferSource&&(n._node.bufferSource.loop=t,t&&(n._node.bufferSource.loopStart=n._start||0,n._node.bufferSource.loopEnd=n._stop)));return r},rate:function(){var t,e,n,r=this,o=arguments;if(0===o.length)e=r._sounds[0]._id;else if(1===o.length){var s=r._getSoundIds(),a=s.indexOf(o[0]);a>=0?e=parseInt(o[0],10):t=parseFloat(o[0])}else 2===o.length&&(t=parseFloat(o[0]),e=parseInt(o[1],10));if("number"!=typeof t)return(n=r._soundById(e))?n._rate:r._rate;if("loaded"!==r._state||r._playLock)return r._queue.push({event:"rate",action:function(){r.rate.apply(r,o)}}),r;void 0===e&&(r._rate=t),e=r._getSoundIds(e);for(var u=0;u<e.length;u++)if(n=r._soundById(e[u])){r.playing(e[u])&&(n._rateSeek=r.seek(e[u]),n._playStart=r._webAudio?i.ctx.currentTime:n._playStart),n._rate=t,r._webAudio&&n._node&&n._node.bufferSource?n._node.bufferSource.playbackRate.setValueAtTime(t,i.ctx.currentTime):n._node&&(n._node.playbackRate=t);var l=r.seek(e[u]),c=(r._sprite[n._sprite][0]+r._sprite[n._sprite][1])/1e3-l,h=1e3*c/Math.abs(n._rate);!r._endTimers[e[u]]&&n._paused||(r._clearTimer(e[u]),r._endTimers[e[u]]=setTimeout(r._ended.bind(r,n),h)),r._emit("rate",n._id)}return r},seek:function(){var t,e,n=this,r=arguments;if(0===r.length)e=n._sounds[0]._id;else if(1===r.length){var o=n._getSoundIds(),s=o.indexOf(r[0]);s>=0?e=parseInt(r[0],10):n._sounds.length&&(e=n._sounds[0]._id,t=parseFloat(r[0]))}else 2===r.length&&(t=parseFloat(r[0]),e=parseInt(r[1],10));if(void 0===e)return n;if("number"==typeof t&&("loaded"!==n._state||n._playLock))return n._queue.push({event:"seek",action:function(){n.seek.apply(n,r)}}),n;var a=n._soundById(e);if(a){if(!("number"==typeof t&&t>=0)){if(n._webAudio){var u=n.playing(e)?i.ctx.currentTime-a._playStart:0,l=a._rateSeek?a._rateSeek-a._seek:0;return a._seek+(l+u*Math.abs(a._rate))}return a._node.currentTime}var c=n.playing(e);c&&n.pause(e,!0),a._seek=t,a._ended=!1,n._clearTimer(e),n._webAudio||!a._node||isNaN(a._node.duration)||(a._node.currentTime=t);var h=function(){n._emit("seek",e),c&&n.play(e,!0)};if(c&&!n._webAudio){var f=function(){n._playLock?setTimeout(f,0):h()};setTimeout(f,0)}else h()}return n},playing:function(t){var e=this;if("number"==typeof t){var n=e._soundById(t);return!!n&&!n._paused}for(var r=0;r<e._sounds.length;r++)if(!e._sounds[r]._paused)return!0;return!1},duration:function(t){var e=this,n=e._duration,r=e._soundById(t);return r&&(n=e._sprite[r._sprite][1]/1e3),n},state:function(){return this._state},unload:function(){for(var t=this,e=t._sounds,n=0;n<e.length;n++)e[n]._paused||t.stop(e[n]._id),t._webAudio||(t._clearSound(e[n]._node),e[n]._node.removeEventListener("error",e[n]._errorFn,!1),e[n]._node.removeEventListener(i._canPlayEvent,e[n]._loadFn,!1),e[n]._node.removeEventListener("ended",e[n]._endFn,!1),i._releaseHtml5Audio(e[n]._node)),delete e[n]._node,t._clearTimer(e[n]._id);var r=i._howls.indexOf(t);r>=0&&i._howls.splice(r,1);var o=!0;for(n=0;n<i._howls.length;n++)if(i._howls[n]._src===t._src||t._src.indexOf(i._howls[n]._src)>=0){o=!1;break}return u&&o&&delete u[t._src],i.noAudio=!1,t._state="unloaded",t._sounds=[],t=null,null},on:function(t,e,n,r){var o=this["_on"+t];return"function"==typeof e&&o.push(r?{id:n,fn:e,once:r}:{id:n,fn:e}),this},off:function(t,e,n){var r=this,o=r["_on"+t],i=0;if("number"==typeof e&&(n=e,e=null),e||n)for(i=0;i<o.length;i++){var s=n===o[i].id;if(e===o[i].fn&&s||!e&&s){o.splice(i,1);break}}else if(t)r["_on"+t]=[];else{var a=Object.keys(r);for(i=0;i<a.length;i++)0===a[i].indexOf("_on")&&Array.isArray(r[a[i]])&&(r[a[i]]=[])}return r},once:function(t,e,n){return this.on(t,e,n,1),this},_emit:function(t,e,n){for(var r=this,o=r["_on"+t],i=o.length-1;i>=0;i--)o[i].id&&o[i].id!==e&&"load"!==t||(setTimeout(function(t){t.call(this,e,n)}.bind(r,o[i].fn),0),o[i].once&&r.off(t,o[i].fn,o[i].id));return r._loadQueue(t),r},_loadQueue:function(t){var e=this;if(e._queue.length>0){var n=e._queue[0];n.event===t&&(e._queue.shift(),e._loadQueue()),t||n.action()}return e},_ended:function(t){var e=this,n=t._sprite;if(!e._webAudio&&t._node&&!t._node.paused&&!t._node.ended&&t._node.currentTime<t._stop)return setTimeout(e._ended.bind(e,t),100),e;var r=!(!t._loop&&!e._sprite[n][2]);if(e._emit("end",t._id),!e._webAudio&&r&&e.stop(t._id,!0).play(t._id),e._webAudio&&r){e._emit("play",t._id),t._seek=t._start||0,t._rateSeek=0,t._playStart=i.ctx.currentTime;var o=1e3*(t._stop-t._start)/Math.abs(t._rate);e._endTimers[t._id]=setTimeout(e._ended.bind(e,t),o)}return e._webAudio&&!r&&(t._paused=!0,t._ended=!0,t._seek=t._start||0,t._rateSeek=0,e._clearTimer(t._id),e._cleanBuffer(t._node),i._autoSuspend()),e._webAudio||r||e.stop(t._id,!0),e},_clearTimer:function(t){var e=this;if(e._endTimers[t]){if("function"!=typeof e._endTimers[t])clearTimeout(e._endTimers[t]);else{var n=e._soundById(t);n&&n._node&&n._node.removeEventListener("ended",e._endTimers[t],!1)}delete e._endTimers[t]}return e},_soundById:function(t){for(var e=this,n=0;n<e._sounds.length;n++)if(t===e._sounds[n]._id)return e._sounds[n];return null},_inactiveSound:function(){var t=this;t._drain();for(var e=0;e<t._sounds.length;e++)if(t._sounds[e]._ended)return t._sounds[e].reset();return new a(t)},_drain:function(){var t=this,e=t._pool,n=0,r=0;if(!(t._sounds.length<e)){for(r=0;r<t._sounds.length;r++)t._sounds[r]._ended&&n++;for(r=t._sounds.length-1;r>=0;r--){if(n<=e)return;t._sounds[r]._ended&&(t._webAudio&&t._sounds[r]._node&&t._sounds[r]._node.disconnect(0),t._sounds.splice(r,1),n--)}}},_getSoundIds:function(t){if(void 0===t){for(var e=[],n=0;n<this._sounds.length;n++)e.push(this._sounds[n]._id);return e}return[t]},_refreshBuffer:function(t){return t._node.bufferSource=i.ctx.createBufferSource(),t._node.bufferSource.buffer=u[this._src],t._panner?t._node.bufferSource.connect(t._panner):t._node.bufferSource.connect(t._node),t._node.bufferSource.loop=t._loop,t._loop&&(t._node.bufferSource.loopStart=t._start||0,t._node.bufferSource.loopEnd=t._stop||0),t._node.bufferSource.playbackRate.setValueAtTime(t._rate,i.ctx.currentTime),this},_cleanBuffer:function(t){var e=i._navigator&&i._navigator.vendor.indexOf("Apple")>=0;if(i._scratchBuffer&&t.bufferSource&&(t.bufferSource.onended=null,t.bufferSource.disconnect(0),e))try{t.bufferSource.buffer=i._scratchBuffer}catch(t){}return t.bufferSource=null,this},_clearSound:function(t){/MSIE |Trident\//.test(i._navigator&&i._navigator.userAgent)||(t.src="data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAAABkYXRhAgAAAAEA")}};var a=function(t){this._parent=t,this.init()};a.prototype={init:function(){var t=this,e=t._parent;return t._muted=e._muted,t._loop=e._loop,t._volume=e._volume,t._rate=e._rate,t._seek=0,t._paused=!0,t._ended=!0,t._sprite="__default",t._id=++i._counter,e._sounds.push(t),t.create(),t},create:function(){var t=this,e=t._parent,n=i._muted||t._muted||t._parent._muted?0:t._volume;return e._webAudio?(t._node=void 0===i.ctx.createGain?i.ctx.createGainNode():i.ctx.createGain(),t._node.gain.setValueAtTime(n,i.ctx.currentTime),t._node.paused=!0,t._node.connect(i.masterGain)):i.noAudio||(t._node=i._obtainHtml5Audio(),t._errorFn=t._errorListener.bind(t),t._node.addEventListener("error",t._errorFn,!1),t._loadFn=t._loadListener.bind(t),t._node.addEventListener(i._canPlayEvent,t._loadFn,!1),t._endFn=t._endListener.bind(t),t._node.addEventListener("ended",t._endFn,!1),t._node.src=e._src,t._node.preload=!0===e._preload?"auto":e._preload,t._node.volume=n*i.volume(),t._node.load()),t},reset:function(){var t=this,e=t._parent;return t._muted=e._muted,t._loop=e._loop,t._volume=e._volume,t._rate=e._rate,t._seek=0,t._rateSeek=0,t._paused=!0,t._ended=!0,t._sprite="__default",t._id=++i._counter,t},_errorListener:function(){var t=this;t._parent._emit("loaderror",t._id,t._node.error?t._node.error.code:0),t._node.removeEventListener("error",t._errorFn,!1)},_loadListener:function(){var t=this,e=t._parent;e._duration=Math.ceil(10*t._node.duration)/10,0===Object.keys(e._sprite).length&&(e._sprite={__default:[0,1e3*e._duration]}),"loaded"!==e._state&&(e._state="loaded",e._emit("load"),e._loadQueue()),t._node.removeEventListener(i._canPlayEvent,t._loadFn,!1)},_endListener:function(){var t=this,e=t._parent;e._duration===1/0&&(e._duration=Math.ceil(10*t._node.duration)/10,e._sprite.__default[1]===1/0&&(e._sprite.__default[1]=1e3*e._duration),e._ended(t)),t._node.removeEventListener("ended",t._endFn,!1)}};var u={},l=function(t){var e=t._src;if(u[e])return t._duration=u[e].duration,void f(t);if(/^data:[^;]+;base64,/.test(e)){for(var n=atob(e.split(",")[1]),r=new Uint8Array(n.length),o=0;o<n.length;++o)r[o]=n.charCodeAt(o);h(r.buffer,t)}else{var i=new XMLHttpRequest;i.open(t._xhr.method,e,!0),i.withCredentials=t._xhr.withCredentials,i.responseType="arraybuffer",t._xhr.headers&&Object.keys(t._xhr.headers).forEach((function(e){i.setRequestHeader(e,t._xhr.headers[e])})),i.onload=function(){var e=(i.status+"")[0];"0"===e||"2"===e||"3"===e?h(i.response,t):t._emit("loaderror",null,"Failed loading audio file with status: "+i.status+".")},i.onerror=function(){t._webAudio&&(t._html5=!0,t._webAudio=!1,t._sounds=[],delete u[e],t.load())},c(i)}},c=function(t){try{t.send()}catch(e){t.onerror()}},h=function(t,e){var n=function(){e._emit("loaderror",null,"Decoding audio data failed.")},r=function(t){t&&e._sounds.length>0?(u[e._src]=t,f(e,t)):n()};"undefined"!=typeof Promise&&1===i.ctx.decodeAudioData.length?i.ctx.decodeAudioData(t).then(r).catch(n):i.ctx.decodeAudioData(t,r,n)},f=function(t,e){e&&!t._duration&&(t._duration=e.duration),0===Object.keys(t._sprite).length&&(t._sprite={__default:[0,1e3*t._duration]}),"loaded"!==t._state&&(t._state="loaded",t._emit("load"),t._loadQueue())},d=function(){if(i.usingWebAudio){try{"undefined"!=typeof AudioContext?i.ctx=new AudioContext:"undefined"!=typeof webkitAudioContext?i.ctx=new webkitAudioContext:i.usingWebAudio=!1}catch(t){i.usingWebAudio=!1}i.ctx||(i.usingWebAudio=!1);var t=/iP(hone|od|ad)/.test(i._navigator&&i._navigator.platform),e=i._navigator&&i._navigator.appVersion.match(/OS (\d+)_(\d+)_?(\d+)?/),n=e?parseInt(e[1],10):null;if(t&&n&&n<9){var r=/safari/.test(i._navigator&&i._navigator.userAgent.toLowerCase());i._navigator&&!r&&(i.usingWebAudio=!1)}i.usingWebAudio&&(i.masterGain=void 0===i.ctx.createGain?i.ctx.createGainNode():i.ctx.createGain(),i.masterGain.gain.setValueAtTime(i._muted?0:i._volume,i.ctx.currentTime),i.masterGain.connect(i.ctx.destination)),i._setup()}};void 0===(r=function(){return{Howler:i,Howl:s}}.apply(e,[]))||(t.exports=r),e.Howler=i,e.Howl=s,void 0!==n.g?(n.g.HowlerGlobal=o,n.g.Howler=i,n.g.Howl=s,n.g.Sound=a):"undefined"!=typeof window&&(window.HowlerGlobal=o,window.Howler=i,window.Howl=s,window.Sound=a)}(),function(){"use strict";var t;HowlerGlobal.prototype._pos=[0,0,0],HowlerGlobal.prototype._orientation=[0,0,-1,0,1,0],HowlerGlobal.prototype.stereo=function(t){var e=this;if(!e.ctx||!e.ctx.listener)return e;for(var n=e._howls.length-1;n>=0;n--)e._howls[n].stereo(t);return e},HowlerGlobal.prototype.pos=function(t,e,n){var r=this;return r.ctx&&r.ctx.listener?(e="number"!=typeof e?r._pos[1]:e,n="number"!=typeof n?r._pos[2]:n,"number"!=typeof t?r._pos:(r._pos=[t,e,n],void 0!==r.ctx.listener.positionX?(r.ctx.listener.positionX.setTargetAtTime(r._pos[0],Howler.ctx.currentTime,.1),r.ctx.listener.positionY.setTargetAtTime(r._pos[1],Howler.ctx.currentTime,.1),r.ctx.listener.positionZ.setTargetAtTime(r._pos[2],Howler.ctx.currentTime,.1)):r.ctx.listener.setPosition(r._pos[0],r._pos[1],r._pos[2]),r)):r},HowlerGlobal.prototype.orientation=function(t,e,n,r,o,i){var s=this;if(!s.ctx||!s.ctx.listener)return s;var a=s._orientation;return e="number"!=typeof e?a[1]:e,n="number"!=typeof n?a[2]:n,r="number"!=typeof r?a[3]:r,o="number"!=typeof o?a[4]:o,i="number"!=typeof i?a[5]:i,"number"!=typeof t?a:(s._orientation=[t,e,n,r,o,i],void 0!==s.ctx.listener.forwardX?(s.ctx.listener.forwardX.setTargetAtTime(t,Howler.ctx.currentTime,.1),s.ctx.listener.forwardY.setTargetAtTime(e,Howler.ctx.currentTime,.1),s.ctx.listener.forwardZ.setTargetAtTime(n,Howler.ctx.currentTime,.1),s.ctx.listener.upX.setTargetAtTime(r,Howler.ctx.currentTime,.1),s.ctx.listener.upY.setTargetAtTime(o,Howler.ctx.currentTime,.1),s.ctx.listener.upZ.setTargetAtTime(i,Howler.ctx.currentTime,.1)):s.ctx.listener.setOrientation(t,e,n,r,o,i),s)},Howl.prototype.init=(t=Howl.prototype.init,function(e){var n=this;return n._orientation=e.orientation||[1,0,0],n._stereo=e.stereo||null,n._pos=e.pos||null,n._pannerAttr={coneInnerAngle:void 0!==e.coneInnerAngle?e.coneInnerAngle:360,coneOuterAngle:void 0!==e.coneOuterAngle?e.coneOuterAngle:360,coneOuterGain:void 0!==e.coneOuterGain?e.coneOuterGain:0,distanceModel:void 0!==e.distanceModel?e.distanceModel:"inverse",maxDistance:void 0!==e.maxDistance?e.maxDistance:1e4,panningModel:void 0!==e.panningModel?e.panningModel:"HRTF",refDistance:void 0!==e.refDistance?e.refDistance:1,rolloffFactor:void 0!==e.rolloffFactor?e.rolloffFactor:1},n._onstereo=e.onstereo?[{fn:e.onstereo}]:[],n._onpos=e.onpos?[{fn:e.onpos}]:[],n._onorientation=e.onorientation?[{fn:e.onorientation}]:[],t.call(this,e)}),Howl.prototype.stereo=function(t,n){var r=this;if(!r._webAudio)return r;if("loaded"!==r._state)return r._queue.push({event:"stereo",action:function(){r.stereo(t,n)}}),r;var o=void 0===Howler.ctx.createStereoPanner?"spatial":"stereo";if(void 0===n){if("number"!=typeof t)return r._stereo;r._stereo=t,r._pos=[t,0,0]}for(var i=r._getSoundIds(n),s=0;s<i.length;s++){var a=r._soundById(i[s]);if(a){if("number"!=typeof t)return a._stereo;a._stereo=t,a._pos=[t,0,0],a._node&&(a._pannerAttr.panningModel="equalpower",a._panner&&a._panner.pan||e(a,o),"spatial"===o?void 0!==a._panner.positionX?(a._panner.positionX.setValueAtTime(t,Howler.ctx.currentTime),a._panner.positionY.setValueAtTime(0,Howler.ctx.currentTime),a._panner.positionZ.setValueAtTime(0,Howler.ctx.currentTime)):a._panner.setPosition(t,0,0):a._panner.pan.setValueAtTime(t,Howler.ctx.currentTime)),r._emit("stereo",a._id)}}return r},Howl.prototype.pos=function(t,n,r,o){var i=this;if(!i._webAudio)return i;if("loaded"!==i._state)return i._queue.push({event:"pos",action:function(){i.pos(t,n,r,o)}}),i;if(n="number"!=typeof n?0:n,r="number"!=typeof r?-.5:r,void 0===o){if("number"!=typeof t)return i._pos;i._pos=[t,n,r]}for(var s=i._getSoundIds(o),a=0;a<s.length;a++){var u=i._soundById(s[a]);if(u){if("number"!=typeof t)return u._pos;u._pos=[t,n,r],u._node&&(u._panner&&!u._panner.pan||e(u,"spatial"),void 0!==u._panner.positionX?(u._panner.positionX.setValueAtTime(t,Howler.ctx.currentTime),u._panner.positionY.setValueAtTime(n,Howler.ctx.currentTime),u._panner.positionZ.setValueAtTime(r,Howler.ctx.currentTime)):u._panner.setPosition(t,n,r)),i._emit("pos",u._id)}}return i},Howl.prototype.orientation=function(t,n,r,o){var i=this;if(!i._webAudio)return i;if("loaded"!==i._state)return i._queue.push({event:"orientation",action:function(){i.orientation(t,n,r,o)}}),i;if(n="number"!=typeof n?i._orientation[1]:n,r="number"!=typeof r?i._orientation[2]:r,void 0===o){if("number"!=typeof t)return i._orientation;i._orientation=[t,n,r]}for(var s=i._getSoundIds(o),a=0;a<s.length;a++){var u=i._soundById(s[a]);if(u){if("number"!=typeof t)return u._orientation;u._orientation=[t,n,r],u._node&&(u._panner||(u._pos||(u._pos=i._pos||[0,0,-.5]),e(u,"spatial")),void 0!==u._panner.orientationX?(u._panner.orientationX.setValueAtTime(t,Howler.ctx.currentTime),u._panner.orientationY.setValueAtTime(n,Howler.ctx.currentTime),u._panner.orientationZ.setValueAtTime(r,Howler.ctx.currentTime)):u._panner.setOrientation(t,n,r)),i._emit("orientation",u._id)}}return i},Howl.prototype.pannerAttr=function(){var t,n,r,o=this,i=arguments;if(!o._webAudio)return o;if(0===i.length)return o._pannerAttr;if(1===i.length){if("object"!=typeof i[0])return(r=o._soundById(parseInt(i[0],10)))?r._pannerAttr:o._pannerAttr;t=i[0],void 0===n&&(t.pannerAttr||(t.pannerAttr={coneInnerAngle:t.coneInnerAngle,coneOuterAngle:t.coneOuterAngle,coneOuterGain:t.coneOuterGain,distanceModel:t.distanceModel,maxDistance:t.maxDistance,refDistance:t.refDistance,rolloffFactor:t.rolloffFactor,panningModel:t.panningModel}),o._pannerAttr={coneInnerAngle:void 0!==t.pannerAttr.coneInnerAngle?t.pannerAttr.coneInnerAngle:o._coneInnerAngle,coneOuterAngle:void 0!==t.pannerAttr.coneOuterAngle?t.pannerAttr.coneOuterAngle:o._coneOuterAngle,coneOuterGain:void 0!==t.pannerAttr.coneOuterGain?t.pannerAttr.coneOuterGain:o._coneOuterGain,distanceModel:void 0!==t.pannerAttr.distanceModel?t.pannerAttr.distanceModel:o._distanceModel,maxDistance:void 0!==t.pannerAttr.maxDistance?t.pannerAttr.maxDistance:o._maxDistance,refDistance:void 0!==t.pannerAttr.refDistance?t.pannerAttr.refDistance:o._refDistance,rolloffFactor:void 0!==t.pannerAttr.rolloffFactor?t.pannerAttr.rolloffFactor:o._rolloffFactor,panningModel:void 0!==t.pannerAttr.panningModel?t.pannerAttr.panningModel:o._panningModel})}else 2===i.length&&(t=i[0],n=parseInt(i[1],10));for(var s=o._getSoundIds(n),a=0;a<s.length;a++)if(r=o._soundById(s[a])){var u=r._pannerAttr;u={coneInnerAngle:void 0!==t.coneInnerAngle?t.coneInnerAngle:u.coneInnerAngle,coneOuterAngle:void 0!==t.coneOuterAngle?t.coneOuterAngle:u.coneOuterAngle,coneOuterGain:void 0!==t.coneOuterGain?t.coneOuterGain:u.coneOuterGain,distanceModel:void 0!==t.distanceModel?t.distanceModel:u.distanceModel,maxDistance:void 0!==t.maxDistance?t.maxDistance:u.maxDistance,refDistance:void 0!==t.refDistance?t.refDistance:u.refDistance,rolloffFactor:void 0!==t.rolloffFactor?t.rolloffFactor:u.rolloffFactor,panningModel:void 0!==t.panningModel?t.panningModel:u.panningModel};var l=r._panner;l?(l.coneInnerAngle=u.coneInnerAngle,l.coneOuterAngle=u.coneOuterAngle,l.coneOuterGain=u.coneOuterGain,l.distanceModel=u.distanceModel,l.maxDistance=u.maxDistance,l.refDistance=u.refDistance,l.rolloffFactor=u.rolloffFactor,l.panningModel=u.panningModel):(r._pos||(r._pos=o._pos||[0,0,-.5]),e(r,"spatial"))}return o},Sound.prototype.init=function(t){return function(){var e=this,n=e._parent;e._orientation=n._orientation,e._stereo=n._stereo,e._pos=n._pos,e._pannerAttr=n._pannerAttr,t.call(this),e._stereo?n.stereo(e._stereo):e._pos&&n.pos(e._pos[0],e._pos[1],e._pos[2],e._id)}}(Sound.prototype.init),Sound.prototype.reset=function(t){return function(){var e=this,n=e._parent;return e._orientation=n._orientation,e._stereo=n._stereo,e._pos=n._pos,e._pannerAttr=n._pannerAttr,e._stereo?n.stereo(e._stereo):e._pos?n.pos(e._pos[0],e._pos[1],e._pos[2],e._id):e._panner&&(e._panner.disconnect(0),e._panner=void 0,n._refreshBuffer(e)),t.call(this)}}(Sound.prototype.reset);var e=function(t,e){"spatial"===(e=e||"spatial")?(t._panner=Howler.ctx.createPanner(),t._panner.coneInnerAngle=t._pannerAttr.coneInnerAngle,t._panner.coneOuterAngle=t._pannerAttr.coneOuterAngle,t._panner.coneOuterGain=t._pannerAttr.coneOuterGain,t._panner.distanceModel=t._pannerAttr.distanceModel,t._panner.maxDistance=t._pannerAttr.maxDistance,t._panner.refDistance=t._pannerAttr.refDistance,t._panner.rolloffFactor=t._pannerAttr.rolloffFactor,t._panner.panningModel=t._pannerAttr.panningModel,void 0!==t._panner.positionX?(t._panner.positionX.setValueAtTime(t._pos[0],Howler.ctx.currentTime),t._panner.positionY.setValueAtTime(t._pos[1],Howler.ctx.currentTime),t._panner.positionZ.setValueAtTime(t._pos[2],Howler.ctx.currentTime)):t._panner.setPosition(t._pos[0],t._pos[1],t._pos[2]),void 0!==t._panner.orientationX?(t._panner.orientationX.setValueAtTime(t._orientation[0],Howler.ctx.currentTime),t._panner.orientationY.setValueAtTime(t._orientation[1],Howler.ctx.currentTime),t._panner.orientationZ.setValueAtTime(t._orientation[2],Howler.ctx.currentTime)):t._panner.setOrientation(t._orientation[0],t._orientation[1],t._orientation[2])):(t._panner=Howler.ctx.createStereoPanner(),t._panner.pan.setValueAtTime(t._stereo,Howler.ctx.currentTime)),t._panner.connect(t._node),t._paused||t._parent.pause(t._id,!0).play(t._id,!0)}}()},486:function(t,e,n){var r;t=n.nmd(t),function(){var o,i="Expected a function",s="__lodash_hash_undefined__",a="__lodash_placeholder__",u=32,l=128,c=1/0,h=9007199254740991,f=NaN,d=4294967295,p=[["ary",l],["bind",1],["bindKey",2],["curry",8],["curryRight",16],["flip",512],["partial",u],["partialRight",64],["rearg",256]],g="[object Arguments]",m="[object Array]",y="[object Boolean]",v="[object Date]",_="[object Error]",x="[object Function]",b="[object GeneratorFunction]",w="[object Map]",k="[object Number]",S="[object Object]",A="[object Promise]",D="[object RegExp]",C="[object Set]",L="[object String]",R="[object Symbol]",T="[object WeakMap]",O="[object ArrayBuffer]",P="[object DataView]",M="[object Float32Array]",E="[object Float64Array]",I="[object Int8Array]",j="[object Int16Array]",F="[object Int32Array]",H="[object Uint8Array]",B="[object Uint8ClampedArray]",N="[object Uint16Array]",U="[object Uint32Array]",G=/\b__p \+= '';/g,W=/\b(__p \+=) '' \+/g,z=/(__e\(.*?\)|\b__t\)) \+\n'';/g,Y=/&(?:amp|lt|gt|quot|#39);/g,V=/[&<>"']/g,K=RegExp(Y.source),X=RegExp(V.source),Q=/<%-([\s\S]+?)%>/g,q=/<%([\s\S]+?)%>/g,$=/<%=([\s\S]+?)%>/g,Z=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,J=/^\w*$/,tt=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,et=/[\\^$.*+?()[\]{}|]/g,nt=RegExp(et.source),rt=/^\s+/,ot=/\s/,it=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,st=/\{\n\/\* \[wrapped with (.+)\] \*/,at=/,? & /,ut=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,lt=/[()=,{}\[\]\/\s]/,ct=/\\(\\)?/g,ht=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,ft=/\w*$/,dt=/^[-+]0x[0-9a-f]+$/i,pt=/^0b[01]+$/i,gt=/^\[object .+?Constructor\]$/,mt=/^0o[0-7]+$/i,yt=/^(?:0|[1-9]\d*)$/,vt=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,_t=/($^)/,xt=/['\n\r\u2028\u2029\\]/g,bt="\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff",wt="a-z\\xdf-\\xf6\\xf8-\\xff",kt="A-Z\\xc0-\\xd6\\xd8-\\xde",St="\\xac\\xb1\\xd7\\xf7\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf\\u2000-\\u206f \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",At="["+St+"]",Dt="["+bt+"]",Ct="\\d+",Lt="["+wt+"]",Rt="[^\\ud800-\\udfff"+St+Ct+"\\u2700-\\u27bf"+wt+kt+"]",Tt="\\ud83c[\\udffb-\\udfff]",Ot="[^\\ud800-\\udfff]",Pt="(?:\\ud83c[\\udde6-\\uddff]){2}",Mt="[\\ud800-\\udbff][\\udc00-\\udfff]",Et="["+kt+"]",It="(?:"+Lt+"|"+Rt+")",jt="(?:"+Et+"|"+Rt+")",Ft="(?:['’](?:d|ll|m|re|s|t|ve))?",Ht="(?:['’](?:D|LL|M|RE|S|T|VE))?",Bt="(?:"+Dt+"|"+Tt+")?",Nt="[\\ufe0e\\ufe0f]?",Ut=Nt+Bt+"(?:\\u200d(?:"+[Ot,Pt,Mt].join("|")+")"+Nt+Bt+")*",Gt="(?:"+["[\\u2700-\\u27bf]",Pt,Mt].join("|")+")"+Ut,Wt="(?:"+[Ot+Dt+"?",Dt,Pt,Mt,"[\\ud800-\\udfff]"].join("|")+")",zt=RegExp("['’]","g"),Yt=RegExp(Dt,"g"),Vt=RegExp(Tt+"(?="+Tt+")|"+Wt+Ut,"g"),Kt=RegExp([Et+"?"+Lt+"+"+Ft+"(?="+[At,Et,"$"].join("|")+")",jt+"+"+Ht+"(?="+[At,Et+It,"$"].join("|")+")",Et+"?"+It+"+"+Ft,Et+"+"+Ht,"\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])","\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",Ct,Gt].join("|"),"g"),Xt=RegExp("[\\u200d\\ud800-\\udfff"+bt+"\\ufe0e\\ufe0f]"),Qt=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,qt=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],$t=-1,Zt={};Zt[M]=Zt[E]=Zt[I]=Zt[j]=Zt[F]=Zt[H]=Zt[B]=Zt[N]=Zt[U]=!0,Zt[g]=Zt[m]=Zt[O]=Zt[y]=Zt[P]=Zt[v]=Zt[_]=Zt[x]=Zt[w]=Zt[k]=Zt[S]=Zt[D]=Zt[C]=Zt[L]=Zt[T]=!1;var Jt={};Jt[g]=Jt[m]=Jt[O]=Jt[P]=Jt[y]=Jt[v]=Jt[M]=Jt[E]=Jt[I]=Jt[j]=Jt[F]=Jt[w]=Jt[k]=Jt[S]=Jt[D]=Jt[C]=Jt[L]=Jt[R]=Jt[H]=Jt[B]=Jt[N]=Jt[U]=!0,Jt[_]=Jt[x]=Jt[T]=!1;var te={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},ee=parseFloat,ne=parseInt,re="object"==typeof n.g&&n.g&&n.g.Object===Object&&n.g,oe="object"==typeof self&&self&&self.Object===Object&&self,ie=re||oe||Function("return this")(),se=e&&!e.nodeType&&e,ae=se&&t&&!t.nodeType&&t,ue=ae&&ae.exports===se,le=ue&&re.process,ce=function(){try{return ae&&ae.require&&ae.require("util").types||le&&le.binding&&le.binding("util")}catch(t){}}(),he=ce&&ce.isArrayBuffer,fe=ce&&ce.isDate,de=ce&&ce.isMap,pe=ce&&ce.isRegExp,ge=ce&&ce.isSet,me=ce&&ce.isTypedArray;function ye(t,e,n){switch(n.length){case 0:return t.call(e);case 1:return t.call(e,n[0]);case 2:return t.call(e,n[0],n[1]);case 3:return t.call(e,n[0],n[1],n[2])}return t.apply(e,n)}function ve(t,e,n,r){for(var o=-1,i=null==t?0:t.length;++o<i;){var s=t[o];e(r,s,n(s),t)}return r}function _e(t,e){for(var n=-1,r=null==t?0:t.length;++n<r&&!1!==e(t[n],n,t););return t}function xe(t,e){for(var n=null==t?0:t.length;n--&&!1!==e(t[n],n,t););return t}function be(t,e){for(var n=-1,r=null==t?0:t.length;++n<r;)if(!e(t[n],n,t))return!1;return!0}function we(t,e){for(var n=-1,r=null==t?0:t.length,o=0,i=[];++n<r;){var s=t[n];e(s,n,t)&&(i[o++]=s)}return i}function ke(t,e){return!(null==t||!t.length)&&Me(t,e,0)>-1}function Se(t,e,n){for(var r=-1,o=null==t?0:t.length;++r<o;)if(n(e,t[r]))return!0;return!1}function Ae(t,e){for(var n=-1,r=null==t?0:t.length,o=Array(r);++n<r;)o[n]=e(t[n],n,t);return o}function De(t,e){for(var n=-1,r=e.length,o=t.length;++n<r;)t[o+n]=e[n];return t}function Ce(t,e,n,r){var o=-1,i=null==t?0:t.length;for(r&&i&&(n=t[++o]);++o<i;)n=e(n,t[o],o,t);return n}function Le(t,e,n,r){var o=null==t?0:t.length;for(r&&o&&(n=t[--o]);o--;)n=e(n,t[o],o,t);return n}function Re(t,e){for(var n=-1,r=null==t?0:t.length;++n<r;)if(e(t[n],n,t))return!0;return!1}var Te=Fe("length");function Oe(t,e,n){var r;return n(t,(function(t,n,o){if(e(t,n,o))return r=n,!1})),r}function Pe(t,e,n,r){for(var o=t.length,i=n+(r?1:-1);r?i--:++i<o;)if(e(t[i],i,t))return i;return-1}function Me(t,e,n){return e==e?function(t,e,n){for(var r=n-1,o=t.length;++r<o;)if(t[r]===e)return r;return-1}(t,e,n):Pe(t,Ie,n)}function Ee(t,e,n,r){for(var o=n-1,i=t.length;++o<i;)if(r(t[o],e))return o;return-1}function Ie(t){return t!=t}function je(t,e){var n=null==t?0:t.length;return n?Ne(t,e)/n:f}function Fe(t){return function(e){return null==e?o:e[t]}}function He(t){return function(e){return null==t?o:t[e]}}function Be(t,e,n,r,o){return o(t,(function(t,o,i){n=r?(r=!1,t):e(n,t,o,i)})),n}function Ne(t,e){for(var n,r=-1,i=t.length;++r<i;){var s=e(t[r]);s!==o&&(n=n===o?s:n+s)}return n}function Ue(t,e){for(var n=-1,r=Array(t);++n<t;)r[n]=e(n);return r}function Ge(t){return t?t.slice(0,an(t)+1).replace(rt,""):t}function We(t){return function(e){return t(e)}}function ze(t,e){return Ae(e,(function(e){return t[e]}))}function Ye(t,e){return t.has(e)}function Ve(t,e){for(var n=-1,r=t.length;++n<r&&Me(e,t[n],0)>-1;);return n}function Ke(t,e){for(var n=t.length;n--&&Me(e,t[n],0)>-1;);return n}function Xe(t,e){for(var n=t.length,r=0;n--;)t[n]===e&&++r;return r}var Qe=He({À:"A",Á:"A",Â:"A",Ã:"A",Ä:"A",Å:"A",à:"a",á:"a",â:"a",ã:"a",ä:"a",å:"a",Ç:"C",ç:"c",Ð:"D",ð:"d",È:"E",É:"E",Ê:"E",Ë:"E",è:"e",é:"e",ê:"e",ë:"e",Ì:"I",Í:"I",Î:"I",Ï:"I",ì:"i",í:"i",î:"i",ï:"i",Ñ:"N",ñ:"n",Ò:"O",Ó:"O",Ô:"O",Õ:"O",Ö:"O",Ø:"O",ò:"o",ó:"o",ô:"o",õ:"o",ö:"o",ø:"o",Ù:"U",Ú:"U",Û:"U",Ü:"U",ù:"u",ú:"u",û:"u",ü:"u",Ý:"Y",ý:"y",ÿ:"y",Æ:"Ae",æ:"ae",Þ:"Th",þ:"th",ß:"ss",Ā:"A",Ă:"A",Ą:"A",ā:"a",ă:"a",ą:"a",Ć:"C",Ĉ:"C",Ċ:"C",Č:"C",ć:"c",ĉ:"c",ċ:"c",č:"c",Ď:"D",Đ:"D",ď:"d",đ:"d",Ē:"E",Ĕ:"E",Ė:"E",Ę:"E",Ě:"E",ē:"e",ĕ:"e",ė:"e",ę:"e",ě:"e",Ĝ:"G",Ğ:"G",Ġ:"G",Ģ:"G",ĝ:"g",ğ:"g",ġ:"g",ģ:"g",Ĥ:"H",Ħ:"H",ĥ:"h",ħ:"h",Ĩ:"I",Ī:"I",Ĭ:"I",Į:"I",İ:"I",ĩ:"i",ī:"i",ĭ:"i",į:"i",ı:"i",Ĵ:"J",ĵ:"j",Ķ:"K",ķ:"k",ĸ:"k",Ĺ:"L",Ļ:"L",Ľ:"L",Ŀ:"L",Ł:"L",ĺ:"l",ļ:"l",ľ:"l",ŀ:"l",ł:"l",Ń:"N",Ņ:"N",Ň:"N",Ŋ:"N",ń:"n",ņ:"n",ň:"n",ŋ:"n",Ō:"O",Ŏ:"O",Ő:"O",ō:"o",ŏ:"o",ő:"o",Ŕ:"R",Ŗ:"R",Ř:"R",ŕ:"r",ŗ:"r",ř:"r",Ś:"S",Ŝ:"S",Ş:"S",Š:"S",ś:"s",ŝ:"s",ş:"s",š:"s",Ţ:"T",Ť:"T",Ŧ:"T",ţ:"t",ť:"t",ŧ:"t",Ũ:"U",Ū:"U",Ŭ:"U",Ů:"U",Ű:"U",Ų:"U",ũ:"u",ū:"u",ŭ:"u",ů:"u",ű:"u",ų:"u",Ŵ:"W",ŵ:"w",Ŷ:"Y",ŷ:"y",Ÿ:"Y",Ź:"Z",Ż:"Z",Ž:"Z",ź:"z",ż:"z",ž:"z",Ĳ:"IJ",ĳ:"ij",Œ:"Oe",œ:"oe",ŉ:"'n",ſ:"s"}),qe=He({"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"});function $e(t){return"\\"+te[t]}function Ze(t){return Xt.test(t)}function Je(t){var e=-1,n=Array(t.size);return t.forEach((function(t,r){n[++e]=[r,t]})),n}function tn(t,e){return function(n){return t(e(n))}}function en(t,e){for(var n=-1,r=t.length,o=0,i=[];++n<r;){var s=t[n];s!==e&&s!==a||(t[n]=a,i[o++]=n)}return i}function nn(t){var e=-1,n=Array(t.size);return t.forEach((function(t){n[++e]=t})),n}function rn(t){var e=-1,n=Array(t.size);return t.forEach((function(t){n[++e]=[t,t]})),n}function on(t){return Ze(t)?function(t){for(var e=Vt.lastIndex=0;Vt.test(t);)++e;return e}(t):Te(t)}function sn(t){return Ze(t)?function(t){return t.match(Vt)||[]}(t):function(t){return t.split("")}(t)}function an(t){for(var e=t.length;e--&&ot.test(t.charAt(e)););return e}var un=He({"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"}),ln=function t(e){var n,r=(e=null==e?ie:ln.defaults(ie.Object(),e,ln.pick(ie,qt))).Array,ot=e.Date,bt=e.Error,wt=e.Function,kt=e.Math,St=e.Object,At=e.RegExp,Dt=e.String,Ct=e.TypeError,Lt=r.prototype,Rt=wt.prototype,Tt=St.prototype,Ot=e["__core-js_shared__"],Pt=Rt.toString,Mt=Tt.hasOwnProperty,Et=0,It=(n=/[^.]+$/.exec(Ot&&Ot.keys&&Ot.keys.IE_PROTO||""))?"Symbol(src)_1."+n:"",jt=Tt.toString,Ft=Pt.call(St),Ht=ie._,Bt=At("^"+Pt.call(Mt).replace(et,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Nt=ue?e.Buffer:o,Ut=e.Symbol,Gt=e.Uint8Array,Wt=Nt?Nt.allocUnsafe:o,Vt=tn(St.getPrototypeOf,St),Xt=St.create,te=Tt.propertyIsEnumerable,re=Lt.splice,oe=Ut?Ut.isConcatSpreadable:o,se=Ut?Ut.iterator:o,ae=Ut?Ut.toStringTag:o,le=function(){try{var t=ci(St,"defineProperty");return t({},"",{}),t}catch(t){}}(),ce=e.clearTimeout!==ie.clearTimeout&&e.clearTimeout,Te=ot&&ot.now!==ie.Date.now&&ot.now,He=e.setTimeout!==ie.setTimeout&&e.setTimeout,cn=kt.ceil,hn=kt.floor,fn=St.getOwnPropertySymbols,dn=Nt?Nt.isBuffer:o,pn=e.isFinite,gn=Lt.join,mn=tn(St.keys,St),yn=kt.max,vn=kt.min,_n=ot.now,xn=e.parseInt,bn=kt.random,wn=Lt.reverse,kn=ci(e,"DataView"),Sn=ci(e,"Map"),An=ci(e,"Promise"),Dn=ci(e,"Set"),Cn=ci(e,"WeakMap"),Ln=ci(St,"create"),Rn=Cn&&new Cn,Tn={},On=Bi(kn),Pn=Bi(Sn),Mn=Bi(An),En=Bi(Dn),In=Bi(Cn),jn=Ut?Ut.prototype:o,Fn=jn?jn.valueOf:o,Hn=jn?jn.toString:o;function Bn(t){if(na(t)&&!Ys(t)&&!(t instanceof Wn)){if(t instanceof Gn)return t;if(Mt.call(t,"__wrapped__"))return Ni(t)}return new Gn(t)}var Nn=function(){function t(){}return function(e){if(!ea(e))return{};if(Xt)return Xt(e);t.prototype=e;var n=new t;return t.prototype=o,n}}();function Un(){}function Gn(t,e){this.__wrapped__=t,this.__actions__=[],this.__chain__=!!e,this.__index__=0,this.__values__=o}function Wn(t){this.__wrapped__=t,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=d,this.__views__=[]}function zn(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}function Yn(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}function Vn(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}function Kn(t){var e=-1,n=null==t?0:t.length;for(this.__data__=new Vn;++e<n;)this.add(t[e])}function Xn(t){var e=this.__data__=new Yn(t);this.size=e.size}function Qn(t,e){var n=Ys(t),r=!n&&zs(t),o=!n&&!r&&Qs(t),i=!n&&!r&&!o&&ca(t),s=n||r||o||i,a=s?Ue(t.length,Dt):[],u=a.length;for(var l in t)!e&&!Mt.call(t,l)||s&&("length"==l||o&&("offset"==l||"parent"==l)||i&&("buffer"==l||"byteLength"==l||"byteOffset"==l)||yi(l,u))||a.push(l);return a}function qn(t){var e=t.length;return e?t[Vr(0,e-1)]:o}function $n(t,e){return Ei(Lo(t),sr(e,0,t.length))}function Zn(t){return Ei(Lo(t))}function Jn(t,e,n){(n!==o&&!Us(t[e],n)||n===o&&!(e in t))&&or(t,e,n)}function tr(t,e,n){var r=t[e];Mt.call(t,e)&&Us(r,n)&&(n!==o||e in t)||or(t,e,n)}function er(t,e){for(var n=t.length;n--;)if(Us(t[n][0],e))return n;return-1}function nr(t,e,n,r){return hr(t,(function(t,o,i){e(r,t,n(t),i)})),r}function rr(t,e){return t&&Ro(e,Pa(e),t)}function or(t,e,n){"__proto__"==e&&le?le(t,e,{configurable:!0,enumerable:!0,value:n,writable:!0}):t[e]=n}function ir(t,e){for(var n=-1,i=e.length,s=r(i),a=null==t;++n<i;)s[n]=a?o:Ca(t,e[n]);return s}function sr(t,e,n){return t==t&&(n!==o&&(t=t<=n?t:n),e!==o&&(t=t>=e?t:e)),t}function ar(t,e,n,r,i,s){var a,u=1&e,l=2&e,c=4&e;if(n&&(a=i?n(t,r,i,s):n(t)),a!==o)return a;if(!ea(t))return t;var h=Ys(t);if(h){if(a=function(t){var e=t.length,n=new t.constructor(e);return e&&"string"==typeof t[0]&&Mt.call(t,"index")&&(n.index=t.index,n.input=t.input),n}(t),!u)return Lo(t,a)}else{var f=di(t),d=f==x||f==b;if(Qs(t))return wo(t,u);if(f==S||f==g||d&&!i){if(a=l||d?{}:gi(t),!u)return l?function(t,e){return Ro(t,fi(t),e)}(t,function(t,e){return t&&Ro(e,Ma(e),t)}(a,t)):function(t,e){return Ro(t,hi(t),e)}(t,rr(a,t))}else{if(!Jt[f])return i?t:{};a=function(t,e,n){var r,o=t.constructor;switch(e){case O:return ko(t);case y:case v:return new o(+t);case P:return function(t,e){var n=e?ko(t.buffer):t.buffer;return new t.constructor(n,t.byteOffset,t.byteLength)}(t,n);case M:case E:case I:case j:case F:case H:case B:case N:case U:return So(t,n);case w:return new o;case k:case L:return new o(t);case D:return function(t){var e=new t.constructor(t.source,ft.exec(t));return e.lastIndex=t.lastIndex,e}(t);case C:return new o;case R:return r=t,Fn?St(Fn.call(r)):{}}}(t,f,u)}}s||(s=new Xn);var p=s.get(t);if(p)return p;s.set(t,a),aa(t)?t.forEach((function(r){a.add(ar(r,e,n,r,t,s))})):ra(t)&&t.forEach((function(r,o){a.set(o,ar(r,e,n,o,t,s))}));var m=h?o:(c?l?ri:ni:l?Ma:Pa)(t);return _e(m||t,(function(r,o){m&&(r=t[o=r]),tr(a,o,ar(r,e,n,o,t,s))})),a}function ur(t,e,n){var r=n.length;if(null==t)return!r;for(t=St(t);r--;){var i=n[r],s=e[i],a=t[i];if(a===o&&!(i in t)||!s(a))return!1}return!0}function lr(t,e,n){if("function"!=typeof t)throw new Ct(i);return Ti((function(){t.apply(o,n)}),e)}function cr(t,e,n,r){var o=-1,i=ke,s=!0,a=t.length,u=[],l=e.length;if(!a)return u;n&&(e=Ae(e,We(n))),r?(i=Se,s=!1):e.length>=200&&(i=Ye,s=!1,e=new Kn(e));t:for(;++o<a;){var c=t[o],h=null==n?c:n(c);if(c=r||0!==c?c:0,s&&h==h){for(var f=l;f--;)if(e[f]===h)continue t;u.push(c)}else i(e,h,r)||u.push(c)}return u}Bn.templateSettings={escape:Q,evaluate:q,interpolate:$,variable:"",imports:{_:Bn}},Bn.prototype=Un.prototype,Bn.prototype.constructor=Bn,Gn.prototype=Nn(Un.prototype),Gn.prototype.constructor=Gn,Wn.prototype=Nn(Un.prototype),Wn.prototype.constructor=Wn,zn.prototype.clear=function(){this.__data__=Ln?Ln(null):{},this.size=0},zn.prototype.delete=function(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e},zn.prototype.get=function(t){var e=this.__data__;if(Ln){var n=e[t];return n===s?o:n}return Mt.call(e,t)?e[t]:o},zn.prototype.has=function(t){var e=this.__data__;return Ln?e[t]!==o:Mt.call(e,t)},zn.prototype.set=function(t,e){var n=this.__data__;return this.size+=this.has(t)?0:1,n[t]=Ln&&e===o?s:e,this},Yn.prototype.clear=function(){this.__data__=[],this.size=0},Yn.prototype.delete=function(t){var e=this.__data__,n=er(e,t);return!(n<0||(n==e.length-1?e.pop():re.call(e,n,1),--this.size,0))},Yn.prototype.get=function(t){var e=this.__data__,n=er(e,t);return n<0?o:e[n][1]},Yn.prototype.has=function(t){return er(this.__data__,t)>-1},Yn.prototype.set=function(t,e){var n=this.__data__,r=er(n,t);return r<0?(++this.size,n.push([t,e])):n[r][1]=e,this},Vn.prototype.clear=function(){this.size=0,this.__data__={hash:new zn,map:new(Sn||Yn),string:new zn}},Vn.prototype.delete=function(t){var e=ui(this,t).delete(t);return this.size-=e?1:0,e},Vn.prototype.get=function(t){return ui(this,t).get(t)},Vn.prototype.has=function(t){return ui(this,t).has(t)},Vn.prototype.set=function(t,e){var n=ui(this,t),r=n.size;return n.set(t,e),this.size+=n.size==r?0:1,this},Kn.prototype.add=Kn.prototype.push=function(t){return this.__data__.set(t,s),this},Kn.prototype.has=function(t){return this.__data__.has(t)},Xn.prototype.clear=function(){this.__data__=new Yn,this.size=0},Xn.prototype.delete=function(t){var e=this.__data__,n=e.delete(t);return this.size=e.size,n},Xn.prototype.get=function(t){return this.__data__.get(t)},Xn.prototype.has=function(t){return this.__data__.has(t)},Xn.prototype.set=function(t,e){var n=this.__data__;if(n instanceof Yn){var r=n.__data__;if(!Sn||r.length<199)return r.push([t,e]),this.size=++n.size,this;n=this.__data__=new Vn(r)}return n.set(t,e),this.size=n.size,this};var hr=Po(_r),fr=Po(xr,!0);function dr(t,e){var n=!0;return hr(t,(function(t,r,o){return n=!!e(t,r,o)})),n}function pr(t,e,n){for(var r=-1,i=t.length;++r<i;){var s=t[r],a=e(s);if(null!=a&&(u===o?a==a&&!la(a):n(a,u)))var u=a,l=s}return l}function gr(t,e){var n=[];return hr(t,(function(t,r,o){e(t,r,o)&&n.push(t)})),n}function mr(t,e,n,r,o){var i=-1,s=t.length;for(n||(n=mi),o||(o=[]);++i<s;){var a=t[i];e>0&&n(a)?e>1?mr(a,e-1,n,r,o):De(o,a):r||(o[o.length]=a)}return o}var yr=Mo(),vr=Mo(!0);function _r(t,e){return t&&yr(t,e,Pa)}function xr(t,e){return t&&vr(t,e,Pa)}function br(t,e){return we(e,(function(e){return Zs(t[e])}))}function wr(t,e){for(var n=0,r=(e=vo(e,t)).length;null!=t&&n<r;)t=t[Hi(e[n++])];return n&&n==r?t:o}function kr(t,e,n){var r=e(t);return Ys(t)?r:De(r,n(t))}function Sr(t){return null==t?t===o?"[object Undefined]":"[object Null]":ae&&ae in St(t)?function(t){var e=Mt.call(t,ae),n=t[ae];try{t[ae]=o;var r=!0}catch(t){}var i=jt.call(t);return r&&(e?t[ae]=n:delete t[ae]),i}(t):function(t){return jt.call(t)}(t)}function Ar(t,e){return t>e}function Dr(t,e){return null!=t&&Mt.call(t,e)}function Cr(t,e){return null!=t&&e in St(t)}function Lr(t,e,n){for(var i=n?Se:ke,s=t[0].length,a=t.length,u=a,l=r(a),c=1/0,h=[];u--;){var f=t[u];u&&e&&(f=Ae(f,We(e))),c=vn(f.length,c),l[u]=!n&&(e||s>=120&&f.length>=120)?new Kn(u&&f):o}f=t[0];var d=-1,p=l[0];t:for(;++d<s&&h.length<c;){var g=f[d],m=e?e(g):g;if(g=n||0!==g?g:0,!(p?Ye(p,m):i(h,m,n))){for(u=a;--u;){var y=l[u];if(!(y?Ye(y,m):i(t[u],m,n)))continue t}p&&p.push(m),h.push(g)}}return h}function Rr(t,e,n){var r=null==(t=Di(t,e=vo(e,t)))?t:t[Hi($i(e))];return null==r?o:ye(r,t,n)}function Tr(t){return na(t)&&Sr(t)==g}function Or(t,e,n,r,i){return t===e||(null==t||null==e||!na(t)&&!na(e)?t!=t&&e!=e:function(t,e,n,r,i,s){var a=Ys(t),u=Ys(e),l=a?m:di(t),c=u?m:di(e),h=(l=l==g?S:l)==S,f=(c=c==g?S:c)==S,d=l==c;if(d&&Qs(t)){if(!Qs(e))return!1;a=!0,h=!1}if(d&&!h)return s||(s=new Xn),a||ca(t)?ti(t,e,n,r,i,s):function(t,e,n,r,o,i,s){switch(n){case P:if(t.byteLength!=e.byteLength||t.byteOffset!=e.byteOffset)return!1;t=t.buffer,e=e.buffer;case O:return!(t.byteLength!=e.byteLength||!i(new Gt(t),new Gt(e)));case y:case v:case k:return Us(+t,+e);case _:return t.name==e.name&&t.message==e.message;case D:case L:return t==e+"";case w:var a=Je;case C:var u=1&r;if(a||(a=nn),t.size!=e.size&&!u)return!1;var l=s.get(t);if(l)return l==e;r|=2,s.set(t,e);var c=ti(a(t),a(e),r,o,i,s);return s.delete(t),c;case R:if(Fn)return Fn.call(t)==Fn.call(e)}return!1}(t,e,l,n,r,i,s);if(!(1&n)){var p=h&&Mt.call(t,"__wrapped__"),x=f&&Mt.call(e,"__wrapped__");if(p||x){var b=p?t.value():t,A=x?e.value():e;return s||(s=new Xn),i(b,A,n,r,s)}}return!!d&&(s||(s=new Xn),function(t,e,n,r,i,s){var a=1&n,u=ni(t),l=u.length;if(l!=ni(e).length&&!a)return!1;for(var c=l;c--;){var h=u[c];if(!(a?h in e:Mt.call(e,h)))return!1}var f=s.get(t),d=s.get(e);if(f&&d)return f==e&&d==t;var p=!0;s.set(t,e),s.set(e,t);for(var g=a;++c<l;){var m=t[h=u[c]],y=e[h];if(r)var v=a?r(y,m,h,e,t,s):r(m,y,h,t,e,s);if(!(v===o?m===y||i(m,y,n,r,s):v)){p=!1;break}g||(g="constructor"==h)}if(p&&!g){var _=t.constructor,x=e.constructor;_==x||!("constructor"in t)||!("constructor"in e)||"function"==typeof _&&_ instanceof _&&"function"==typeof x&&x instanceof x||(p=!1)}return s.delete(t),s.delete(e),p}(t,e,n,r,i,s))}(t,e,n,r,Or,i))}function Pr(t,e,n,r){var i=n.length,s=i,a=!r;if(null==t)return!s;for(t=St(t);i--;){var u=n[i];if(a&&u[2]?u[1]!==t[u[0]]:!(u[0]in t))return!1}for(;++i<s;){var l=(u=n[i])[0],c=t[l],h=u[1];if(a&&u[2]){if(c===o&&!(l in t))return!1}else{var f=new Xn;if(r)var d=r(c,h,l,t,e,f);if(!(d===o?Or(h,c,3,r,f):d))return!1}}return!0}function Mr(t){return!(!ea(t)||(e=t,It&&It in e))&&(Zs(t)?Bt:gt).test(Bi(t));var e}function Er(t){return"function"==typeof t?t:null==t?ou:"object"==typeof t?Ys(t)?Br(t[0],t[1]):Hr(t):du(t)}function Ir(t){if(!wi(t))return mn(t);var e=[];for(var n in St(t))Mt.call(t,n)&&"constructor"!=n&&e.push(n);return e}function jr(t,e){return t<e}function Fr(t,e){var n=-1,o=Ks(t)?r(t.length):[];return hr(t,(function(t,r,i){o[++n]=e(t,r,i)})),o}function Hr(t){var e=li(t);return 1==e.length&&e[0][2]?Si(e[0][0],e[0][1]):function(n){return n===t||Pr(n,t,e)}}function Br(t,e){return _i(t)&&ki(e)?Si(Hi(t),e):function(n){var r=Ca(n,t);return r===o&&r===e?La(n,t):Or(e,r,3)}}function Nr(t,e,n,r,i){t!==e&&yr(e,(function(s,a){if(i||(i=new Xn),ea(s))!function(t,e,n,r,i,s,a){var u=Li(t,n),l=Li(e,n),c=a.get(l);if(c)Jn(t,n,c);else{var h=s?s(u,l,n+"",t,e,a):o,f=h===o;if(f){var d=Ys(l),p=!d&&Qs(l),g=!d&&!p&&ca(l);h=l,d||p||g?Ys(u)?h=u:Xs(u)?h=Lo(u):p?(f=!1,h=wo(l,!0)):g?(f=!1,h=So(l,!0)):h=[]:ia(l)||zs(l)?(h=u,zs(u)?h=va(u):ea(u)&&!Zs(u)||(h=gi(l))):f=!1}f&&(a.set(l,h),i(h,l,r,s,a),a.delete(l)),Jn(t,n,h)}}(t,e,a,n,Nr,r,i);else{var u=r?r(Li(t,a),s,a+"",t,e,i):o;u===o&&(u=s),Jn(t,a,u)}}),Ma)}function Ur(t,e){var n=t.length;if(n)return yi(e+=e<0?n:0,n)?t[e]:o}function Gr(t,e,n){e=e.length?Ae(e,(function(t){return Ys(t)?function(e){return wr(e,1===t.length?t[0]:t)}:t})):[ou];var r=-1;return e=Ae(e,We(ai())),function(t,e){var r=t.length;for(t.sort((function(t,e){return function(t,e,n){for(var r=-1,o=t.criteria,i=e.criteria,s=o.length,a=n.length;++r<s;){var u=Ao(o[r],i[r]);if(u)return r>=a?u:u*("desc"==n[r]?-1:1)}return t.index-e.index}(t,e,n)}));r--;)t[r]=t[r].value;return t}(Fr(t,(function(t,n,o){return{criteria:Ae(e,(function(e){return e(t)})),index:++r,value:t}})))}function Wr(t,e,n){for(var r=-1,o=e.length,i={};++r<o;){var s=e[r],a=wr(t,s);n(a,s)&&$r(i,vo(s,t),a)}return i}function zr(t,e,n,r){var o=r?Ee:Me,i=-1,s=e.length,a=t;for(t===e&&(e=Lo(e)),n&&(a=Ae(t,We(n)));++i<s;)for(var u=0,l=e[i],c=n?n(l):l;(u=o(a,c,u,r))>-1;)a!==t&&re.call(a,u,1),re.call(t,u,1);return t}function Yr(t,e){for(var n=t?e.length:0,r=n-1;n--;){var o=e[n];if(n==r||o!==i){var i=o;yi(o)?re.call(t,o,1):lo(t,o)}}return t}function Vr(t,e){return t+hn(bn()*(e-t+1))}function Kr(t,e){var n="";if(!t||e<1||e>h)return n;do{e%2&&(n+=t),(e=hn(e/2))&&(t+=t)}while(e);return n}function Xr(t,e){return Oi(Ai(t,e,ou),t+"")}function Qr(t){return qn(Ua(t))}function qr(t,e){var n=Ua(t);return Ei(n,sr(e,0,n.length))}function $r(t,e,n,r){if(!ea(t))return t;for(var i=-1,s=(e=vo(e,t)).length,a=s-1,u=t;null!=u&&++i<s;){var l=Hi(e[i]),c=n;if("__proto__"===l||"constructor"===l||"prototype"===l)return t;if(i!=a){var h=u[l];(c=r?r(h,l,u):o)===o&&(c=ea(h)?h:yi(e[i+1])?[]:{})}tr(u,l,c),u=u[l]}return t}var Zr=Rn?function(t,e){return Rn.set(t,e),t}:ou,Jr=le?function(t,e){return le(t,"toString",{configurable:!0,enumerable:!1,value:eu(e),writable:!0})}:ou;function to(t){return Ei(Ua(t))}function eo(t,e,n){var o=-1,i=t.length;e<0&&(e=-e>i?0:i+e),(n=n>i?i:n)<0&&(n+=i),i=e>n?0:n-e>>>0,e>>>=0;for(var s=r(i);++o<i;)s[o]=t[o+e];return s}function no(t,e){var n;return hr(t,(function(t,r,o){return!(n=e(t,r,o))})),!!n}function ro(t,e,n){var r=0,o=null==t?r:t.length;if("number"==typeof e&&e==e&&o<=2147483647){for(;r<o;){var i=r+o>>>1,s=t[i];null!==s&&!la(s)&&(n?s<=e:s<e)?r=i+1:o=i}return o}return oo(t,e,ou,n)}function oo(t,e,n,r){var i=0,s=null==t?0:t.length;if(0===s)return 0;for(var a=(e=n(e))!=e,u=null===e,l=la(e),c=e===o;i<s;){var h=hn((i+s)/2),f=n(t[h]),d=f!==o,p=null===f,g=f==f,m=la(f);if(a)var y=r||g;else y=c?g&&(r||d):u?g&&d&&(r||!p):l?g&&d&&!p&&(r||!m):!p&&!m&&(r?f<=e:f<e);y?i=h+1:s=h}return vn(s,4294967294)}function io(t,e){for(var n=-1,r=t.length,o=0,i=[];++n<r;){var s=t[n],a=e?e(s):s;if(!n||!Us(a,u)){var u=a;i[o++]=0===s?0:s}}return i}function so(t){return"number"==typeof t?t:la(t)?f:+t}function ao(t){if("string"==typeof t)return t;if(Ys(t))return Ae(t,ao)+"";if(la(t))return Hn?Hn.call(t):"";var e=t+"";return"0"==e&&1/t==-1/0?"-0":e}function uo(t,e,n){var r=-1,o=ke,i=t.length,s=!0,a=[],u=a;if(n)s=!1,o=Se;else if(i>=200){var l=e?null:Xo(t);if(l)return nn(l);s=!1,o=Ye,u=new Kn}else u=e?[]:a;t:for(;++r<i;){var c=t[r],h=e?e(c):c;if(c=n||0!==c?c:0,s&&h==h){for(var f=u.length;f--;)if(u[f]===h)continue t;e&&u.push(h),a.push(c)}else o(u,h,n)||(u!==a&&u.push(h),a.push(c))}return a}function lo(t,e){return null==(t=Di(t,e=vo(e,t)))||delete t[Hi($i(e))]}function co(t,e,n,r){return $r(t,e,n(wr(t,e)),r)}function ho(t,e,n,r){for(var o=t.length,i=r?o:-1;(r?i--:++i<o)&&e(t[i],i,t););return n?eo(t,r?0:i,r?i+1:o):eo(t,r?i+1:0,r?o:i)}function fo(t,e){var n=t;return n instanceof Wn&&(n=n.value()),Ce(e,(function(t,e){return e.func.apply(e.thisArg,De([t],e.args))}),n)}function po(t,e,n){var o=t.length;if(o<2)return o?uo(t[0]):[];for(var i=-1,s=r(o);++i<o;)for(var a=t[i],u=-1;++u<o;)u!=i&&(s[i]=cr(s[i]||a,t[u],e,n));return uo(mr(s,1),e,n)}function go(t,e,n){for(var r=-1,i=t.length,s=e.length,a={};++r<i;){var u=r<s?e[r]:o;n(a,t[r],u)}return a}function mo(t){return Xs(t)?t:[]}function yo(t){return"function"==typeof t?t:ou}function vo(t,e){return Ys(t)?t:_i(t,e)?[t]:Fi(_a(t))}var _o=Xr;function xo(t,e,n){var r=t.length;return n=n===o?r:n,!e&&n>=r?t:eo(t,e,n)}var bo=ce||function(t){return ie.clearTimeout(t)};function wo(t,e){if(e)return t.slice();var n=t.length,r=Wt?Wt(n):new t.constructor(n);return t.copy(r),r}function ko(t){var e=new t.constructor(t.byteLength);return new Gt(e).set(new Gt(t)),e}function So(t,e){var n=e?ko(t.buffer):t.buffer;return new t.constructor(n,t.byteOffset,t.length)}function Ao(t,e){if(t!==e){var n=t!==o,r=null===t,i=t==t,s=la(t),a=e!==o,u=null===e,l=e==e,c=la(e);if(!u&&!c&&!s&&t>e||s&&a&&l&&!u&&!c||r&&a&&l||!n&&l||!i)return 1;if(!r&&!s&&!c&&t<e||c&&n&&i&&!r&&!s||u&&n&&i||!a&&i||!l)return-1}return 0}function Do(t,e,n,o){for(var i=-1,s=t.length,a=n.length,u=-1,l=e.length,c=yn(s-a,0),h=r(l+c),f=!o;++u<l;)h[u]=e[u];for(;++i<a;)(f||i<s)&&(h[n[i]]=t[i]);for(;c--;)h[u++]=t[i++];return h}function Co(t,e,n,o){for(var i=-1,s=t.length,a=-1,u=n.length,l=-1,c=e.length,h=yn(s-u,0),f=r(h+c),d=!o;++i<h;)f[i]=t[i];for(var p=i;++l<c;)f[p+l]=e[l];for(;++a<u;)(d||i<s)&&(f[p+n[a]]=t[i++]);return f}function Lo(t,e){var n=-1,o=t.length;for(e||(e=r(o));++n<o;)e[n]=t[n];return e}function Ro(t,e,n,r){var i=!n;n||(n={});for(var s=-1,a=e.length;++s<a;){var u=e[s],l=r?r(n[u],t[u],u,n,t):o;l===o&&(l=t[u]),i?or(n,u,l):tr(n,u,l)}return n}function To(t,e){return function(n,r){var o=Ys(n)?ve:nr,i=e?e():{};return o(n,t,ai(r,2),i)}}function Oo(t){return Xr((function(e,n){var r=-1,i=n.length,s=i>1?n[i-1]:o,a=i>2?n[2]:o;for(s=t.length>3&&"function"==typeof s?(i--,s):o,a&&vi(n[0],n[1],a)&&(s=i<3?o:s,i=1),e=St(e);++r<i;){var u=n[r];u&&t(e,u,r,s)}return e}))}function Po(t,e){return function(n,r){if(null==n)return n;if(!Ks(n))return t(n,r);for(var o=n.length,i=e?o:-1,s=St(n);(e?i--:++i<o)&&!1!==r(s[i],i,s););return n}}function Mo(t){return function(e,n,r){for(var o=-1,i=St(e),s=r(e),a=s.length;a--;){var u=s[t?a:++o];if(!1===n(i[u],u,i))break}return e}}function Eo(t){return function(e){var n=Ze(e=_a(e))?sn(e):o,r=n?n[0]:e.charAt(0),i=n?xo(n,1).join(""):e.slice(1);return r[t]()+i}}function Io(t){return function(e){return Ce(Za(za(e).replace(zt,"")),t,"")}}function jo(t){return function(){var e=arguments;switch(e.length){case 0:return new t;case 1:return new t(e[0]);case 2:return new t(e[0],e[1]);case 3:return new t(e[0],e[1],e[2]);case 4:return new t(e[0],e[1],e[2],e[3]);case 5:return new t(e[0],e[1],e[2],e[3],e[4]);case 6:return new t(e[0],e[1],e[2],e[3],e[4],e[5]);case 7:return new t(e[0],e[1],e[2],e[3],e[4],e[5],e[6])}var n=Nn(t.prototype),r=t.apply(n,e);return ea(r)?r:n}}function Fo(t){return function(e,n,r){var i=St(e);if(!Ks(e)){var s=ai(n,3);e=Pa(e),n=function(t){return s(i[t],t,i)}}var a=t(e,n,r);return a>-1?i[s?e[a]:a]:o}}function Ho(t){return ei((function(e){var n=e.length,r=n,s=Gn.prototype.thru;for(t&&e.reverse();r--;){var a=e[r];if("function"!=typeof a)throw new Ct(i);if(s&&!u&&"wrapper"==ii(a))var u=new Gn([],!0)}for(r=u?r:n;++r<n;){var l=ii(a=e[r]),c="wrapper"==l?oi(a):o;u=c&&xi(c[0])&&424==c[1]&&!c[4].length&&1==c[9]?u[ii(c[0])].apply(u,c[3]):1==a.length&&xi(a)?u[l]():u.thru(a)}return function(){var t=arguments,r=t[0];if(u&&1==t.length&&Ys(r))return u.plant(r).value();for(var o=0,i=n?e[o].apply(this,t):r;++o<n;)i=e[o].call(this,i);return i}}))}function Bo(t,e,n,i,s,a,u,c,h,f){var d=e&l,p=1&e,g=2&e,m=24&e,y=512&e,v=g?o:jo(t);return function o(){for(var l=arguments.length,_=r(l),x=l;x--;)_[x]=arguments[x];if(m)var b=si(o),w=Xe(_,b);if(i&&(_=Do(_,i,s,m)),a&&(_=Co(_,a,u,m)),l-=w,m&&l<f){var k=en(_,b);return Vo(t,e,Bo,o.placeholder,n,_,k,c,h,f-l)}var S=p?n:this,A=g?S[t]:t;return l=_.length,c?_=Ci(_,c):y&&l>1&&_.reverse(),d&&h<l&&(_.length=h),this&&this!==ie&&this instanceof o&&(A=v||jo(A)),A.apply(S,_)}}function No(t,e){return function(n,r){return function(t,e,n,r){return _r(t,(function(t,o,i){e(r,n(t),o,i)})),r}(n,t,e(r),{})}}function Uo(t,e){return function(n,r){var i;if(n===o&&r===o)return e;if(n!==o&&(i=n),r!==o){if(i===o)return r;"string"==typeof n||"string"==typeof r?(n=ao(n),r=ao(r)):(n=so(n),r=so(r)),i=t(n,r)}return i}}function Go(t){return ei((function(e){return e=Ae(e,We(ai())),Xr((function(n){var r=this;return t(e,(function(t){return ye(t,r,n)}))}))}))}function Wo(t,e){var n=(e=e===o?" ":ao(e)).length;if(n<2)return n?Kr(e,t):e;var r=Kr(e,cn(t/on(e)));return Ze(e)?xo(sn(r),0,t).join(""):r.slice(0,t)}function zo(t){return function(e,n,i){return i&&"number"!=typeof i&&vi(e,n,i)&&(n=i=o),e=pa(e),n===o?(n=e,e=0):n=pa(n),function(t,e,n,o){for(var i=-1,s=yn(cn((e-t)/(n||1)),0),a=r(s);s--;)a[o?s:++i]=t,t+=n;return a}(e,n,i=i===o?e<n?1:-1:pa(i),t)}}function Yo(t){return function(e,n){return"string"==typeof e&&"string"==typeof n||(e=ya(e),n=ya(n)),t(e,n)}}function Vo(t,e,n,r,i,s,a,l,c,h){var f=8&e;e|=f?u:64,4&(e&=~(f?64:u))||(e&=-4);var d=[t,e,i,f?s:o,f?a:o,f?o:s,f?o:a,l,c,h],p=n.apply(o,d);return xi(t)&&Ri(p,d),p.placeholder=r,Pi(p,t,e)}function Ko(t){var e=kt[t];return function(t,n){if(t=ya(t),(n=null==n?0:vn(ga(n),292))&&pn(t)){var r=(_a(t)+"e").split("e");return+((r=(_a(e(r[0]+"e"+(+r[1]+n)))+"e").split("e"))[0]+"e"+(+r[1]-n))}return e(t)}}var Xo=Dn&&1/nn(new Dn([,-0]))[1]==c?function(t){return new Dn(t)}:lu;function Qo(t){return function(e){var n=di(e);return n==w?Je(e):n==C?rn(e):function(t,e){return Ae(e,(function(e){return[e,t[e]]}))}(e,t(e))}}function qo(t,e,n,s,c,h,f,d){var p=2&e;if(!p&&"function"!=typeof t)throw new Ct(i);var g=s?s.length:0;if(g||(e&=-97,s=c=o),f=f===o?f:yn(ga(f),0),d=d===o?d:ga(d),g-=c?c.length:0,64&e){var m=s,y=c;s=c=o}var v=p?o:oi(t),_=[t,e,n,s,c,m,y,h,f,d];if(v&&function(t,e){var n=t[1],r=e[1],o=n|r,i=o<131,s=r==l&&8==n||r==l&&256==n&&t[7].length<=e[8]||384==r&&e[7].length<=e[8]&&8==n;if(!i&&!s)return t;1&r&&(t[2]=e[2],o|=1&n?0:4);var u=e[3];if(u){var c=t[3];t[3]=c?Do(c,u,e[4]):u,t[4]=c?en(t[3],a):e[4]}(u=e[5])&&(c=t[5],t[5]=c?Co(c,u,e[6]):u,t[6]=c?en(t[5],a):e[6]),(u=e[7])&&(t[7]=u),r&l&&(t[8]=null==t[8]?e[8]:vn(t[8],e[8])),null==t[9]&&(t[9]=e[9]),t[0]=e[0],t[1]=o}(_,v),t=_[0],e=_[1],n=_[2],s=_[3],c=_[4],!(d=_[9]=_[9]===o?p?0:t.length:yn(_[9]-g,0))&&24&e&&(e&=-25),e&&1!=e)x=8==e||16==e?function(t,e,n){var i=jo(t);return function s(){for(var a=arguments.length,u=r(a),l=a,c=si(s);l--;)u[l]=arguments[l];var h=a<3&&u[0]!==c&&u[a-1]!==c?[]:en(u,c);return(a-=h.length)<n?Vo(t,e,Bo,s.placeholder,o,u,h,o,o,n-a):ye(this&&this!==ie&&this instanceof s?i:t,this,u)}}(t,e,d):e!=u&&33!=e||c.length?Bo.apply(o,_):function(t,e,n,o){var i=1&e,s=jo(t);return function e(){for(var a=-1,u=arguments.length,l=-1,c=o.length,h=r(c+u),f=this&&this!==ie&&this instanceof e?s:t;++l<c;)h[l]=o[l];for(;u--;)h[l++]=arguments[++a];return ye(f,i?n:this,h)}}(t,e,n,s);else var x=function(t,e,n){var r=1&e,o=jo(t);return function e(){return(this&&this!==ie&&this instanceof e?o:t).apply(r?n:this,arguments)}}(t,e,n);return Pi((v?Zr:Ri)(x,_),t,e)}function $o(t,e,n,r){return t===o||Us(t,Tt[n])&&!Mt.call(r,n)?e:t}function Zo(t,e,n,r,i,s){return ea(t)&&ea(e)&&(s.set(e,t),Nr(t,e,o,Zo,s),s.delete(e)),t}function Jo(t){return ia(t)?o:t}function ti(t,e,n,r,i,s){var a=1&n,u=t.length,l=e.length;if(u!=l&&!(a&&l>u))return!1;var c=s.get(t),h=s.get(e);if(c&&h)return c==e&&h==t;var f=-1,d=!0,p=2&n?new Kn:o;for(s.set(t,e),s.set(e,t);++f<u;){var g=t[f],m=e[f];if(r)var y=a?r(m,g,f,e,t,s):r(g,m,f,t,e,s);if(y!==o){if(y)continue;d=!1;break}if(p){if(!Re(e,(function(t,e){if(!Ye(p,e)&&(g===t||i(g,t,n,r,s)))return p.push(e)}))){d=!1;break}}else if(g!==m&&!i(g,m,n,r,s)){d=!1;break}}return s.delete(t),s.delete(e),d}function ei(t){return Oi(Ai(t,o,Vi),t+"")}function ni(t){return kr(t,Pa,hi)}function ri(t){return kr(t,Ma,fi)}var oi=Rn?function(t){return Rn.get(t)}:lu;function ii(t){for(var e=t.name+"",n=Tn[e],r=Mt.call(Tn,e)?n.length:0;r--;){var o=n[r],i=o.func;if(null==i||i==t)return o.name}return e}function si(t){return(Mt.call(Bn,"placeholder")?Bn:t).placeholder}function ai(){var t=Bn.iteratee||iu;return t=t===iu?Er:t,arguments.length?t(arguments[0],arguments[1]):t}function ui(t,e){var n,r,o=t.__data__;return("string"==(r=typeof(n=e))||"number"==r||"symbol"==r||"boolean"==r?"__proto__"!==n:null===n)?o["string"==typeof e?"string":"hash"]:o.map}function li(t){for(var e=Pa(t),n=e.length;n--;){var r=e[n],o=t[r];e[n]=[r,o,ki(o)]}return e}function ci(t,e){var n=function(t,e){return null==t?o:t[e]}(t,e);return Mr(n)?n:o}var hi=fn?function(t){return null==t?[]:(t=St(t),we(fn(t),(function(e){return te.call(t,e)})))}:mu,fi=fn?function(t){for(var e=[];t;)De(e,hi(t)),t=Vt(t);return e}:mu,di=Sr;function pi(t,e,n){for(var r=-1,o=(e=vo(e,t)).length,i=!1;++r<o;){var s=Hi(e[r]);if(!(i=null!=t&&n(t,s)))break;t=t[s]}return i||++r!=o?i:!!(o=null==t?0:t.length)&&ta(o)&&yi(s,o)&&(Ys(t)||zs(t))}function gi(t){return"function"!=typeof t.constructor||wi(t)?{}:Nn(Vt(t))}function mi(t){return Ys(t)||zs(t)||!!(oe&&t&&t[oe])}function yi(t,e){var n=typeof t;return!!(e=null==e?h:e)&&("number"==n||"symbol"!=n&&yt.test(t))&&t>-1&&t%1==0&&t<e}function vi(t,e,n){if(!ea(n))return!1;var r=typeof e;return!!("number"==r?Ks(n)&&yi(e,n.length):"string"==r&&e in n)&&Us(n[e],t)}function _i(t,e){if(Ys(t))return!1;var n=typeof t;return!("number"!=n&&"symbol"!=n&&"boolean"!=n&&null!=t&&!la(t))||J.test(t)||!Z.test(t)||null!=e&&t in St(e)}function xi(t){var e=ii(t),n=Bn[e];if("function"!=typeof n||!(e in Wn.prototype))return!1;if(t===n)return!0;var r=oi(n);return!!r&&t===r[0]}(kn&&di(new kn(new ArrayBuffer(1)))!=P||Sn&&di(new Sn)!=w||An&&di(An.resolve())!=A||Dn&&di(new Dn)!=C||Cn&&di(new Cn)!=T)&&(di=function(t){var e=Sr(t),n=e==S?t.constructor:o,r=n?Bi(n):"";if(r)switch(r){case On:return P;case Pn:return w;case Mn:return A;case En:return C;case In:return T}return e});var bi=Ot?Zs:yu;function wi(t){var e=t&&t.constructor;return t===("function"==typeof e&&e.prototype||Tt)}function ki(t){return t==t&&!ea(t)}function Si(t,e){return function(n){return null!=n&&n[t]===e&&(e!==o||t in St(n))}}function Ai(t,e,n){return e=yn(e===o?t.length-1:e,0),function(){for(var o=arguments,i=-1,s=yn(o.length-e,0),a=r(s);++i<s;)a[i]=o[e+i];i=-1;for(var u=r(e+1);++i<e;)u[i]=o[i];return u[e]=n(a),ye(t,this,u)}}function Di(t,e){return e.length<2?t:wr(t,eo(e,0,-1))}function Ci(t,e){for(var n=t.length,r=vn(e.length,n),i=Lo(t);r--;){var s=e[r];t[r]=yi(s,n)?i[s]:o}return t}function Li(t,e){if(("constructor"!==e||"function"!=typeof t[e])&&"__proto__"!=e)return t[e]}var Ri=Mi(Zr),Ti=He||function(t,e){return ie.setTimeout(t,e)},Oi=Mi(Jr);function Pi(t,e,n){var r=e+"";return Oi(t,function(t,e){var n=e.length;if(!n)return t;var r=n-1;return e[r]=(n>1?"& ":"")+e[r],e=e.join(n>2?", ":" "),t.replace(it,"{\n/* [wrapped with "+e+"] */\n")}(r,function(t,e){return _e(p,(function(n){var r="_."+n[0];e&n[1]&&!ke(t,r)&&t.push(r)})),t.sort()}(function(t){var e=t.match(st);return e?e[1].split(at):[]}(r),n)))}function Mi(t){var e=0,n=0;return function(){var r=_n(),i=16-(r-n);if(n=r,i>0){if(++e>=800)return arguments[0]}else e=0;return t.apply(o,arguments)}}function Ei(t,e){var n=-1,r=t.length,i=r-1;for(e=e===o?r:e;++n<e;){var s=Vr(n,i),a=t[s];t[s]=t[n],t[n]=a}return t.length=e,t}var Ii,ji,Fi=(Ii=Is((function(t){var e=[];return 46===t.charCodeAt(0)&&e.push(""),t.replace(tt,(function(t,n,r,o){e.push(r?o.replace(ct,"$1"):n||t)})),e}),(function(t){return 500===ji.size&&ji.clear(),t})),ji=Ii.cache,Ii);function Hi(t){if("string"==typeof t||la(t))return t;var e=t+"";return"0"==e&&1/t==-1/0?"-0":e}function Bi(t){if(null!=t){try{return Pt.call(t)}catch(t){}try{return t+""}catch(t){}}return""}function Ni(t){if(t instanceof Wn)return t.clone();var e=new Gn(t.__wrapped__,t.__chain__);return e.__actions__=Lo(t.__actions__),e.__index__=t.__index__,e.__values__=t.__values__,e}var Ui=Xr((function(t,e){return Xs(t)?cr(t,mr(e,1,Xs,!0)):[]})),Gi=Xr((function(t,e){var n=$i(e);return Xs(n)&&(n=o),Xs(t)?cr(t,mr(e,1,Xs,!0),ai(n,2)):[]})),Wi=Xr((function(t,e){var n=$i(e);return Xs(n)&&(n=o),Xs(t)?cr(t,mr(e,1,Xs,!0),o,n):[]}));function zi(t,e,n){var r=null==t?0:t.length;if(!r)return-1;var o=null==n?0:ga(n);return o<0&&(o=yn(r+o,0)),Pe(t,ai(e,3),o)}function Yi(t,e,n){var r=null==t?0:t.length;if(!r)return-1;var i=r-1;return n!==o&&(i=ga(n),i=n<0?yn(r+i,0):vn(i,r-1)),Pe(t,ai(e,3),i,!0)}function Vi(t){return null!=t&&t.length?mr(t,1):[]}function Ki(t){return t&&t.length?t[0]:o}var Xi=Xr((function(t){var e=Ae(t,mo);return e.length&&e[0]===t[0]?Lr(e):[]})),Qi=Xr((function(t){var e=$i(t),n=Ae(t,mo);return e===$i(n)?e=o:n.pop(),n.length&&n[0]===t[0]?Lr(n,ai(e,2)):[]})),qi=Xr((function(t){var e=$i(t),n=Ae(t,mo);return(e="function"==typeof e?e:o)&&n.pop(),n.length&&n[0]===t[0]?Lr(n,o,e):[]}));function $i(t){var e=null==t?0:t.length;return e?t[e-1]:o}var Zi=Xr(Ji);function Ji(t,e){return t&&t.length&&e&&e.length?zr(t,e):t}var ts=ei((function(t,e){var n=null==t?0:t.length,r=ir(t,e);return Yr(t,Ae(e,(function(t){return yi(t,n)?+t:t})).sort(Ao)),r}));function es(t){return null==t?t:wn.call(t)}var ns=Xr((function(t){return uo(mr(t,1,Xs,!0))})),rs=Xr((function(t){var e=$i(t);return Xs(e)&&(e=o),uo(mr(t,1,Xs,!0),ai(e,2))})),os=Xr((function(t){var e=$i(t);return e="function"==typeof e?e:o,uo(mr(t,1,Xs,!0),o,e)}));function is(t){if(!t||!t.length)return[];var e=0;return t=we(t,(function(t){if(Xs(t))return e=yn(t.length,e),!0})),Ue(e,(function(e){return Ae(t,Fe(e))}))}function ss(t,e){if(!t||!t.length)return[];var n=is(t);return null==e?n:Ae(n,(function(t){return ye(e,o,t)}))}var as=Xr((function(t,e){return Xs(t)?cr(t,e):[]})),us=Xr((function(t){return po(we(t,Xs))})),ls=Xr((function(t){var e=$i(t);return Xs(e)&&(e=o),po(we(t,Xs),ai(e,2))})),cs=Xr((function(t){var e=$i(t);return e="function"==typeof e?e:o,po(we(t,Xs),o,e)})),hs=Xr(is),fs=Xr((function(t){var e=t.length,n=e>1?t[e-1]:o;return n="function"==typeof n?(t.pop(),n):o,ss(t,n)}));function ds(t){var e=Bn(t);return e.__chain__=!0,e}function ps(t,e){return e(t)}var gs=ei((function(t){var e=t.length,n=e?t[0]:0,r=this.__wrapped__,i=function(e){return ir(e,t)};return!(e>1||this.__actions__.length)&&r instanceof Wn&&yi(n)?((r=r.slice(n,+n+(e?1:0))).__actions__.push({func:ps,args:[i],thisArg:o}),new Gn(r,this.__chain__).thru((function(t){return e&&!t.length&&t.push(o),t}))):this.thru(i)})),ms=To((function(t,e,n){Mt.call(t,n)?++t[n]:or(t,n,1)})),ys=Fo(zi),vs=Fo(Yi);function _s(t,e){return(Ys(t)?_e:hr)(t,ai(e,3))}function xs(t,e){return(Ys(t)?xe:fr)(t,ai(e,3))}var bs=To((function(t,e,n){Mt.call(t,n)?t[n].push(e):or(t,n,[e])})),ws=Xr((function(t,e,n){var o=-1,i="function"==typeof e,s=Ks(t)?r(t.length):[];return hr(t,(function(t){s[++o]=i?ye(e,t,n):Rr(t,e,n)})),s})),ks=To((function(t,e,n){or(t,n,e)}));function Ss(t,e){return(Ys(t)?Ae:Fr)(t,ai(e,3))}var As=To((function(t,e,n){t[n?0:1].push(e)}),(function(){return[[],[]]})),Ds=Xr((function(t,e){if(null==t)return[];var n=e.length;return n>1&&vi(t,e[0],e[1])?e=[]:n>2&&vi(e[0],e[1],e[2])&&(e=[e[0]]),Gr(t,mr(e,1),[])})),Cs=Te||function(){return ie.Date.now()};function Ls(t,e,n){return e=n?o:e,e=t&&null==e?t.length:e,qo(t,l,o,o,o,o,e)}function Rs(t,e){var n;if("function"!=typeof e)throw new Ct(i);return t=ga(t),function(){return--t>0&&(n=e.apply(this,arguments)),t<=1&&(e=o),n}}var Ts=Xr((function(t,e,n){var r=1;if(n.length){var o=en(n,si(Ts));r|=u}return qo(t,r,e,n,o)})),Os=Xr((function(t,e,n){var r=3;if(n.length){var o=en(n,si(Os));r|=u}return qo(e,r,t,n,o)}));function Ps(t,e,n){var r,s,a,u,l,c,h=0,f=!1,d=!1,p=!0;if("function"!=typeof t)throw new Ct(i);function g(e){var n=r,i=s;return r=s=o,h=e,u=t.apply(i,n)}function m(t){return h=t,l=Ti(v,e),f?g(t):u}function y(t){var n=t-c;return c===o||n>=e||n<0||d&&t-h>=a}function v(){var t=Cs();if(y(t))return _(t);l=Ti(v,function(t){var n=e-(t-c);return d?vn(n,a-(t-h)):n}(t))}function _(t){return l=o,p&&r?g(t):(r=s=o,u)}function x(){var t=Cs(),n=y(t);if(r=arguments,s=this,c=t,n){if(l===o)return m(c);if(d)return bo(l),l=Ti(v,e),g(c)}return l===o&&(l=Ti(v,e)),u}return e=ya(e)||0,ea(n)&&(f=!!n.leading,a=(d="maxWait"in n)?yn(ya(n.maxWait)||0,e):a,p="trailing"in n?!!n.trailing:p),x.cancel=function(){l!==o&&bo(l),h=0,r=c=s=l=o},x.flush=function(){return l===o?u:_(Cs())},x}var Ms=Xr((function(t,e){return lr(t,1,e)})),Es=Xr((function(t,e,n){return lr(t,ya(e)||0,n)}));function Is(t,e){if("function"!=typeof t||null!=e&&"function"!=typeof e)throw new Ct(i);var n=function(){var r=arguments,o=e?e.apply(this,r):r[0],i=n.cache;if(i.has(o))return i.get(o);var s=t.apply(this,r);return n.cache=i.set(o,s)||i,s};return n.cache=new(Is.Cache||Vn),n}function js(t){if("function"!=typeof t)throw new Ct(i);return function(){var e=arguments;switch(e.length){case 0:return!t.call(this);case 1:return!t.call(this,e[0]);case 2:return!t.call(this,e[0],e[1]);case 3:return!t.call(this,e[0],e[1],e[2])}return!t.apply(this,e)}}Is.Cache=Vn;var Fs=_o((function(t,e){var n=(e=1==e.length&&Ys(e[0])?Ae(e[0],We(ai())):Ae(mr(e,1),We(ai()))).length;return Xr((function(r){for(var o=-1,i=vn(r.length,n);++o<i;)r[o]=e[o].call(this,r[o]);return ye(t,this,r)}))})),Hs=Xr((function(t,e){var n=en(e,si(Hs));return qo(t,u,o,e,n)})),Bs=Xr((function(t,e){var n=en(e,si(Bs));return qo(t,64,o,e,n)})),Ns=ei((function(t,e){return qo(t,256,o,o,o,e)}));function Us(t,e){return t===e||t!=t&&e!=e}var Gs=Yo(Ar),Ws=Yo((function(t,e){return t>=e})),zs=Tr(function(){return arguments}())?Tr:function(t){return na(t)&&Mt.call(t,"callee")&&!te.call(t,"callee")},Ys=r.isArray,Vs=he?We(he):function(t){return na(t)&&Sr(t)==O};function Ks(t){return null!=t&&ta(t.length)&&!Zs(t)}function Xs(t){return na(t)&&Ks(t)}var Qs=dn||yu,qs=fe?We(fe):function(t){return na(t)&&Sr(t)==v};function $s(t){if(!na(t))return!1;var e=Sr(t);return e==_||"[object DOMException]"==e||"string"==typeof t.message&&"string"==typeof t.name&&!ia(t)}function Zs(t){if(!ea(t))return!1;var e=Sr(t);return e==x||e==b||"[object AsyncFunction]"==e||"[object Proxy]"==e}function Js(t){return"number"==typeof t&&t==ga(t)}function ta(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=h}function ea(t){var e=typeof t;return null!=t&&("object"==e||"function"==e)}function na(t){return null!=t&&"object"==typeof t}var ra=de?We(de):function(t){return na(t)&&di(t)==w};function oa(t){return"number"==typeof t||na(t)&&Sr(t)==k}function ia(t){if(!na(t)||Sr(t)!=S)return!1;var e=Vt(t);if(null===e)return!0;var n=Mt.call(e,"constructor")&&e.constructor;return"function"==typeof n&&n instanceof n&&Pt.call(n)==Ft}var sa=pe?We(pe):function(t){return na(t)&&Sr(t)==D},aa=ge?We(ge):function(t){return na(t)&&di(t)==C};function ua(t){return"string"==typeof t||!Ys(t)&&na(t)&&Sr(t)==L}function la(t){return"symbol"==typeof t||na(t)&&Sr(t)==R}var ca=me?We(me):function(t){return na(t)&&ta(t.length)&&!!Zt[Sr(t)]},ha=Yo(jr),fa=Yo((function(t,e){return t<=e}));function da(t){if(!t)return[];if(Ks(t))return ua(t)?sn(t):Lo(t);if(se&&t[se])return function(t){for(var e,n=[];!(e=t.next()).done;)n.push(e.value);return n}(t[se]());var e=di(t);return(e==w?Je:e==C?nn:Ua)(t)}function pa(t){return t?(t=ya(t))===c||t===-1/0?17976931348623157e292*(t<0?-1:1):t==t?t:0:0===t?t:0}function ga(t){var e=pa(t),n=e%1;return e==e?n?e-n:e:0}function ma(t){return t?sr(ga(t),0,d):0}function ya(t){if("number"==typeof t)return t;if(la(t))return f;if(ea(t)){var e="function"==typeof t.valueOf?t.valueOf():t;t=ea(e)?e+"":e}if("string"!=typeof t)return 0===t?t:+t;t=Ge(t);var n=pt.test(t);return n||mt.test(t)?ne(t.slice(2),n?2:8):dt.test(t)?f:+t}function va(t){return Ro(t,Ma(t))}function _a(t){return null==t?"":ao(t)}var xa=Oo((function(t,e){if(wi(e)||Ks(e))Ro(e,Pa(e),t);else for(var n in e)Mt.call(e,n)&&tr(t,n,e[n])})),ba=Oo((function(t,e){Ro(e,Ma(e),t)})),wa=Oo((function(t,e,n,r){Ro(e,Ma(e),t,r)})),ka=Oo((function(t,e,n,r){Ro(e,Pa(e),t,r)})),Sa=ei(ir),Aa=Xr((function(t,e){t=St(t);var n=-1,r=e.length,i=r>2?e[2]:o;for(i&&vi(e[0],e[1],i)&&(r=1);++n<r;)for(var s=e[n],a=Ma(s),u=-1,l=a.length;++u<l;){var c=a[u],h=t[c];(h===o||Us(h,Tt[c])&&!Mt.call(t,c))&&(t[c]=s[c])}return t})),Da=Xr((function(t){return t.push(o,Zo),ye(Ia,o,t)}));function Ca(t,e,n){var r=null==t?o:wr(t,e);return r===o?n:r}function La(t,e){return null!=t&&pi(t,e,Cr)}var Ra=No((function(t,e,n){null!=e&&"function"!=typeof e.toString&&(e=jt.call(e)),t[e]=n}),eu(ou)),Ta=No((function(t,e,n){null!=e&&"function"!=typeof e.toString&&(e=jt.call(e)),Mt.call(t,e)?t[e].push(n):t[e]=[n]}),ai),Oa=Xr(Rr);function Pa(t){return Ks(t)?Qn(t):Ir(t)}function Ma(t){return Ks(t)?Qn(t,!0):function(t){if(!ea(t))return function(t){var e=[];if(null!=t)for(var n in St(t))e.push(n);return e}(t);var e=wi(t),n=[];for(var r in t)("constructor"!=r||!e&&Mt.call(t,r))&&n.push(r);return n}(t)}var Ea=Oo((function(t,e,n){Nr(t,e,n)})),Ia=Oo((function(t,e,n,r){Nr(t,e,n,r)})),ja=ei((function(t,e){var n={};if(null==t)return n;var r=!1;e=Ae(e,(function(e){return e=vo(e,t),r||(r=e.length>1),e})),Ro(t,ri(t),n),r&&(n=ar(n,7,Jo));for(var o=e.length;o--;)lo(n,e[o]);return n})),Fa=ei((function(t,e){return null==t?{}:function(t,e){return Wr(t,e,(function(e,n){return La(t,n)}))}(t,e)}));function Ha(t,e){if(null==t)return{};var n=Ae(ri(t),(function(t){return[t]}));return e=ai(e),Wr(t,n,(function(t,n){return e(t,n[0])}))}var Ba=Qo(Pa),Na=Qo(Ma);function Ua(t){return null==t?[]:ze(t,Pa(t))}var Ga=Io((function(t,e,n){return e=e.toLowerCase(),t+(n?Wa(e):e)}));function Wa(t){return $a(_a(t).toLowerCase())}function za(t){return(t=_a(t))&&t.replace(vt,Qe).replace(Yt,"")}var Ya=Io((function(t,e,n){return t+(n?"-":"")+e.toLowerCase()})),Va=Io((function(t,e,n){return t+(n?" ":"")+e.toLowerCase()})),Ka=Eo("toLowerCase"),Xa=Io((function(t,e,n){return t+(n?"_":"")+e.toLowerCase()})),Qa=Io((function(t,e,n){return t+(n?" ":"")+$a(e)})),qa=Io((function(t,e,n){return t+(n?" ":"")+e.toUpperCase()})),$a=Eo("toUpperCase");function Za(t,e,n){return t=_a(t),(e=n?o:e)===o?function(t){return Qt.test(t)}(t)?function(t){return t.match(Kt)||[]}(t):function(t){return t.match(ut)||[]}(t):t.match(e)||[]}var Ja=Xr((function(t,e){try{return ye(t,o,e)}catch(t){return $s(t)?t:new bt(t)}})),tu=ei((function(t,e){return _e(e,(function(e){e=Hi(e),or(t,e,Ts(t[e],t))})),t}));function eu(t){return function(){return t}}var nu=Ho(),ru=Ho(!0);function ou(t){return t}function iu(t){return Er("function"==typeof t?t:ar(t,1))}var su=Xr((function(t,e){return function(n){return Rr(n,t,e)}})),au=Xr((function(t,e){return function(n){return Rr(t,n,e)}}));function uu(t,e,n){var r=Pa(e),o=br(e,r);null!=n||ea(e)&&(o.length||!r.length)||(n=e,e=t,t=this,o=br(e,Pa(e)));var i=!(ea(n)&&"chain"in n&&!n.chain),s=Zs(t);return _e(o,(function(n){var r=e[n];t[n]=r,s&&(t.prototype[n]=function(){var e=this.__chain__;if(i||e){var n=t(this.__wrapped__),o=n.__actions__=Lo(this.__actions__);return o.push({func:r,args:arguments,thisArg:t}),n.__chain__=e,n}return r.apply(t,De([this.value()],arguments))})})),t}function lu(){}var cu=Go(Ae),hu=Go(be),fu=Go(Re);function du(t){return _i(t)?Fe(Hi(t)):function(t){return function(e){return wr(e,t)}}(t)}var pu=zo(),gu=zo(!0);function mu(){return[]}function yu(){return!1}var vu,_u=Uo((function(t,e){return t+e}),0),xu=Ko("ceil"),bu=Uo((function(t,e){return t/e}),1),wu=Ko("floor"),ku=Uo((function(t,e){return t*e}),1),Su=Ko("round"),Au=Uo((function(t,e){return t-e}),0);return Bn.after=function(t,e){if("function"!=typeof e)throw new Ct(i);return t=ga(t),function(){if(--t<1)return e.apply(this,arguments)}},Bn.ary=Ls,Bn.assign=xa,Bn.assignIn=ba,Bn.assignInWith=wa,Bn.assignWith=ka,Bn.at=Sa,Bn.before=Rs,Bn.bind=Ts,Bn.bindAll=tu,Bn.bindKey=Os,Bn.castArray=function(){if(!arguments.length)return[];var t=arguments[0];return Ys(t)?t:[t]},Bn.chain=ds,Bn.chunk=function(t,e,n){e=(n?vi(t,e,n):e===o)?1:yn(ga(e),0);var i=null==t?0:t.length;if(!i||e<1)return[];for(var s=0,a=0,u=r(cn(i/e));s<i;)u[a++]=eo(t,s,s+=e);return u},Bn.compact=function(t){for(var e=-1,n=null==t?0:t.length,r=0,o=[];++e<n;){var i=t[e];i&&(o[r++]=i)}return o},Bn.concat=function(){var t=arguments.length;if(!t)return[];for(var e=r(t-1),n=arguments[0],o=t;o--;)e[o-1]=arguments[o];return De(Ys(n)?Lo(n):[n],mr(e,1))},Bn.cond=function(t){var e=null==t?0:t.length,n=ai();return t=e?Ae(t,(function(t){if("function"!=typeof t[1])throw new Ct(i);return[n(t[0]),t[1]]})):[],Xr((function(n){for(var r=-1;++r<e;){var o=t[r];if(ye(o[0],this,n))return ye(o[1],this,n)}}))},Bn.conforms=function(t){return function(t){var e=Pa(t);return function(n){return ur(n,t,e)}}(ar(t,1))},Bn.constant=eu,Bn.countBy=ms,Bn.create=function(t,e){var n=Nn(t);return null==e?n:rr(n,e)},Bn.curry=function t(e,n,r){var i=qo(e,8,o,o,o,o,o,n=r?o:n);return i.placeholder=t.placeholder,i},Bn.curryRight=function t(e,n,r){var i=qo(e,16,o,o,o,o,o,n=r?o:n);return i.placeholder=t.placeholder,i},Bn.debounce=Ps,Bn.defaults=Aa,Bn.defaultsDeep=Da,Bn.defer=Ms,Bn.delay=Es,Bn.difference=Ui,Bn.differenceBy=Gi,Bn.differenceWith=Wi,Bn.drop=function(t,e,n){var r=null==t?0:t.length;return r?eo(t,(e=n||e===o?1:ga(e))<0?0:e,r):[]},Bn.dropRight=function(t,e,n){var r=null==t?0:t.length;return r?eo(t,0,(e=r-(e=n||e===o?1:ga(e)))<0?0:e):[]},Bn.dropRightWhile=function(t,e){return t&&t.length?ho(t,ai(e,3),!0,!0):[]},Bn.dropWhile=function(t,e){return t&&t.length?ho(t,ai(e,3),!0):[]},Bn.fill=function(t,e,n,r){var i=null==t?0:t.length;return i?(n&&"number"!=typeof n&&vi(t,e,n)&&(n=0,r=i),function(t,e,n,r){var i=t.length;for((n=ga(n))<0&&(n=-n>i?0:i+n),(r=r===o||r>i?i:ga(r))<0&&(r+=i),r=n>r?0:ma(r);n<r;)t[n++]=e;return t}(t,e,n,r)):[]},Bn.filter=function(t,e){return(Ys(t)?we:gr)(t,ai(e,3))},Bn.flatMap=function(t,e){return mr(Ss(t,e),1)},Bn.flatMapDeep=function(t,e){return mr(Ss(t,e),c)},Bn.flatMapDepth=function(t,e,n){return n=n===o?1:ga(n),mr(Ss(t,e),n)},Bn.flatten=Vi,Bn.flattenDeep=function(t){return null!=t&&t.length?mr(t,c):[]},Bn.flattenDepth=function(t,e){return null!=t&&t.length?mr(t,e=e===o?1:ga(e)):[]},Bn.flip=function(t){return qo(t,512)},Bn.flow=nu,Bn.flowRight=ru,Bn.fromPairs=function(t){for(var e=-1,n=null==t?0:t.length,r={};++e<n;){var o=t[e];r[o[0]]=o[1]}return r},Bn.functions=function(t){return null==t?[]:br(t,Pa(t))},Bn.functionsIn=function(t){return null==t?[]:br(t,Ma(t))},Bn.groupBy=bs,Bn.initial=function(t){return null!=t&&t.length?eo(t,0,-1):[]},Bn.intersection=Xi,Bn.intersectionBy=Qi,Bn.intersectionWith=qi,Bn.invert=Ra,Bn.invertBy=Ta,Bn.invokeMap=ws,Bn.iteratee=iu,Bn.keyBy=ks,Bn.keys=Pa,Bn.keysIn=Ma,Bn.map=Ss,Bn.mapKeys=function(t,e){var n={};return e=ai(e,3),_r(t,(function(t,r,o){or(n,e(t,r,o),t)})),n},Bn.mapValues=function(t,e){var n={};return e=ai(e,3),_r(t,(function(t,r,o){or(n,r,e(t,r,o))})),n},Bn.matches=function(t){return Hr(ar(t,1))},Bn.matchesProperty=function(t,e){return Br(t,ar(e,1))},Bn.memoize=Is,Bn.merge=Ea,Bn.mergeWith=Ia,Bn.method=su,Bn.methodOf=au,Bn.mixin=uu,Bn.negate=js,Bn.nthArg=function(t){return t=ga(t),Xr((function(e){return Ur(e,t)}))},Bn.omit=ja,Bn.omitBy=function(t,e){return Ha(t,js(ai(e)))},Bn.once=function(t){return Rs(2,t)},Bn.orderBy=function(t,e,n,r){return null==t?[]:(Ys(e)||(e=null==e?[]:[e]),Ys(n=r?o:n)||(n=null==n?[]:[n]),Gr(t,e,n))},Bn.over=cu,Bn.overArgs=Fs,Bn.overEvery=hu,Bn.overSome=fu,Bn.partial=Hs,Bn.partialRight=Bs,Bn.partition=As,Bn.pick=Fa,Bn.pickBy=Ha,Bn.property=du,Bn.propertyOf=function(t){return function(e){return null==t?o:wr(t,e)}},Bn.pull=Zi,Bn.pullAll=Ji,Bn.pullAllBy=function(t,e,n){return t&&t.length&&e&&e.length?zr(t,e,ai(n,2)):t},Bn.pullAllWith=function(t,e,n){return t&&t.length&&e&&e.length?zr(t,e,o,n):t},Bn.pullAt=ts,Bn.range=pu,Bn.rangeRight=gu,Bn.rearg=Ns,Bn.reject=function(t,e){return(Ys(t)?we:gr)(t,js(ai(e,3)))},Bn.remove=function(t,e){var n=[];if(!t||!t.length)return n;var r=-1,o=[],i=t.length;for(e=ai(e,3);++r<i;){var s=t[r];e(s,r,t)&&(n.push(s),o.push(r))}return Yr(t,o),n},Bn.rest=function(t,e){if("function"!=typeof t)throw new Ct(i);return Xr(t,e=e===o?e:ga(e))},Bn.reverse=es,Bn.sampleSize=function(t,e,n){return e=(n?vi(t,e,n):e===o)?1:ga(e),(Ys(t)?$n:qr)(t,e)},Bn.set=function(t,e,n){return null==t?t:$r(t,e,n)},Bn.setWith=function(t,e,n,r){return r="function"==typeof r?r:o,null==t?t:$r(t,e,n,r)},Bn.shuffle=function(t){return(Ys(t)?Zn:to)(t)},Bn.slice=function(t,e,n){var r=null==t?0:t.length;return r?(n&&"number"!=typeof n&&vi(t,e,n)?(e=0,n=r):(e=null==e?0:ga(e),n=n===o?r:ga(n)),eo(t,e,n)):[]},Bn.sortBy=Ds,Bn.sortedUniq=function(t){return t&&t.length?io(t):[]},Bn.sortedUniqBy=function(t,e){return t&&t.length?io(t,ai(e,2)):[]},Bn.split=function(t,e,n){return n&&"number"!=typeof n&&vi(t,e,n)&&(e=n=o),(n=n===o?d:n>>>0)?(t=_a(t))&&("string"==typeof e||null!=e&&!sa(e))&&!(e=ao(e))&&Ze(t)?xo(sn(t),0,n):t.split(e,n):[]},Bn.spread=function(t,e){if("function"!=typeof t)throw new Ct(i);return e=null==e?0:yn(ga(e),0),Xr((function(n){var r=n[e],o=xo(n,0,e);return r&&De(o,r),ye(t,this,o)}))},Bn.tail=function(t){var e=null==t?0:t.length;return e?eo(t,1,e):[]},Bn.take=function(t,e,n){return t&&t.length?eo(t,0,(e=n||e===o?1:ga(e))<0?0:e):[]},Bn.takeRight=function(t,e,n){var r=null==t?0:t.length;return r?eo(t,(e=r-(e=n||e===o?1:ga(e)))<0?0:e,r):[]},Bn.takeRightWhile=function(t,e){return t&&t.length?ho(t,ai(e,3),!1,!0):[]},Bn.takeWhile=function(t,e){return t&&t.length?ho(t,ai(e,3)):[]},Bn.tap=function(t,e){return e(t),t},Bn.throttle=function(t,e,n){var r=!0,o=!0;if("function"!=typeof t)throw new Ct(i);return ea(n)&&(r="leading"in n?!!n.leading:r,o="trailing"in n?!!n.trailing:o),Ps(t,e,{leading:r,maxWait:e,trailing:o})},Bn.thru=ps,Bn.toArray=da,Bn.toPairs=Ba,Bn.toPairsIn=Na,Bn.toPath=function(t){return Ys(t)?Ae(t,Hi):la(t)?[t]:Lo(Fi(_a(t)))},Bn.toPlainObject=va,Bn.transform=function(t,e,n){var r=Ys(t),o=r||Qs(t)||ca(t);if(e=ai(e,4),null==n){var i=t&&t.constructor;n=o?r?new i:[]:ea(t)&&Zs(i)?Nn(Vt(t)):{}}return(o?_e:_r)(t,(function(t,r,o){return e(n,t,r,o)})),n},Bn.unary=function(t){return Ls(t,1)},Bn.union=ns,Bn.unionBy=rs,Bn.unionWith=os,Bn.uniq=function(t){return t&&t.length?uo(t):[]},Bn.uniqBy=function(t,e){return t&&t.length?uo(t,ai(e,2)):[]},Bn.uniqWith=function(t,e){return e="function"==typeof e?e:o,t&&t.length?uo(t,o,e):[]},Bn.unset=function(t,e){return null==t||lo(t,e)},Bn.unzip=is,Bn.unzipWith=ss,Bn.update=function(t,e,n){return null==t?t:co(t,e,yo(n))},Bn.updateWith=function(t,e,n,r){return r="function"==typeof r?r:o,null==t?t:co(t,e,yo(n),r)},Bn.values=Ua,Bn.valuesIn=function(t){return null==t?[]:ze(t,Ma(t))},Bn.without=as,Bn.words=Za,Bn.wrap=function(t,e){return Hs(yo(e),t)},Bn.xor=us,Bn.xorBy=ls,Bn.xorWith=cs,Bn.zip=hs,Bn.zipObject=function(t,e){return go(t||[],e||[],tr)},Bn.zipObjectDeep=function(t,e){return go(t||[],e||[],$r)},Bn.zipWith=fs,Bn.entries=Ba,Bn.entriesIn=Na,Bn.extend=ba,Bn.extendWith=wa,uu(Bn,Bn),Bn.add=_u,Bn.attempt=Ja,Bn.camelCase=Ga,Bn.capitalize=Wa,Bn.ceil=xu,Bn.clamp=function(t,e,n){return n===o&&(n=e,e=o),n!==o&&(n=(n=ya(n))==n?n:0),e!==o&&(e=(e=ya(e))==e?e:0),sr(ya(t),e,n)},Bn.clone=function(t){return ar(t,4)},Bn.cloneDeep=function(t){return ar(t,5)},Bn.cloneDeepWith=function(t,e){return ar(t,5,e="function"==typeof e?e:o)},Bn.cloneWith=function(t,e){return ar(t,4,e="function"==typeof e?e:o)},Bn.conformsTo=function(t,e){return null==e||ur(t,e,Pa(e))},Bn.deburr=za,Bn.defaultTo=function(t,e){return null==t||t!=t?e:t},Bn.divide=bu,Bn.endsWith=function(t,e,n){t=_a(t),e=ao(e);var r=t.length,i=n=n===o?r:sr(ga(n),0,r);return(n-=e.length)>=0&&t.slice(n,i)==e},Bn.eq=Us,Bn.escape=function(t){return(t=_a(t))&&X.test(t)?t.replace(V,qe):t},Bn.escapeRegExp=function(t){return(t=_a(t))&&nt.test(t)?t.replace(et,"\\$&"):t},Bn.every=function(t,e,n){var r=Ys(t)?be:dr;return n&&vi(t,e,n)&&(e=o),r(t,ai(e,3))},Bn.find=ys,Bn.findIndex=zi,Bn.findKey=function(t,e){return Oe(t,ai(e,3),_r)},Bn.findLast=vs,Bn.findLastIndex=Yi,Bn.findLastKey=function(t,e){return Oe(t,ai(e,3),xr)},Bn.floor=wu,Bn.forEach=_s,Bn.forEachRight=xs,Bn.forIn=function(t,e){return null==t?t:yr(t,ai(e,3),Ma)},Bn.forInRight=function(t,e){return null==t?t:vr(t,ai(e,3),Ma)},Bn.forOwn=function(t,e){return t&&_r(t,ai(e,3))},Bn.forOwnRight=function(t,e){return t&&xr(t,ai(e,3))},Bn.get=Ca,Bn.gt=Gs,Bn.gte=Ws,Bn.has=function(t,e){return null!=t&&pi(t,e,Dr)},Bn.hasIn=La,Bn.head=Ki,Bn.identity=ou,Bn.includes=function(t,e,n,r){t=Ks(t)?t:Ua(t),n=n&&!r?ga(n):0;var o=t.length;return n<0&&(n=yn(o+n,0)),ua(t)?n<=o&&t.indexOf(e,n)>-1:!!o&&Me(t,e,n)>-1},Bn.indexOf=function(t,e,n){var r=null==t?0:t.length;if(!r)return-1;var o=null==n?0:ga(n);return o<0&&(o=yn(r+o,0)),Me(t,e,o)},Bn.inRange=function(t,e,n){return e=pa(e),n===o?(n=e,e=0):n=pa(n),function(t,e,n){return t>=vn(e,n)&&t<yn(e,n)}(t=ya(t),e,n)},Bn.invoke=Oa,Bn.isArguments=zs,Bn.isArray=Ys,Bn.isArrayBuffer=Vs,Bn.isArrayLike=Ks,Bn.isArrayLikeObject=Xs,Bn.isBoolean=function(t){return!0===t||!1===t||na(t)&&Sr(t)==y},Bn.isBuffer=Qs,Bn.isDate=qs,Bn.isElement=function(t){return na(t)&&1===t.nodeType&&!ia(t)},Bn.isEmpty=function(t){if(null==t)return!0;if(Ks(t)&&(Ys(t)||"string"==typeof t||"function"==typeof t.splice||Qs(t)||ca(t)||zs(t)))return!t.length;var e=di(t);if(e==w||e==C)return!t.size;if(wi(t))return!Ir(t).length;for(var n in t)if(Mt.call(t,n))return!1;return!0},Bn.isEqual=function(t,e){return Or(t,e)},Bn.isEqualWith=function(t,e,n){var r=(n="function"==typeof n?n:o)?n(t,e):o;return r===o?Or(t,e,o,n):!!r},Bn.isError=$s,Bn.isFinite=function(t){return"number"==typeof t&&pn(t)},Bn.isFunction=Zs,Bn.isInteger=Js,Bn.isLength=ta,Bn.isMap=ra,Bn.isMatch=function(t,e){return t===e||Pr(t,e,li(e))},Bn.isMatchWith=function(t,e,n){return n="function"==typeof n?n:o,Pr(t,e,li(e),n)},Bn.isNaN=function(t){return oa(t)&&t!=+t},Bn.isNative=function(t){if(bi(t))throw new bt("Unsupported core-js use. Try https://npms.io/search?q=ponyfill.");return Mr(t)},Bn.isNil=function(t){return null==t},Bn.isNull=function(t){return null===t},Bn.isNumber=oa,Bn.isObject=ea,Bn.isObjectLike=na,Bn.isPlainObject=ia,Bn.isRegExp=sa,Bn.isSafeInteger=function(t){return Js(t)&&t>=-9007199254740991&&t<=h},Bn.isSet=aa,Bn.isString=ua,Bn.isSymbol=la,Bn.isTypedArray=ca,Bn.isUndefined=function(t){return t===o},Bn.isWeakMap=function(t){return na(t)&&di(t)==T},Bn.isWeakSet=function(t){return na(t)&&"[object WeakSet]"==Sr(t)},Bn.join=function(t,e){return null==t?"":gn.call(t,e)},Bn.kebabCase=Ya,Bn.last=$i,Bn.lastIndexOf=function(t,e,n){var r=null==t?0:t.length;if(!r)return-1;var i=r;return n!==o&&(i=(i=ga(n))<0?yn(r+i,0):vn(i,r-1)),e==e?function(t,e,n){for(var r=n+1;r--;)if(t[r]===e)return r;return r}(t,e,i):Pe(t,Ie,i,!0)},Bn.lowerCase=Va,Bn.lowerFirst=Ka,Bn.lt=ha,Bn.lte=fa,Bn.max=function(t){return t&&t.length?pr(t,ou,Ar):o},Bn.maxBy=function(t,e){return t&&t.length?pr(t,ai(e,2),Ar):o},Bn.mean=function(t){return je(t,ou)},Bn.meanBy=function(t,e){return je(t,ai(e,2))},Bn.min=function(t){return t&&t.length?pr(t,ou,jr):o},Bn.minBy=function(t,e){return t&&t.length?pr(t,ai(e,2),jr):o},Bn.stubArray=mu,Bn.stubFalse=yu,Bn.stubObject=function(){return{}},Bn.stubString=function(){return""},Bn.stubTrue=function(){return!0},Bn.multiply=ku,Bn.nth=function(t,e){return t&&t.length?Ur(t,ga(e)):o},Bn.noConflict=function(){return ie._===this&&(ie._=Ht),this},Bn.noop=lu,Bn.now=Cs,Bn.pad=function(t,e,n){t=_a(t);var r=(e=ga(e))?on(t):0;if(!e||r>=e)return t;var o=(e-r)/2;return Wo(hn(o),n)+t+Wo(cn(o),n)},Bn.padEnd=function(t,e,n){t=_a(t);var r=(e=ga(e))?on(t):0;return e&&r<e?t+Wo(e-r,n):t},Bn.padStart=function(t,e,n){t=_a(t);var r=(e=ga(e))?on(t):0;return e&&r<e?Wo(e-r,n)+t:t},Bn.parseInt=function(t,e,n){return n||null==e?e=0:e&&(e=+e),xn(_a(t).replace(rt,""),e||0)},Bn.random=function(t,e,n){if(n&&"boolean"!=typeof n&&vi(t,e,n)&&(e=n=o),n===o&&("boolean"==typeof e?(n=e,e=o):"boolean"==typeof t&&(n=t,t=o)),t===o&&e===o?(t=0,e=1):(t=pa(t),e===o?(e=t,t=0):e=pa(e)),t>e){var r=t;t=e,e=r}if(n||t%1||e%1){var i=bn();return vn(t+i*(e-t+ee("1e-"+((i+"").length-1))),e)}return Vr(t,e)},Bn.reduce=function(t,e,n){var r=Ys(t)?Ce:Be,o=arguments.length<3;return r(t,ai(e,4),n,o,hr)},Bn.reduceRight=function(t,e,n){var r=Ys(t)?Le:Be,o=arguments.length<3;return r(t,ai(e,4),n,o,fr)},Bn.repeat=function(t,e,n){return e=(n?vi(t,e,n):e===o)?1:ga(e),Kr(_a(t),e)},Bn.replace=function(){var t=arguments,e=_a(t[0]);return t.length<3?e:e.replace(t[1],t[2])},Bn.result=function(t,e,n){var r=-1,i=(e=vo(e,t)).length;for(i||(i=1,t=o);++r<i;){var s=null==t?o:t[Hi(e[r])];s===o&&(r=i,s=n),t=Zs(s)?s.call(t):s}return t},Bn.round=Su,Bn.runInContext=t,Bn.sample=function(t){return(Ys(t)?qn:Qr)(t)},Bn.size=function(t){if(null==t)return 0;if(Ks(t))return ua(t)?on(t):t.length;var e=di(t);return e==w||e==C?t.size:Ir(t).length},Bn.snakeCase=Xa,Bn.some=function(t,e,n){var r=Ys(t)?Re:no;return n&&vi(t,e,n)&&(e=o),r(t,ai(e,3))},Bn.sortedIndex=function(t,e){return ro(t,e)},Bn.sortedIndexBy=function(t,e,n){return oo(t,e,ai(n,2))},Bn.sortedIndexOf=function(t,e){var n=null==t?0:t.length;if(n){var r=ro(t,e);if(r<n&&Us(t[r],e))return r}return-1},Bn.sortedLastIndex=function(t,e){return ro(t,e,!0)},Bn.sortedLastIndexBy=function(t,e,n){return oo(t,e,ai(n,2),!0)},Bn.sortedLastIndexOf=function(t,e){if(null!=t&&t.length){var n=ro(t,e,!0)-1;if(Us(t[n],e))return n}return-1},Bn.startCase=Qa,Bn.startsWith=function(t,e,n){return t=_a(t),n=null==n?0:sr(ga(n),0,t.length),e=ao(e),t.slice(n,n+e.length)==e},Bn.subtract=Au,Bn.sum=function(t){return t&&t.length?Ne(t,ou):0},Bn.sumBy=function(t,e){return t&&t.length?Ne(t,ai(e,2)):0},Bn.template=function(t,e,n){var r=Bn.templateSettings;n&&vi(t,e,n)&&(e=o),t=_a(t),e=wa({},e,r,$o);var i,s,a=wa({},e.imports,r.imports,$o),u=Pa(a),l=ze(a,u),c=0,h=e.interpolate||_t,f="__p += '",d=At((e.escape||_t).source+"|"+h.source+"|"+(h===$?ht:_t).source+"|"+(e.evaluate||_t).source+"|$","g"),p="//# sourceURL="+(Mt.call(e,"sourceURL")?(e.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++$t+"]")+"\n";t.replace(d,(function(e,n,r,o,a,u){return r||(r=o),f+=t.slice(c,u).replace(xt,$e),n&&(i=!0,f+="' +\n__e("+n+") +\n'"),a&&(s=!0,f+="';\n"+a+";\n__p += '"),r&&(f+="' +\n((__t = ("+r+")) == null ? '' : __t) +\n'"),c=u+e.length,e})),f+="';\n";var g=Mt.call(e,"variable")&&e.variable;if(g){if(lt.test(g))throw new bt("Invalid `variable` option passed into `_.template`")}else f="with (obj) {\n"+f+"\n}\n";f=(s?f.replace(G,""):f).replace(W,"$1").replace(z,"$1;"),f="function("+(g||"obj")+") {\n"+(g?"":"obj || (obj = {});\n")+"var __t, __p = ''"+(i?", __e = _.escape":"")+(s?", __j = Array.prototype.join;\nfunction print() { __p += __j.call(arguments, '') }\n":";\n")+f+"return __p\n}";var m=Ja((function(){return wt(u,p+"return "+f).apply(o,l)}));if(m.source=f,$s(m))throw m;return m},Bn.times=function(t,e){if((t=ga(t))<1||t>h)return[];var n=d,r=vn(t,d);e=ai(e),t-=d;for(var o=Ue(r,e);++n<t;)e(n);return o},Bn.toFinite=pa,Bn.toInteger=ga,Bn.toLength=ma,Bn.toLower=function(t){return _a(t).toLowerCase()},Bn.toNumber=ya,Bn.toSafeInteger=function(t){return t?sr(ga(t),-9007199254740991,h):0===t?t:0},Bn.toString=_a,Bn.toUpper=function(t){return _a(t).toUpperCase()},Bn.trim=function(t,e,n){if((t=_a(t))&&(n||e===o))return Ge(t);if(!t||!(e=ao(e)))return t;var r=sn(t),i=sn(e);return xo(r,Ve(r,i),Ke(r,i)+1).join("")},Bn.trimEnd=function(t,e,n){if((t=_a(t))&&(n||e===o))return t.slice(0,an(t)+1);if(!t||!(e=ao(e)))return t;var r=sn(t);return xo(r,0,Ke(r,sn(e))+1).join("")},Bn.trimStart=function(t,e,n){if((t=_a(t))&&(n||e===o))return t.replace(rt,"");if(!t||!(e=ao(e)))return t;var r=sn(t);return xo(r,Ve(r,sn(e))).join("")},Bn.truncate=function(t,e){var n=30,r="...";if(ea(e)){var i="separator"in e?e.separator:i;n="length"in e?ga(e.length):n,r="omission"in e?ao(e.omission):r}var s=(t=_a(t)).length;if(Ze(t)){var a=sn(t);s=a.length}if(n>=s)return t;var u=n-on(r);if(u<1)return r;var l=a?xo(a,0,u).join(""):t.slice(0,u);if(i===o)return l+r;if(a&&(u+=l.length-u),sa(i)){if(t.slice(u).search(i)){var c,h=l;for(i.global||(i=At(i.source,_a(ft.exec(i))+"g")),i.lastIndex=0;c=i.exec(h);)var f=c.index;l=l.slice(0,f===o?u:f)}}else if(t.indexOf(ao(i),u)!=u){var d=l.lastIndexOf(i);d>-1&&(l=l.slice(0,d))}return l+r},Bn.unescape=function(t){return(t=_a(t))&&K.test(t)?t.replace(Y,un):t},Bn.uniqueId=function(t){var e=++Et;return _a(t)+e},Bn.upperCase=qa,Bn.upperFirst=$a,Bn.each=_s,Bn.eachRight=xs,Bn.first=Ki,uu(Bn,(vu={},_r(Bn,(function(t,e){Mt.call(Bn.prototype,e)||(vu[e]=t)})),vu),{chain:!1}),Bn.VERSION="4.17.21",_e(["bind","bindKey","curry","curryRight","partial","partialRight"],(function(t){Bn[t].placeholder=Bn})),_e(["drop","take"],(function(t,e){Wn.prototype[t]=function(n){n=n===o?1:yn(ga(n),0);var r=this.__filtered__&&!e?new Wn(this):this.clone();return r.__filtered__?r.__takeCount__=vn(n,r.__takeCount__):r.__views__.push({size:vn(n,d),type:t+(r.__dir__<0?"Right":"")}),r},Wn.prototype[t+"Right"]=function(e){return this.reverse()[t](e).reverse()}})),_e(["filter","map","takeWhile"],(function(t,e){var n=e+1,r=1==n||3==n;Wn.prototype[t]=function(t){var e=this.clone();return e.__iteratees__.push({iteratee:ai(t,3),type:n}),e.__filtered__=e.__filtered__||r,e}})),_e(["head","last"],(function(t,e){var n="take"+(e?"Right":"");Wn.prototype[t]=function(){return this[n](1).value()[0]}})),_e(["initial","tail"],(function(t,e){var n="drop"+(e?"":"Right");Wn.prototype[t]=function(){return this.__filtered__?new Wn(this):this[n](1)}})),Wn.prototype.compact=function(){return this.filter(ou)},Wn.prototype.find=function(t){return this.filter(t).head()},Wn.prototype.findLast=function(t){return this.reverse().find(t)},Wn.prototype.invokeMap=Xr((function(t,e){return"function"==typeof t?new Wn(this):this.map((function(n){return Rr(n,t,e)}))})),Wn.prototype.reject=function(t){return this.filter(js(ai(t)))},Wn.prototype.slice=function(t,e){t=ga(t);var n=this;return n.__filtered__&&(t>0||e<0)?new Wn(n):(t<0?n=n.takeRight(-t):t&&(n=n.drop(t)),e!==o&&(n=(e=ga(e))<0?n.dropRight(-e):n.take(e-t)),n)},Wn.prototype.takeRightWhile=function(t){return this.reverse().takeWhile(t).reverse()},Wn.prototype.toArray=function(){return this.take(d)},_r(Wn.prototype,(function(t,e){var n=/^(?:filter|find|map|reject)|While$/.test(e),r=/^(?:head|last)$/.test(e),i=Bn[r?"take"+("last"==e?"Right":""):e],s=r||/^find/.test(e);i&&(Bn.prototype[e]=function(){var e=this.__wrapped__,a=r?[1]:arguments,u=e instanceof Wn,l=a[0],c=u||Ys(e),h=function(t){var e=i.apply(Bn,De([t],a));return r&&f?e[0]:e};c&&n&&"function"==typeof l&&1!=l.length&&(u=c=!1);var f=this.__chain__,d=!!this.__actions__.length,p=s&&!f,g=u&&!d;if(!s&&c){e=g?e:new Wn(this);var m=t.apply(e,a);return m.__actions__.push({func:ps,args:[h],thisArg:o}),new Gn(m,f)}return p&&g?t.apply(this,a):(m=this.thru(h),p?r?m.value()[0]:m.value():m)})})),_e(["pop","push","shift","sort","splice","unshift"],(function(t){var e=Lt[t],n=/^(?:push|sort|unshift)$/.test(t)?"tap":"thru",r=/^(?:pop|shift)$/.test(t);Bn.prototype[t]=function(){var t=arguments;if(r&&!this.__chain__){var o=this.value();return e.apply(Ys(o)?o:[],t)}return this[n]((function(n){return e.apply(Ys(n)?n:[],t)}))}})),_r(Wn.prototype,(function(t,e){var n=Bn[e];if(n){var r=n.name+"";Mt.call(Tn,r)||(Tn[r]=[]),Tn[r].push({name:e,func:n})}})),Tn[Bo(o,2).name]=[{name:"wrapper",func:o}],Wn.prototype.clone=function(){var t=new Wn(this.__wrapped__);return t.__actions__=Lo(this.__actions__),t.__dir__=this.__dir__,t.__filtered__=this.__filtered__,t.__iteratees__=Lo(this.__iteratees__),t.__takeCount__=this.__takeCount__,t.__views__=Lo(this.__views__),t},Wn.prototype.reverse=function(){if(this.__filtered__){var t=new Wn(this);t.__dir__=-1,t.__filtered__=!0}else(t=this.clone()).__dir__*=-1;return t},Wn.prototype.value=function(){var t=this.__wrapped__.value(),e=this.__dir__,n=Ys(t),r=e<0,o=n?t.length:0,i=function(t,e,n){for(var r=-1,o=n.length;++r<o;){var i=n[r],s=i.size;switch(i.type){case"drop":t+=s;break;case"dropRight":e-=s;break;case"take":e=vn(e,t+s);break;case"takeRight":t=yn(t,e-s)}}return{start:t,end:e}}(0,o,this.__views__),s=i.start,a=i.end,u=a-s,l=r?a:s-1,c=this.__iteratees__,h=c.length,f=0,d=vn(u,this.__takeCount__);if(!n||!r&&o==u&&d==u)return fo(t,this.__actions__);var p=[];t:for(;u--&&f<d;){for(var g=-1,m=t[l+=e];++g<h;){var y=c[g],v=y.iteratee,_=y.type,x=v(m);if(2==_)m=x;else if(!x){if(1==_)continue t;break t}}p[f++]=m}return p},Bn.prototype.at=gs,Bn.prototype.chain=function(){return ds(this)},Bn.prototype.commit=function(){return new Gn(this.value(),this.__chain__)},Bn.prototype.next=function(){this.__values__===o&&(this.__values__=da(this.value()));var t=this.__index__>=this.__values__.length;return{done:t,value:t?o:this.__values__[this.__index__++]}},Bn.prototype.plant=function(t){for(var e,n=this;n instanceof Un;){var r=Ni(n);r.__index__=0,r.__values__=o,e?i.__wrapped__=r:e=r;var i=r;n=n.__wrapped__}return i.__wrapped__=t,e},Bn.prototype.reverse=function(){var t=this.__wrapped__;if(t instanceof Wn){var e=t;return this.__actions__.length&&(e=new Wn(this)),(e=e.reverse()).__actions__.push({func:ps,args:[es],thisArg:o}),new Gn(e,this.__chain__)}return this.thru(es)},Bn.prototype.toJSON=Bn.prototype.valueOf=Bn.prototype.value=function(){return fo(this.__wrapped__,this.__actions__)},Bn.prototype.first=Bn.prototype.head,se&&(Bn.prototype[se]=function(){return this}),Bn}();ie._=ln,(r=function(){return ln}.call(e,n,e,t))===o||(t.exports=r)}.call(this)},607:(t,e,n)=>{"use strict";var r=n(766);const o={src:["res/se/tetrax/tetrax.ogg","res/se/tetrax/tetrax.m4a","res/se/tetrax/tetrax.mp3","res/se/tetrax/tetrax.ac3"],sprite:{alarm:[0,1017.8684807256235],b2bContinue:[3e3,2218.7528344671196],bufferedHold:[7e3,1453.2653061224482],bufferedRotate:[1e4,890.8390022675743],bufferedSkip:[12e3,1918.9795918367345],collapse:[15e3,1698.2312925170077],combo01:[18e3,2477.68707482993],combo02:[22e3,2477.68707482993],combo03:[26e3,2477.68707482993],combo04:[3e4,2477.68707482993],combo05:[34e3,2477.68707482993],combo06:[38e3,2477.68707482993],combo07:[42e3,2477.68707482993],combo08:[46e3,2473.2199546485276],combo09:[5e4,2473.2199546485276],combo10:[54e3,1928.5714285714307],combo11:[57e3,1901.7913832199583],combo12:[6e4,1879.455782312924],combo13:[63e3,1861.6099773242638],combo14:[66e3,3315.8730158730095],combo15:[71e3,3417.1428571428632],combo16:[76e3,3564.557823129249],combo17:[81e3,3495.1020408163204],combo18:[86e3,3490.8163265306057],combo19:[91e3,3489.841269841264],deathWarning:[96e3,810.8163265306132],erase1:[98e3,1454.6258503401361],erase2:[101e3,1586.1904761904811],erase3:[104e3,1688.0498866213145],erase4:[107e3,1718.752834467125],gameDeath:[11e4,3156.780045351468],gameGo:[115e3,3210.408163265299],gameOver:[12e4,1973.2199546485276],gameReady:[123e3,3092.4716553287935],gameStart:[128e3,3101.882086167791],gameVictory:[133e3,3251.7460317460236],garbageFlyHit:[138e3,1946.4399092970552],garbageFlyReceive:[141e3,1939.31972789116],garbageFlySend:[144e3,3301.315192743772],garbageSpawn:[149e3,2287.188208616783],levelUp:[153e3,2070.3628117913695],lockWithoutHardDrop:[157e3,847.8684807256229],outOfResets:[159e3,3247.98185941043],pause:[164e3,3253.9455782312816],perfectClear:[169e3,3338.730158730158],pieceHardDrop:[174e3,970.226757369602],pieceHold:[176e3,853.6961451247294],pieceLand:[178e3,1092.5623582766377],pieceMove:[181e3,992.3356009070403],pieceRotate:[183e3,1124.8526077097551],pieceRotateT:[186e3,1667.1882086167784],pieceRotateTMini:[189e3,2221.904761904767],pieceSkip:[193e3,1108.5260770975083],pieceSlide:[196e3,370.29478458049425],pieceWallkick:[198e3,1340.5668934240396],tSpin0:[201e3,2197.9138321995606],tSpin1:[205e3,2197.9138321995606],tSpin2:[209e3,2322.9251700680325],tSpin3:[213e3,2505.215419501127],tSpinMini0:[217e3,2197.9138321995606],tSpinMini1:[221e3,2197.9138321995606],tSpinMini2:[225e3,2322.9251700680325]}},i={src:["res/se/system/system.ogg","res/se/system/system.m4a","res/se/system/system.mp3","res/se/system/system.ac3"],sprite:{back:[0,1961.0430839002267],change:[3e3,1435.9863945578227],error:[6e3,1714.2857142857144],move:[9e3,1366.5759637188212],optionSelect:[12e3,2053.990929705215],select:[16e3,1828.9569160997737]}};class s{static loadSounds(t){null==t.instance&&(t.instance=new r.Howl(t.data.howlOptions),s.updateVolume())}static add(t,e=s.currentSoundbank){s.soundQueue[t]=e}static playQueue(){for(const t of Object.keys(s.soundQueue)){const e=s.soundQueue[t];null!=(null==e?void 0:e.data.eventAssignments[t])?(e.instance.play(e.data.eventAssignments[t]),delete s.soundQueue[t]):delete s.soundQueue[t]}}static updateVolume(){for(const t of Object.keys(s.soundbanks)){const e=s.soundbanks[t];null!=e.instance&&e.instance.volume(.25)}}static setSoundbank(t){s.loadSounds(t),s.currentSoundbank=t}}function a(t){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function u(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function l(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?Object(arguments[e]):{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(t){return Object.getOwnPropertyDescriptor(n,t).enumerable})))),r.forEach((function(e){u(t,e,n[e])}))}return t}function c(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function h(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function f(t,e,n){return e&&h(t.prototype,e),n&&h(t,n),t}function d(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function p(t,e){return!e||"object"!==a(e)&&"function"!=typeof e?d(t):e}function g(t){return(g=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function m(t,e){return(m=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function y(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&m(t,e)}s.soundQueue={},s.soundbanks={tetrax:{data:new class{constructor(){this.howlOptions=o,this.eventAssignments={pieceMove:"pieceMove",pieceRotate:"pieceRotate",pieceRotateT:"pieceRotateT",pieceRotateTMini:"pieceRotateTMini",pieceWallkick:"pieceWallkick",pieceHold:"pieceHold",pieceSlide:"pieceSlide",pieceLand:"pieceLand",outOfResets:"outOfResets",bufferedHold:"bufferedHold",bufferedRotate:"bufferedRotate",bufferedSkip:"bufferedSkip",pieceHardDrop:"pieceHardDrop",lockWithoutHardDrop:"lockWithoutHardDrop",collapse:"collapse",erase1:"erase1",erase2:"erase2",erase3:"erase3",erase4:"erase4",tSpin0:"tSpin0",tSpin1:"tSpin1",tSpin2:"tSpin2",tSpin3:"tSpin3",tSpinMini0:"tSpinMini0",tSpinMini1:"tSpinMini1",tSpinMini2:"tSpinMini2",erase4b2b:"erase4",tSpin1b2b:"tSpin1",tSpin2b2b:"tSpin2",tSpin3b2b:"tSpin3",tSpinMini1b2b:"tSpinMini1",tSpinMini2b2b:"tSpinMini2",b2bContinue:"b2bContinue",perfectClear:"perfectClear",levelUp:"levelUp",pause:"pause",unpause:"pause",ready:"gameReady",start:"gameStart",gameDeath:"gameDeath",gameVictory:"gameVictory",gameOver:"gameOver",combo1:"combo01",combo2:"combo02",combo3:"combo03",combo4:"combo04",combo5:"combo05",combo6:"combo06",combo7:"combo07",combo8:"combo08",combo9:"combo09",combo10:"combo10",combo11:"combo11",combo12:"combo12",combo13:"combo13",combo14:"combo14",combo15:"combo16",combo16:"combo17",combo17:"combo18",combo18:"combo19",combo19:"combo20",combo20:"combo20"}}},instance:null},system:{data:new class{constructor(){this.howlOptions=i,this.eventAssignments={menuBack:"back",menuChange:"change",menuChoose:"optionSelect",menuConfirm:"select",menuSelect:"move"}}},instance:null}};var v={type:"logger",log:function(t){this.output("log",t)},warn:function(t){this.output("warn",t)},error:function(t){this.output("error",t)},output:function(t,e){console&&console[t]&&console[t].apply(console,e)}},_=new(function(){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};c(this,t),this.init(e,n)}return f(t,[{key:"init",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.prefix=e.prefix||"i18next:",this.logger=t||v,this.options=e,this.debug=e.debug}},{key:"setDebug",value:function(t){this.debug=t}},{key:"log",value:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return this.forward(e,"log","",!0)}},{key:"warn",value:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return this.forward(e,"warn","",!0)}},{key:"error",value:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return this.forward(e,"error","")}},{key:"deprecate",value:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return this.forward(e,"warn","WARNING DEPRECATED: ",!0)}},{key:"forward",value:function(t,e,n,r){return r&&!this.debug?null:("string"==typeof t[0]&&(t[0]="".concat(n).concat(this.prefix," ").concat(t[0])),this.logger[e](t))}},{key:"create",value:function(e){return new t(this.logger,l({},{prefix:"".concat(this.prefix,":").concat(e,":")},this.options))}}]),t}()),x=function(){function t(){c(this,t),this.observers={}}return f(t,[{key:"on",value:function(t,e){var n=this;return t.split(" ").forEach((function(t){n.observers[t]=n.observers[t]||[],n.observers[t].push(e)})),this}},{key:"off",value:function(t,e){this.observers[t]&&(e?this.observers[t]=this.observers[t].filter((function(t){return t!==e})):delete this.observers[t])}},{key:"emit",value:function(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];if(this.observers[t]){var o=[].concat(this.observers[t]);o.forEach((function(t){t.apply(void 0,n)}))}if(this.observers["*"]){var i=[].concat(this.observers["*"]);i.forEach((function(e){e.apply(e,[t].concat(n))}))}}}]),t}();function b(){var t,e,n=new Promise((function(n,r){t=n,e=r}));return n.resolve=t,n.reject=e,n}function w(t){return null==t?"":""+t}function k(t,e,n){t.forEach((function(t){e[t]&&(n[t]=e[t])}))}function S(t,e,n){function r(t){return t&&t.indexOf("###")>-1?t.replace(/###/g,"."):t}function o(){return!t||"string"==typeof t}for(var i="string"!=typeof e?[].concat(e):e.split(".");i.length>1;){if(o())return{};var s=r(i.shift());!t[s]&&n&&(t[s]=new n),t=Object.prototype.hasOwnProperty.call(t,s)?t[s]:{}}return o()?{}:{obj:t,k:r(i.shift())}}function A(t,e,n){var r=S(t,e,Object);r.obj[r.k]=n}function D(t,e){var n=S(t,e),r=n.obj,o=n.k;if(r)return r[o]}function C(t,e,n){var r=D(t,n);return void 0!==r?r:D(e,n)}function L(t,e,n){for(var r in e)"__proto__"!==r&&"constructor"!==r&&(r in t?"string"==typeof t[r]||t[r]instanceof String||"string"==typeof e[r]||e[r]instanceof String?n&&(t[r]=e[r]):L(t[r],e[r],n):t[r]=e[r]);return t}function R(t){return t.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&")}var T={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;"};function O(t){return"string"==typeof t?t.replace(/[&<>"'\/]/g,(function(t){return T[t]})):t}var P="undefined"!=typeof window&&window.navigator&&window.navigator.userAgent&&window.navigator.userAgent.indexOf("MSIE")>-1,M=function(t){function e(t){var n,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{ns:["translation"],defaultNS:"translation"};return c(this,e),n=p(this,g(e).call(this)),P&&x.call(d(n)),n.data=t||{},n.options=r,void 0===n.options.keySeparator&&(n.options.keySeparator="."),n}return y(e,t),f(e,[{key:"addNamespaces",value:function(t){this.options.ns.indexOf(t)<0&&this.options.ns.push(t)}},{key:"removeNamespaces",value:function(t){var e=this.options.ns.indexOf(t);e>-1&&this.options.ns.splice(e,1)}},{key:"getResource",value:function(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},o=void 0!==r.keySeparator?r.keySeparator:this.options.keySeparator,i=[t,e];return n&&"string"!=typeof n&&(i=i.concat(n)),n&&"string"==typeof n&&(i=i.concat(o?n.split(o):n)),t.indexOf(".")>-1&&(i=t.split(".")),D(this.data,i)}},{key:"addResource",value:function(t,e,n,r){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{silent:!1},i=this.options.keySeparator;void 0===i&&(i=".");var s=[t,e];n&&(s=s.concat(i?n.split(i):n)),t.indexOf(".")>-1&&(r=e,e=(s=t.split("."))[1]),this.addNamespaces(e),A(this.data,s,r),o.silent||this.emit("added",t,e,n,r)}},{key:"addResources",value:function(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{silent:!1};for(var o in n)"string"!=typeof n[o]&&"[object Array]"!==Object.prototype.toString.apply(n[o])||this.addResource(t,e,o,n[o],{silent:!0});r.silent||this.emit("added",t,e,n)}},{key:"addResourceBundle",value:function(t,e,n,r,o){var i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{silent:!1},s=[t,e];t.indexOf(".")>-1&&(r=n,n=e,e=(s=t.split("."))[1]),this.addNamespaces(e);var a=D(this.data,s)||{};r?L(a,n,o):a=l({},a,n),A(this.data,s,a),i.silent||this.emit("added",t,e,n)}},{key:"removeResourceBundle",value:function(t,e){this.hasResourceBundle(t,e)&&delete this.data[t][e],this.removeNamespaces(e),this.emit("removed",t,e)}},{key:"hasResourceBundle",value:function(t,e){return void 0!==this.getResource(t,e)}},{key:"getResourceBundle",value:function(t,e){return e||(e=this.options.defaultNS),"v1"===this.options.compatibilityAPI?l({},{},this.getResource(t,e)):this.getResource(t,e)}},{key:"getDataByLanguage",value:function(t){return this.data[t]}},{key:"toJSON",value:function(){return this.data}}]),e}(x),E={processors:{},addPostProcessor:function(t){this.processors[t.name]=t},handle:function(t,e,n,r,o){var i=this;return t.forEach((function(t){i.processors[t]&&(e=i.processors[t].process(e,n,r,o))})),e}},I={},j=function(t){function e(t){var n,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return c(this,e),n=p(this,g(e).call(this)),P&&x.call(d(n)),k(["resourceStore","languageUtils","pluralResolver","interpolator","backendConnector","i18nFormat","utils"],t,d(n)),n.options=r,void 0===n.options.keySeparator&&(n.options.keySeparator="."),n.logger=_.create("translator"),n}return y(e,t),f(e,[{key:"changeLanguage",value:function(t){t&&(this.language=t)}},{key:"exists",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{interpolation:{}},n=this.resolve(t,e);return n&&void 0!==n.res}},{key:"extractFromKey",value:function(t,e){var n=void 0!==e.nsSeparator?e.nsSeparator:this.options.nsSeparator;void 0===n&&(n=":");var r=void 0!==e.keySeparator?e.keySeparator:this.options.keySeparator,o=e.ns||this.options.defaultNS;if(n&&t.indexOf(n)>-1){var i=t.match(this.interpolator.nestingRegexp);if(i&&i.length>0)return{key:t,namespaces:o};var s=t.split(n);(n!==r||n===r&&this.options.ns.indexOf(s[0])>-1)&&(o=s.shift()),t=s.join(r)}return"string"==typeof o&&(o=[o]),{key:t,namespaces:o}}},{key:"translate",value:function(t,n,r){var o=this;if("object"!==a(n)&&this.options.overloadTranslationOptionHandler&&(n=this.options.overloadTranslationOptionHandler(arguments)),n||(n={}),null==t)return"";Array.isArray(t)||(t=[String(t)]);var i=void 0!==n.keySeparator?n.keySeparator:this.options.keySeparator,s=this.extractFromKey(t[t.length-1],n),u=s.key,c=s.namespaces,h=c[c.length-1],f=n.lng||this.language,d=n.appendNamespaceToCIMode||this.options.appendNamespaceToCIMode;if(f&&"cimode"===f.toLowerCase()){if(d){var p=n.nsSeparator||this.options.nsSeparator;return h+p+u}return u}var g=this.resolve(t,n),m=g&&g.res,y=g&&g.usedKey||u,v=g&&g.exactUsedKey||u,_=Object.prototype.toString.apply(m),x=["[object Number]","[object Function]","[object RegExp]"],b=void 0!==n.joinArrays?n.joinArrays:this.options.joinArrays,w=!this.i18nFormat||this.i18nFormat.handleAsObject,k="string"!=typeof m&&"boolean"!=typeof m&&"number"!=typeof m;if(w&&m&&k&&x.indexOf(_)<0&&("string"!=typeof b||"[object Array]"!==_)){if(!n.returnObjects&&!this.options.returnObjects)return this.logger.warn("accessing an object - but returnObjects options is not enabled!"),this.options.returnedObjectHandler?this.options.returnedObjectHandler(y,m,n):"key '".concat(u," (").concat(this.language,")' returned an object instead of string.");if(i){var S="[object Array]"===_,A=S?[]:{},D=S?v:y;for(var C in m)if(Object.prototype.hasOwnProperty.call(m,C)){var L="".concat(D).concat(i).concat(C);A[C]=this.translate(L,l({},n,{joinArrays:!1,ns:c})),A[C]===L&&(A[C]=m[C])}m=A}}else if(w&&"string"==typeof b&&"[object Array]"===_)(m=m.join(b))&&(m=this.extendTranslation(m,t,n,r));else{var R=!1,T=!1,O=void 0!==n.count&&"string"!=typeof n.count,P=e.hasDefaultValue(n),M=O?this.pluralResolver.getSuffix(f,n.count):"",E=n["defaultValue".concat(M)]||n.defaultValue;!this.isValidLookup(m)&&P&&(R=!0,m=E),this.isValidLookup(m)||(T=!0,m=u);var I=P&&E!==m&&this.options.updateMissing;if(T||R||I){if(this.logger.log(I?"updateKey":"missingKey",f,h,u,I?E:m),i){var j=this.resolve(u,l({},n,{keySeparator:!1}));j&&j.res&&this.logger.warn("Seems the loaded translations were in flat JSON format instead of nested. Either set keySeparator: false on init or make sure your translations are published in nested format.")}var F=[],H=this.languageUtils.getFallbackCodes(this.options.fallbackLng,n.lng||this.language);if("fallback"===this.options.saveMissingTo&&H&&H[0])for(var B=0;B<H.length;B++)F.push(H[B]);else"all"===this.options.saveMissingTo?F=this.languageUtils.toResolveHierarchy(n.lng||this.language):F.push(n.lng||this.language);var N=function(t,e,r){o.options.missingKeyHandler?o.options.missingKeyHandler(t,h,e,I?r:m,I,n):o.backendConnector&&o.backendConnector.saveMissing&&o.backendConnector.saveMissing(t,h,e,I?r:m,I,n),o.emit("missingKey",t,h,e,m)};this.options.saveMissing&&(this.options.saveMissingPlurals&&O?F.forEach((function(t){o.pluralResolver.getSuffixes(t).forEach((function(e){N([t],u+e,n["defaultValue".concat(e)]||E)}))})):N(F,u,E))}m=this.extendTranslation(m,t,n,g,r),T&&m===u&&this.options.appendNamespaceToMissingKey&&(m="".concat(h,":").concat(u)),T&&this.options.parseMissingKeyHandler&&(m=this.options.parseMissingKeyHandler(m))}return m}},{key:"extendTranslation",value:function(t,e,n,r,o){var i=this;if(this.i18nFormat&&this.i18nFormat.parse)t=this.i18nFormat.parse(t,n,r.usedLng,r.usedNS,r.usedKey,{resolved:r});else if(!n.skipInterpolation){n.interpolation&&this.interpolator.init(l({},n,{interpolation:l({},this.options.interpolation,n.interpolation)}));var s,a=n.interpolation&&n.interpolation.skipOnVariables||this.options.interpolation.skipOnVariables;if(a){var u=t.match(this.interpolator.nestingRegexp);s=u&&u.length}var c=n.replace&&"string"!=typeof n.replace?n.replace:n;if(this.options.interpolation.defaultVariables&&(c=l({},this.options.interpolation.defaultVariables,c)),t=this.interpolator.interpolate(t,c,n.lng||this.language,n),a){var h=t.match(this.interpolator.nestingRegexp);s<(h&&h.length)&&(n.nest=!1)}!1!==n.nest&&(t=this.interpolator.nest(t,(function(){for(var t=arguments.length,r=new Array(t),s=0;s<t;s++)r[s]=arguments[s];return o&&o[0]===r[0]&&!n.context?(i.logger.warn("It seems you are nesting recursively key: ".concat(r[0]," in key: ").concat(e[0])),null):i.translate.apply(i,r.concat([e]))}),n)),n.interpolation&&this.interpolator.reset()}var f=n.postProcess||this.options.postProcess,d="string"==typeof f?[f]:f;return null!=t&&d&&d.length&&!1!==n.applyPostProcessor&&(t=E.handle(d,t,e,this.options&&this.options.postProcessPassResolved?l({i18nResolved:r},n):n,this)),t}},{key:"resolve",value:function(t){var e,n,r,o,i,s=this,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return"string"==typeof t&&(t=[t]),t.forEach((function(t){if(!s.isValidLookup(e)){var u=s.extractFromKey(t,a),l=u.key;n=l;var c=u.namespaces;s.options.fallbackNS&&(c=c.concat(s.options.fallbackNS));var h=void 0!==a.count&&"string"!=typeof a.count,f=void 0!==a.context&&"string"==typeof a.context&&""!==a.context,d=a.lngs?a.lngs:s.languageUtils.toResolveHierarchy(a.lng||s.language,a.fallbackLng);c.forEach((function(t){s.isValidLookup(e)||(i=t,!I["".concat(d[0],"-").concat(t)]&&s.utils&&s.utils.hasLoadedNamespace&&!s.utils.hasLoadedNamespace(i)&&(I["".concat(d[0],"-").concat(t)]=!0,s.logger.warn('key "'.concat(n,'" for languages "').concat(d.join(", "),'" won\'t get resolved as namespace "').concat(i,'" was not yet loaded'),"This means something IS WRONG in your setup. You access the t function before i18next.init / i18next.loadNamespace / i18next.changeLanguage was done. Wait for the callback or Promise to resolve before accessing it!!!")),d.forEach((function(n){if(!s.isValidLookup(e)){o=n;var i,u,c=l,d=[c];for(s.i18nFormat&&s.i18nFormat.addLookupKeys?s.i18nFormat.addLookupKeys(d,l,n,t,a):(h&&(i=s.pluralResolver.getSuffix(n,a.count)),h&&f&&d.push(c+i),f&&d.push(c+="".concat(s.options.contextSeparator).concat(a.context)),h&&d.push(c+=i));u=d.pop();)s.isValidLookup(e)||(r=u,e=s.getResource(n,t,u,a))}})))}))}})),{res:e,usedKey:n,exactUsedKey:r,usedLng:o,usedNS:i}}},{key:"isValidLookup",value:function(t){return!(void 0===t||!this.options.returnNull&&null===t||!this.options.returnEmptyString&&""===t)}},{key:"getResource",value:function(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return this.i18nFormat&&this.i18nFormat.getResource?this.i18nFormat.getResource(t,e,n,r):this.resourceStore.getResource(t,e,n,r)}}],[{key:"hasDefaultValue",value:function(t){var e="defaultValue";for(var n in t)if(Object.prototype.hasOwnProperty.call(t,n)&&e===n.substring(0,e.length)&&void 0!==t[n])return!0;return!1}}]),e}(x);function F(t){return t.charAt(0).toUpperCase()+t.slice(1)}var H=function(){function t(e){c(this,t),this.options=e,this.whitelist=this.options.supportedLngs||!1,this.supportedLngs=this.options.supportedLngs||!1,this.logger=_.create("languageUtils")}return f(t,[{key:"getScriptPartFromCode",value:function(t){if(!t||t.indexOf("-")<0)return null;var e=t.split("-");return 2===e.length?null:(e.pop(),"x"===e[e.length-1].toLowerCase()?null:this.formatLanguageCode(e.join("-")))}},{key:"getLanguagePartFromCode",value:function(t){if(!t||t.indexOf("-")<0)return t;var e=t.split("-");return this.formatLanguageCode(e[0])}},{key:"formatLanguageCode",value:function(t){if("string"==typeof t&&t.indexOf("-")>-1){var e=["hans","hant","latn","cyrl","cans","mong","arab"],n=t.split("-");return this.options.lowerCaseLng?n=n.map((function(t){return t.toLowerCase()})):2===n.length?(n[0]=n[0].toLowerCase(),n[1]=n[1].toUpperCase(),e.indexOf(n[1].toLowerCase())>-1&&(n[1]=F(n[1].toLowerCase()))):3===n.length&&(n[0]=n[0].toLowerCase(),2===n[1].length&&(n[1]=n[1].toUpperCase()),"sgn"!==n[0]&&2===n[2].length&&(n[2]=n[2].toUpperCase()),e.indexOf(n[1].toLowerCase())>-1&&(n[1]=F(n[1].toLowerCase())),e.indexOf(n[2].toLowerCase())>-1&&(n[2]=F(n[2].toLowerCase()))),n.join("-")}return this.options.cleanCode||this.options.lowerCaseLng?t.toLowerCase():t}},{key:"isWhitelisted",value:function(t){return this.logger.deprecate("languageUtils.isWhitelisted",'function "isWhitelisted" will be renamed to "isSupportedCode" in the next major - please make sure to rename it\'s usage asap.'),this.isSupportedCode(t)}},{key:"isSupportedCode",value:function(t){return("languageOnly"===this.options.load||this.options.nonExplicitSupportedLngs)&&(t=this.getLanguagePartFromCode(t)),!this.supportedLngs||!this.supportedLngs.length||this.supportedLngs.indexOf(t)>-1}},{key:"getBestMatchFromCodes",value:function(t){var e,n=this;return t?(t.forEach((function(t){if(!e){var r=n.formatLanguageCode(t);n.options.supportedLngs&&!n.isSupportedCode(r)||(e=r)}})),!e&&this.options.supportedLngs&&t.forEach((function(t){if(!e){var r=n.getLanguagePartFromCode(t);if(n.isSupportedCode(r))return e=r;e=n.options.supportedLngs.find((function(t){if(0===t.indexOf(r))return t}))}})),e||(e=this.getFallbackCodes(this.options.fallbackLng)[0]),e):null}},{key:"getFallbackCodes",value:function(t,e){if(!t)return[];if("function"==typeof t&&(t=t(e)),"string"==typeof t&&(t=[t]),"[object Array]"===Object.prototype.toString.apply(t))return t;if(!e)return t.default||[];var n=t[e];return n||(n=t[this.getScriptPartFromCode(e)]),n||(n=t[this.formatLanguageCode(e)]),n||(n=t[this.getLanguagePartFromCode(e)]),n||(n=t.default),n||[]}},{key:"toResolveHierarchy",value:function(t,e){var n=this,r=this.getFallbackCodes(e||this.options.fallbackLng||[],t),o=[],i=function(t){t&&(n.isSupportedCode(t)?o.push(t):n.logger.warn("rejecting language code not found in supportedLngs: ".concat(t)))};return"string"==typeof t&&t.indexOf("-")>-1?("languageOnly"!==this.options.load&&i(this.formatLanguageCode(t)),"languageOnly"!==this.options.load&&"currentOnly"!==this.options.load&&i(this.getScriptPartFromCode(t)),"currentOnly"!==this.options.load&&i(this.getLanguagePartFromCode(t))):"string"==typeof t&&i(this.formatLanguageCode(t)),r.forEach((function(t){o.indexOf(t)<0&&i(n.formatLanguageCode(t))})),o}}]),t}(),B=[{lngs:["ach","ak","am","arn","br","fil","gun","ln","mfe","mg","mi","oc","pt","pt-BR","tg","tl","ti","tr","uz","wa"],nr:[1,2],fc:1},{lngs:["af","an","ast","az","bg","bn","ca","da","de","dev","el","en","eo","es","et","eu","fi","fo","fur","fy","gl","gu","ha","hi","hu","hy","ia","it","kn","ku","lb","mai","ml","mn","mr","nah","nap","nb","ne","nl","nn","no","nso","pa","pap","pms","ps","pt-PT","rm","sco","se","si","so","son","sq","sv","sw","ta","te","tk","ur","yo"],nr:[1,2],fc:2},{lngs:["ay","bo","cgg","fa","ht","id","ja","jbo","ka","kk","km","ko","ky","lo","ms","sah","su","th","tt","ug","vi","wo","zh"],nr:[1],fc:3},{lngs:["be","bs","cnr","dz","hr","ru","sr","uk"],nr:[1,2,5],fc:4},{lngs:["ar"],nr:[0,1,2,3,11,100],fc:5},{lngs:["cs","sk"],nr:[1,2,5],fc:6},{lngs:["csb","pl"],nr:[1,2,5],fc:7},{lngs:["cy"],nr:[1,2,3,8],fc:8},{lngs:["fr"],nr:[1,2],fc:9},{lngs:["ga"],nr:[1,2,3,7,11],fc:10},{lngs:["gd"],nr:[1,2,3,20],fc:11},{lngs:["is"],nr:[1,2],fc:12},{lngs:["jv"],nr:[0,1],fc:13},{lngs:["kw"],nr:[1,2,3,4],fc:14},{lngs:["lt"],nr:[1,2,10],fc:15},{lngs:["lv"],nr:[1,2,0],fc:16},{lngs:["mk"],nr:[1,2],fc:17},{lngs:["mnk"],nr:[0,1,2],fc:18},{lngs:["mt"],nr:[1,2,11,20],fc:19},{lngs:["or"],nr:[2,1],fc:2},{lngs:["ro"],nr:[1,2,20],fc:20},{lngs:["sl"],nr:[5,1,2,3],fc:21},{lngs:["he","iw"],nr:[1,2,20,21],fc:22}],N={1:function(t){return Number(t>1)},2:function(t){return Number(1!=t)},3:function(t){return 0},4:function(t){return Number(t%10==1&&t%100!=11?0:t%10>=2&&t%10<=4&&(t%100<10||t%100>=20)?1:2)},5:function(t){return Number(0==t?0:1==t?1:2==t?2:t%100>=3&&t%100<=10?3:t%100>=11?4:5)},6:function(t){return Number(1==t?0:t>=2&&t<=4?1:2)},7:function(t){return Number(1==t?0:t%10>=2&&t%10<=4&&(t%100<10||t%100>=20)?1:2)},8:function(t){return Number(1==t?0:2==t?1:8!=t&&11!=t?2:3)},9:function(t){return Number(t>=2)},10:function(t){return Number(1==t?0:2==t?1:t<7?2:t<11?3:4)},11:function(t){return Number(1==t||11==t?0:2==t||12==t?1:t>2&&t<20?2:3)},12:function(t){return Number(t%10!=1||t%100==11)},13:function(t){return Number(0!==t)},14:function(t){return Number(1==t?0:2==t?1:3==t?2:3)},15:function(t){return Number(t%10==1&&t%100!=11?0:t%10>=2&&(t%100<10||t%100>=20)?1:2)},16:function(t){return Number(t%10==1&&t%100!=11?0:0!==t?1:2)},17:function(t){return Number(1==t||t%10==1&&t%100!=11?0:1)},18:function(t){return Number(0==t?0:1==t?1:2)},19:function(t){return Number(1==t?0:0==t||t%100>1&&t%100<11?1:t%100>10&&t%100<20?2:3)},20:function(t){return Number(1==t?0:0==t||t%100>0&&t%100<20?1:2)},21:function(t){return Number(t%100==1?1:t%100==2?2:t%100==3||t%100==4?3:0)},22:function(t){return Number(1==t?0:2==t?1:(t<0||t>10)&&t%10==0?2:3)}};function U(){var t={};return B.forEach((function(e){e.lngs.forEach((function(n){t[n]={numbers:e.nr,plurals:N[e.fc]}}))})),t}var G=function(){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};c(this,t),this.languageUtils=e,this.options=n,this.logger=_.create("pluralResolver"),this.rules=U()}return f(t,[{key:"addRule",value:function(t,e){this.rules[t]=e}},{key:"getRule",value:function(t){return this.rules[t]||this.rules[this.languageUtils.getLanguagePartFromCode(t)]}},{key:"needsPlural",value:function(t){var e=this.getRule(t);return e&&e.numbers.length>1}},{key:"getPluralFormsOfKey",value:function(t,e){return this.getSuffixes(t).map((function(t){return e+t}))}},{key:"getSuffixes",value:function(t){var e=this,n=this.getRule(t);return n?n.numbers.map((function(n){return e.getSuffix(t,n)})):[]}},{key:"getSuffix",value:function(t,e){var n=this,r=this.getRule(t);if(r){var o=r.noAbs?r.plurals(e):r.plurals(Math.abs(e)),i=r.numbers[o];this.options.simplifyPluralSuffix&&2===r.numbers.length&&1===r.numbers[0]&&(2===i?i="plural":1===i&&(i=""));var s=function(){return n.options.prepend&&i.toString()?n.options.prepend+i.toString():i.toString()};return"v1"===this.options.compatibilityJSON?1===i?"":"number"==typeof i?"_plural_".concat(i.toString()):s():"v2"===this.options.compatibilityJSON||this.options.simplifyPluralSuffix&&2===r.numbers.length&&1===r.numbers[0]?s():this.options.prepend&&o.toString()?this.options.prepend+o.toString():o.toString()}return this.logger.warn("no plural rule found for: ".concat(t)),""}}]),t}(),W=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};c(this,t),this.logger=_.create("interpolator"),this.options=e,this.format=e.interpolation&&e.interpolation.format||function(t){return t},this.init(e)}return f(t,[{key:"init",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};t.interpolation||(t.interpolation={escapeValue:!0});var e=t.interpolation;this.escape=void 0!==e.escape?e.escape:O,this.escapeValue=void 0===e.escapeValue||e.escapeValue,this.useRawValueToEscape=void 0!==e.useRawValueToEscape&&e.useRawValueToEscape,this.prefix=e.prefix?R(e.prefix):e.prefixEscaped||"{{",this.suffix=e.suffix?R(e.suffix):e.suffixEscaped||"}}",this.formatSeparator=e.formatSeparator?e.formatSeparator:e.formatSeparator||",",this.unescapePrefix=e.unescapeSuffix?"":e.unescapePrefix||"-",this.unescapeSuffix=this.unescapePrefix?"":e.unescapeSuffix||"",this.nestingPrefix=e.nestingPrefix?R(e.nestingPrefix):e.nestingPrefixEscaped||R("$t("),this.nestingSuffix=e.nestingSuffix?R(e.nestingSuffix):e.nestingSuffixEscaped||R(")"),this.nestingOptionsSeparator=e.nestingOptionsSeparator?e.nestingOptionsSeparator:e.nestingOptionsSeparator||",",this.maxReplaces=e.maxReplaces?e.maxReplaces:1e3,this.alwaysFormat=void 0!==e.alwaysFormat&&e.alwaysFormat,this.resetRegExp()}},{key:"reset",value:function(){this.options&&this.init(this.options)}},{key:"resetRegExp",value:function(){var t="".concat(this.prefix,"(.+?)").concat(this.suffix);this.regexp=new RegExp(t,"g");var e="".concat(this.prefix).concat(this.unescapePrefix,"(.+?)").concat(this.unescapeSuffix).concat(this.suffix);this.regexpUnescape=new RegExp(e,"g");var n="".concat(this.nestingPrefix,"(.+?)").concat(this.nestingSuffix);this.nestingRegexp=new RegExp(n,"g")}},{key:"interpolate",value:function(t,e,n,r){var o,i,s,a=this,u=this.options&&this.options.interpolation&&this.options.interpolation.defaultVariables||{};function l(t){return t.replace(/\$/g,"$$$$")}var c=function(t){if(t.indexOf(a.formatSeparator)<0){var o=C(e,u,t);return a.alwaysFormat?a.format(o,void 0,n):o}var i=t.split(a.formatSeparator),s=i.shift().trim(),l=i.join(a.formatSeparator).trim();return a.format(C(e,u,s),l,n,r)};this.resetRegExp();var h=r&&r.missingInterpolationHandler||this.options.missingInterpolationHandler,f=r&&r.interpolation&&r.interpolation.skipOnVariables||this.options.interpolation.skipOnVariables;return[{regex:this.regexpUnescape,safeValue:function(t){return l(t)}},{regex:this.regexp,safeValue:function(t){return a.escapeValue?l(a.escape(t)):l(t)}}].forEach((function(e){for(s=0;o=e.regex.exec(t);){if(void 0===(i=c(o[1].trim())))if("function"==typeof h){var n=h(t,o,r);i="string"==typeof n?n:""}else{if(f){i=o[0];continue}a.logger.warn("missed to pass in variable ".concat(o[1]," for interpolating ").concat(t)),i=""}else"string"==typeof i||a.useRawValueToEscape||(i=w(i));if(t=t.replace(o[0],e.safeValue(i)),e.regex.lastIndex=0,++s>=a.maxReplaces)break}})),t}},{key:"nest",value:function(t,e){var n,r,o=this,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},s=l({},i);function a(t,e){var n=this.nestingOptionsSeparator;if(t.indexOf(n)<0)return t;var r=t.split(new RegExp("".concat(n,"[ ]*{"))),o="{".concat(r[1]);t=r[0],o=(o=this.interpolate(o,s)).replace(/'/g,'"');try{s=JSON.parse(o),e&&(s=l({},e,s))}catch(e){return this.logger.warn("failed parsing options string in nesting for key ".concat(t),e),"".concat(t).concat(n).concat(o)}return delete s.defaultValue,t}for(s.applyPostProcessor=!1,delete s.defaultValue;n=this.nestingRegexp.exec(t);){var u=[],c=!1;if(n[0].includes(this.formatSeparator)&&!/{.*}/.test(n[1])){var h=n[1].split(this.formatSeparator).map((function(t){return t.trim()}));n[1]=h.shift(),u=h,c=!0}if((r=e(a.call(this,n[1].trim(),s),s))&&n[0]===t&&"string"!=typeof r)return r;"string"!=typeof r&&(r=w(r)),r||(this.logger.warn("missed to resolve ".concat(n[1]," for nesting ").concat(t)),r=""),c&&(r=u.reduce((function(t,e){return o.format(t,e,i.lng,i)}),r.trim())),t=t.replace(n[0],r),this.regexp.lastIndex=0}return t}}]),t}(),z=function(t){function e(t,n,r){var o,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return c(this,e),o=p(this,g(e).call(this)),P&&x.call(d(o)),o.backend=t,o.store=n,o.services=r,o.languageUtils=r.languageUtils,o.options=i,o.logger=_.create("backendConnector"),o.state={},o.queue=[],o.backend&&o.backend.init&&o.backend.init(r,i.backend,i),o}return y(e,t),f(e,[{key:"queueLoad",value:function(t,e,n,r){var o=this,i=[],s=[],a=[],u=[];return t.forEach((function(t){var r=!0;e.forEach((function(e){var a="".concat(t,"|").concat(e);!n.reload&&o.store.hasResourceBundle(t,e)?o.state[a]=2:o.state[a]<0||(1===o.state[a]?s.indexOf(a)<0&&s.push(a):(o.state[a]=1,r=!1,s.indexOf(a)<0&&s.push(a),i.indexOf(a)<0&&i.push(a),u.indexOf(e)<0&&u.push(e)))})),r||a.push(t)})),(i.length||s.length)&&this.queue.push({pending:s,loaded:{},errors:[],callback:r}),{toLoad:i,pending:s,toLoadLanguages:a,toLoadNamespaces:u}}},{key:"loaded",value:function(t,e,n){var r=t.split("|"),o=r[0],i=r[1];e&&this.emit("failedLoading",o,i,e),n&&this.store.addResourceBundle(o,i,n),this.state[t]=e?-1:2;var s={};this.queue.forEach((function(n){var r,a,u,l,c;r=n.loaded,a=i,(l=(u=S(r,[o],Object)).obj)[c=u.k]=l[c]||[],l[c].push(a),function(t,e){for(var n=t.indexOf(e);-1!==n;)t.splice(n,1),n=t.indexOf(e)}(n.pending,t),e&&n.errors.push(e),0!==n.pending.length||n.done||(Object.keys(n.loaded).forEach((function(t){s[t]||(s[t]=[]),n.loaded[t].length&&n.loaded[t].forEach((function(e){s[t].indexOf(e)<0&&s[t].push(e)}))})),n.done=!0,n.errors.length?n.callback(n.errors):n.callback())})),this.emit("loaded",s),this.queue=this.queue.filter((function(t){return!t.done}))}},{key:"read",value:function(t,e,n){var r=this,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:350,s=arguments.length>5?arguments[5]:void 0;return t.length?this.backend[n](t,e,(function(a,u){a&&u&&o<5?setTimeout((function(){r.read.call(r,t,e,n,o+1,2*i,s)}),i):s(a,u)})):s(null,{})}},{key:"prepareLoading",value:function(t,e){var n=this,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=arguments.length>3?arguments[3]:void 0;if(!this.backend)return this.logger.warn("No backend was added via i18next.use. Will not load resources."),o&&o();"string"==typeof t&&(t=this.languageUtils.toResolveHierarchy(t)),"string"==typeof e&&(e=[e]);var i=this.queueLoad(t,e,r,o);if(!i.toLoad.length)return i.pending.length||o(),null;i.toLoad.forEach((function(t){n.loadOne(t)}))}},{key:"load",value:function(t,e,n){this.prepareLoading(t,e,{},n)}},{key:"reload",value:function(t,e,n){this.prepareLoading(t,e,{reload:!0},n)}},{key:"loadOne",value:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",r=t.split("|"),o=r[0],i=r[1];this.read(o,i,"read",void 0,void 0,(function(r,s){r&&e.logger.warn("".concat(n,"loading namespace ").concat(i," for language ").concat(o," failed"),r),!r&&s&&e.logger.log("".concat(n,"loaded namespace ").concat(i," for language ").concat(o),s),e.loaded(t,r,s)}))}},{key:"saveMissing",value:function(t,e,n,r,o){var i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{};this.services.utils&&this.services.utils.hasLoadedNamespace&&!this.services.utils.hasLoadedNamespace(e)?this.logger.warn('did not save key "'.concat(n,'" as the namespace "').concat(e,'" was not yet loaded'),"This means something IS WRONG in your setup. You access the t function before i18next.init / i18next.loadNamespace / i18next.changeLanguage was done. Wait for the callback or Promise to resolve before accessing it!!!"):null!=n&&""!==n&&(this.backend&&this.backend.create&&this.backend.create(t,e,n,r,null,l({},i,{isUpdate:o})),t&&t[0]&&this.store.addResource(t[0],e,n,r))}}]),e}(x);function Y(){return{debug:!1,initImmediate:!0,ns:["translation"],defaultNS:["translation"],fallbackLng:["dev"],fallbackNS:!1,whitelist:!1,nonExplicitWhitelist:!1,supportedLngs:!1,nonExplicitSupportedLngs:!1,load:"all",preload:!1,simplifyPluralSuffix:!0,keySeparator:".",nsSeparator:":",pluralSeparator:"_",contextSeparator:"_",partialBundledLanguages:!1,saveMissing:!1,updateMissing:!1,saveMissingTo:"fallback",saveMissingPlurals:!0,missingKeyHandler:!1,missingInterpolationHandler:!1,postProcess:!1,postProcessPassResolved:!1,returnNull:!0,returnEmptyString:!0,returnObjects:!1,joinArrays:!1,returnedObjectHandler:!1,parseMissingKeyHandler:!1,appendNamespaceToMissingKey:!1,appendNamespaceToCIMode:!1,overloadTranslationOptionHandler:function(t){var e={};if("object"===a(t[1])&&(e=t[1]),"string"==typeof t[1]&&(e.defaultValue=t[1]),"string"==typeof t[2]&&(e.tDescription=t[2]),"object"===a(t[2])||"object"===a(t[3])){var n=t[3]||t[2];Object.keys(n).forEach((function(t){e[t]=n[t]}))}return e},interpolation:{escapeValue:!0,format:function(t,e,n,r){return t},prefix:"{{",suffix:"}}",formatSeparator:",",unescapePrefix:"-",nestingPrefix:"$t(",nestingSuffix:")",nestingOptionsSeparator:",",maxReplaces:1e3,skipOnVariables:!1}}}function V(t){return"string"==typeof t.ns&&(t.ns=[t.ns]),"string"==typeof t.fallbackLng&&(t.fallbackLng=[t.fallbackLng]),"string"==typeof t.fallbackNS&&(t.fallbackNS=[t.fallbackNS]),t.whitelist&&(t.whitelist&&t.whitelist.indexOf("cimode")<0&&(t.whitelist=t.whitelist.concat(["cimode"])),t.supportedLngs=t.whitelist),t.nonExplicitWhitelist&&(t.nonExplicitSupportedLngs=t.nonExplicitWhitelist),t.supportedLngs&&t.supportedLngs.indexOf("cimode")<0&&(t.supportedLngs=t.supportedLngs.concat(["cimode"])),t}function K(){}const X=new(function(t){function e(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=arguments.length>1?arguments[1]:void 0;if(c(this,e),t=p(this,g(e).call(this)),P&&x.call(d(t)),t.options=V(n),t.services={},t.logger=_,t.modules={external:[]},r&&!t.isInitialized&&!n.isClone){if(!t.options.initImmediate)return t.init(n,r),p(t,d(t));setTimeout((function(){t.init(n,r)}),0)}return t}return y(e,t),f(e,[{key:"init",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1?arguments[1]:void 0;function r(t){return t?"function"==typeof t?new t:t:null}if("function"==typeof e&&(n=e,e={}),e.whitelist&&!e.supportedLngs&&this.logger.deprecate("whitelist",'option "whitelist" will be renamed to "supportedLngs" in the next major - please make sure to rename this option asap.'),e.nonExplicitWhitelist&&!e.nonExplicitSupportedLngs&&this.logger.deprecate("whitelist",'options "nonExplicitWhitelist" will be renamed to "nonExplicitSupportedLngs" in the next major - please make sure to rename this option asap.'),this.options=l({},Y(),this.options,V(e)),this.format=this.options.interpolation.format,n||(n=K),!this.options.isClone){this.modules.logger?_.init(r(this.modules.logger),this.options):_.init(null,this.options);var o=new H(this.options);this.store=new M(this.options.resources,this.options);var i=this.services;i.logger=_,i.resourceStore=this.store,i.languageUtils=o,i.pluralResolver=new G(o,{prepend:this.options.pluralSeparator,compatibilityJSON:this.options.compatibilityJSON,simplifyPluralSuffix:this.options.simplifyPluralSuffix}),i.interpolator=new W(this.options),i.utils={hasLoadedNamespace:this.hasLoadedNamespace.bind(this)},i.backendConnector=new z(r(this.modules.backend),i.resourceStore,i,this.options),i.backendConnector.on("*",(function(e){for(var n=arguments.length,r=new Array(n>1?n-1:0),o=1;o<n;o++)r[o-1]=arguments[o];t.emit.apply(t,[e].concat(r))})),this.modules.languageDetector&&(i.languageDetector=r(this.modules.languageDetector),i.languageDetector.init(i,this.options.detection,this.options)),this.modules.i18nFormat&&(i.i18nFormat=r(this.modules.i18nFormat),i.i18nFormat.init&&i.i18nFormat.init(this)),this.translator=new j(this.services,this.options),this.translator.on("*",(function(e){for(var n=arguments.length,r=new Array(n>1?n-1:0),o=1;o<n;o++)r[o-1]=arguments[o];t.emit.apply(t,[e].concat(r))})),this.modules.external.forEach((function(e){e.init&&e.init(t)}))}if(this.options.fallbackLng&&!this.services.languageDetector&&!this.options.lng){var s=this.services.languageUtils.getFallbackCodes(this.options.fallbackLng);s.length>0&&"dev"!==s[0]&&(this.options.lng=s[0])}this.services.languageDetector||this.options.lng||this.logger.warn("init: no languageDetector is used and no lng is defined");var a=["getResource","hasResourceBundle","getResourceBundle","getDataByLanguage"];a.forEach((function(e){t[e]=function(){var n;return(n=t.store)[e].apply(n,arguments)}}));var u=["addResource","addResources","addResourceBundle","removeResourceBundle"];u.forEach((function(e){t[e]=function(){var n;return(n=t.store)[e].apply(n,arguments),t}}));var c=b(),h=function(){var e=function(e,r){t.isInitialized&&t.logger.warn("init: i18next is already initialized. You should call init just once!"),t.isInitialized=!0,t.options.isClone||t.logger.log("initialized",t.options),t.emit("initialized",t.options),c.resolve(r),n(e,r)};if(t.languages&&"v1"!==t.options.compatibilityAPI&&!t.isInitialized)return e(null,t.t.bind(t));t.changeLanguage(t.options.lng,e)};return this.options.resources||!this.options.initImmediate?h():setTimeout(h,0),c}},{key:"loadResources",value:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:K,r=n,o="string"==typeof t?t:this.language;if("function"==typeof t&&(r=t),!this.options.resources||this.options.partialBundledLanguages){if(o&&"cimode"===o.toLowerCase())return r();var i=[],s=function(t){t&&e.services.languageUtils.toResolveHierarchy(t).forEach((function(t){i.indexOf(t)<0&&i.push(t)}))};if(o)s(o);else{var a=this.services.languageUtils.getFallbackCodes(this.options.fallbackLng);a.forEach((function(t){return s(t)}))}this.options.preload&&this.options.preload.forEach((function(t){return s(t)})),this.services.backendConnector.load(i,this.options.ns,r)}else r(null)}},{key:"reloadResources",value:function(t,e,n){var r=b();return t||(t=this.languages),e||(e=this.options.ns),n||(n=K),this.services.backendConnector.reload(t,e,(function(t){r.resolve(),n(t)})),r}},{key:"use",value:function(t){if(!t)throw new Error("You are passing an undefined module! Please check the object you are passing to i18next.use()");if(!t.type)throw new Error("You are passing a wrong module! Please check the object you are passing to i18next.use()");return"backend"===t.type&&(this.modules.backend=t),("logger"===t.type||t.log&&t.warn&&t.error)&&(this.modules.logger=t),"languageDetector"===t.type&&(this.modules.languageDetector=t),"i18nFormat"===t.type&&(this.modules.i18nFormat=t),"postProcessor"===t.type&&E.addPostProcessor(t),"3rdParty"===t.type&&this.modules.external.push(t),this}},{key:"changeLanguage",value:function(t,e){var n=this;this.isLanguageChangingTo=t;var r=b();this.emit("languageChanging",t);var o=function(t){var o="string"==typeof t?t:n.services.languageUtils.getBestMatchFromCodes(t);o&&(n.language||(n.language=o,n.languages=n.services.languageUtils.toResolveHierarchy(o)),n.translator.language||n.translator.changeLanguage(o),n.services.languageDetector&&n.services.languageDetector.cacheUserLanguage(o)),n.loadResources(o,(function(t){!function(t,o){o?(n.language=o,n.languages=n.services.languageUtils.toResolveHierarchy(o),n.translator.changeLanguage(o),n.isLanguageChangingTo=void 0,n.emit("languageChanged",o),n.logger.log("languageChanged",o)):n.isLanguageChangingTo=void 0,r.resolve((function(){return n.t.apply(n,arguments)})),e&&e(t,(function(){return n.t.apply(n,arguments)}))}(t,o)}))};return t||!this.services.languageDetector||this.services.languageDetector.async?!t&&this.services.languageDetector&&this.services.languageDetector.async?this.services.languageDetector.detect(o):o(t):o(this.services.languageDetector.detect()),r}},{key:"getFixedT",value:function(t,e){var n=this,r=function t(e,r){var o;if("object"!==a(r)){for(var i=arguments.length,s=new Array(i>2?i-2:0),u=2;u<i;u++)s[u-2]=arguments[u];o=n.options.overloadTranslationOptionHandler([e,r].concat(s))}else o=l({},r);return o.lng=o.lng||t.lng,o.lngs=o.lngs||t.lngs,o.ns=o.ns||t.ns,n.t(e,o)};return"string"==typeof t?r.lng=t:r.lngs=t,r.ns=e,r}},{key:"t",value:function(){var t;return this.translator&&(t=this.translator).translate.apply(t,arguments)}},{key:"exists",value:function(){var t;return this.translator&&(t=this.translator).exists.apply(t,arguments)}},{key:"setDefaultNamespace",value:function(t){this.options.defaultNS=t}},{key:"hasLoadedNamespace",value:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!this.isInitialized)return this.logger.warn("hasLoadedNamespace: i18next was not initialized",this.languages),!1;if(!this.languages||!this.languages.length)return this.logger.warn("hasLoadedNamespace: i18n.languages were undefined or empty",this.languages),!1;var r=this.languages[0],o=!!this.options&&this.options.fallbackLng,i=this.languages[this.languages.length-1];if("cimode"===r.toLowerCase())return!0;var s=function(t,n){var r=e.services.backendConnector.state["".concat(t,"|").concat(n)];return-1===r||2===r};if(n.precheck){var a=n.precheck(this,s);if(void 0!==a)return a}return!!this.hasResourceBundle(r,t)||!this.services.backendConnector.backend||!(!s(r,t)||o&&!s(i,t))}},{key:"loadNamespaces",value:function(t,e){var n=this,r=b();return this.options.ns?("string"==typeof t&&(t=[t]),t.forEach((function(t){n.options.ns.indexOf(t)<0&&n.options.ns.push(t)})),this.loadResources((function(t){r.resolve(),e&&e(t)})),r):(e&&e(),Promise.resolve())}},{key:"loadLanguages",value:function(t,e){var n=b();"string"==typeof t&&(t=[t]);var r=this.options.preload||[],o=t.filter((function(t){return r.indexOf(t)<0}));return o.length?(this.options.preload=r.concat(o),this.loadResources((function(t){n.resolve(),e&&e(t)})),n):(e&&e(),Promise.resolve())}},{key:"dir",value:function(t){return t||(t=this.languages&&this.languages.length>0?this.languages[0]:this.language),t?["ar","shu","sqr","ssh","xaa","yhd","yud","aao","abh","abv","acm","acq","acw","acx","acy","adf","ads","aeb","aec","afb","ajp","apc","apd","arb","arq","ars","ary","arz","auz","avl","ayh","ayl","ayn","ayp","bbz","pga","he","iw","ps","pbt","pbu","pst","prp","prd","ug","ur","ydd","yds","yih","ji","yi","hbo","men","xmn","fa","jpr","peo","pes","prs","dv","sam"].indexOf(this.services.languageUtils.getLanguagePartFromCode(t))>=0?"rtl":"ltr":"rtl"}},{key:"createInstance",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1?arguments[1]:void 0;return new e(t,n)}},{key:"cloneInstance",value:function(){var t=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:K,o=l({},this.options,n,{isClone:!0}),i=new e(o),s=["store","services","language"];return s.forEach((function(e){i[e]=t[e]})),i.services=l({},this.services),i.services.utils={hasLoadedNamespace:i.hasLoadedNamespace.bind(i)},i.translator=new j(i.services,i.options),i.translator.on("*",(function(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];i.emit.apply(i,[t].concat(n))})),i.init(o,r),i.translator.options=i.options,i.translator.backendConnector.services.utils={hasLoadedNamespace:i.hasLoadedNamespace.bind(i)},i}}]),e}(x)),Q=JSON.parse('{"shiftLeft":{"name":"Shift Left","description":"Press to move a polyomino to the left once, or hold to engage the Autoshift."},"shiftRight":{"name":"Shift Right","description":"Press to move a polyomino to the right once, or hold to engage the Autoshift."},"hardDrop":{"name":"Hard Drop","description":"Drop a polyomino instantly the floor and lock it in place."},"softDrop":{"name":"Soft Drop","description":"Speed up the descent of a polyomino."},"rotateLeft":{"name":"Rotate Left","description":"Rotate a polyomino 90° counter-clockwise."},"rotateRight":{"name":"Rotate Right","description":"Rotate a polyomino 90° clockwise."},"rotate180":{"name":"Rotate 180°","description":"Rotate a polyomino 180°."},"hold":{"name":"Hold","description":"Send a polyomino to the HOLD Queue."},"retry":{"name":"Retry","description":"Instantly have another attempt in the current mode."},"pause":{"name":"Pause","description":"Pause the game."},"sonicDrop":{"name":"Sonic Drop"},"softDropWithLock":{"name":"Soft Drop with Lock"}}');var q=n.t(Q,2);const $=JSON.parse('{"createdBy":"Created by {{author}}","style":{"categoryName":"Game Styles","guideline":{"name":"Guideline","description":"The standard variant found in most modern games."},"tetraX":{"name":"Tetra-X","description":"The custom variant designed by Dr Ocelot."},"retro":{"name":"Retro","description":"The classic variant loved by oldschool players."},"arcade":{"name":"Arcade","description":"The difficult variant loved by hardcore players."}},"settings":{"categoryName":"Settings","controls":{"name":"Controls","description":"Customize how the game controls."},"tuning":{"name":"Tuning","description":"Customize how the game handles."},"audio":{"name":"Audio","description":"Customize how the game sounds."},"video":{"name":"Video","description":"Customize how the game looks."}}}');var Z=n.t($,2);const J=JSON.parse('{"next":"NEXT","hold":"HOLD","ready":"Ready?","start":"Start!","pause":"Pause","gameOver":"Game Over","blockOut":"Block Out","lockOut":"Lock Out","topOut":"Top Out","timeUp":"Time Up","excellent":"Excellent","continue":"Continue","retry":"Retry","quit":"Quit"}');var tt=n.t(J,2);const et=JSON.parse('{"marathon":{"name":"Marathon"},"sprint":{"name":"Sprint"}}');var nt=n.t(et,2);const rt=JSON.parse('{"level":"Level","lines":"Lines","placed":"Placed"}');var ot=n.t(rt,2);class it{}it.config=new class{constructor(){this.autoshiftDelay=170,this.autoshiftRate=30,this.autoshiftBuffering="charge"}},it.controls=new class{constructor(){this.shiftLeft=["ArrowLeft"],this.shiftRight=["ArrowRight"],this.hardDrop=["Space"],this.softDrop=["ArrowDown"],this.rotateLeft=["KeyZ","ControlLeft"],this.rotateRight=["KeyX","ArrowUp"],this.rotate180=["KeyD"],this.hold=["KeyC","ShiftLeft"],this.retry=["KeyR"],this.pause=["Escape","KeyP"],this.menuUp=["ArrowUp"],this.menuDown=["ArrowDown"],this.menuLeft=["ArrowLeft"],this.menuRight=["ArrowRight"],this.menuSelect=["Enter"],this.menuBack=["Backspace"]}};class st{static init(){if(st.hasInitiated)throw new Error("Do not initiate Input more than once.");for(const t of Object.keys(it.controls))st.currentGameKeys[t]=new Set,st.lastGameKeys[t]=new Set;document.addEventListener("keydown",st.keyDownListener),document.addEventListener("keyup",st.keyUpListener),st.hasInitiated=!0}static keyDownListener(t){for(const e of Object.keys(it.controls))-1!==it.controls[e].indexOf(t.code)&&st.currentGameKeys[e].add(t.code)}static keyUpListener(t){for(const e of Object.keys(it.controls))-1!==it.controls[e].indexOf(t.code)&&st.currentGameKeys[e].delete(t.code)}static updateGameInput(){for(const t of Object.keys(st.currentGameKeys))st.lastGameKeys[t]=new Set(st.currentGameKeys[t])}static getGameDown(t){return st.currentGameKeys[t].size>0}static getGamePress(t){return st.currentGameKeys[t].size>st.lastGameKeys[t].size}static getGameRelease(t){return st.currentGameKeys[t].size<st.lastGameKeys[t].size}static getGamePressAsNum(t){return Math.max(0,st.currentGameKeys[t].size-st.lastGameKeys[t].size)}}st.currentGameKeys={},st.lastGameKeys={},st.hasInitiated=!1,st.init();const at={i8:"0.3.0"};class ut{static getVersion(){return at.i8}static isDevBuild(){return at.i8.includes("dev")}static getRendererContainer(){return this.rendererContainer}static setRender(t){var e;null===(e=this.renderer)||void 0===e||e.destroy(),ut.renderer=t,this.renderer.construct()}static init(){ut.rendererContainer=document.createElement("div"),ut.rendererContainer.classList.add("renderer"),document.body.prepend(ut.rendererContainer),ut.isDevBuild()&&ut.createDevBuildWatermark(),ut.last=performance.now(),window.onresize=ut.onResize.bind(ut),window.requestAnimationFrame(ut.animFrameLoop.bind(ut))}static createDevBuildWatermark(){const t=document.createElement("div");t.classList.add("dev"),document.body.prepend(t);const e=document.createElement("div");e.classList.add("development-watermark"),e.textContent=`Development Build: ${ut.getVersion()}`,t.appendChild(e),ut.fpsContainer=document.createElement("div"),ut.fpsContainer.classList.add("fps-dev"),ut.fpsContainer.textContent="00 FPS",t.appendChild(ut.fpsContainer)}static onResize(){this.renderer.onResize()}static animFrameLoop(){ut.now=window.performance.now();const t=ut.now-ut.last;if(ut.doLogicTick(t),ut.doDrawTick(t),st.updateGameInput(),s.playQueue(),ut.isDevBuild()){const t=500;ut.fpsCounterRefreshAccum+=ut.now-ut.last,ut.fpsCounterRefreshAccum>=t&&(ut.fpsCounterRefreshAccum-=t,ut.fpsContainer.textContent=`${Math.round(1e3/(ut.now-ut.last))} FPS`)}ut.last=ut.now,window.requestAnimationFrame(ut.animFrameLoop.bind(ut))}static doLogicTick(t){null!=ut.renderer&&ut.renderer.doLogicTick(t)}static doDrawTick(t){null!=ut.renderer&&ut.renderer.doDrawTick(t)}}ut.fpsCounterRefreshAccum=0;function lt(t){return t.getContext("2d")}function ct(t){t.clearRect(0,0,t.canvas.clientWidth,t.canvas.clientHeight)}function ht(t){for(;t.firstChild;)t.removeChild(t.firstChild)}function ft(t){t.offsetWidth}function dt(t,e){t.classList.remove(e),ft(t),t.classList.add(e)}class pt{construct(){}destroy(){ht(ut.getRendererContainer())}doDrawTick(t){}doLogicTick(t){}onResize(){}}var gt=n(486);class mt{constructor({rule:t}){this.markedForDeath=[],this.rule=t,this.width=this.rule.matrixWidth,this.height=this.rule.matrixHeight,this.hiddenHeight=this.rule.matrixHiddenHeight,this.resetGrid()}resetGrid(){const t=new Array(this.getHeight()).fill([]);for(let e=0;e<t.length;e++)t[e]=new Array(this.width).fill(null);this.grid=t}getGridWithPolyomino(t,e,n){const r=(0,gt.cloneDeep)(this.grid);if(null==n)return r;for(let o=0;o<n.getTotalMonominos();o++){const i=n.getMonominos()[o],s=t+n.getCurrentCoordinates()[o].x;r[e+n.getCurrentCoordinates()[o].y][s]=i}return r}getWidth(){return this.width}getHeight(){return this.height+this.hiddenHeight}getVisibleHeight(){return this.height}getHiddenHeight(){return this.hiddenHeight}getCoordinateType(t,e){return e<0&&this.rule.matrixHasCeiling||t<0||t>=this.width||e>=this.getHeight()?"wall":e>=this.hiddenHeight?"normal":"hidden"}hasObstructionAt(t,e){return"wall"===this.getCoordinateType(t,e)||this.hasMonominoAt(t,e)}hasMonominoAt(t,e){return null!=this.grid[e][t]}addMonominoTo(t,e,n){null!=this.grid&&(this.grid[e][t]=n)}getFilledRows(t=this.grid){const e=[];for(let n=0;n<t.length;n++)for(let r=0;r<=t.length;r++){if(r===t[n].length){e.push(n);break}if(null==t[n][r])break}return e}getRowsMarkedForDeath(){return this.markedForDeath}markFilledRowsForDeath(){this.markedForDeath=[...this.getFilledRows()]}killRowsMarkedForDeath(){for(const t of this.markedForDeath)for(let e=0;e<this.grid[t].length;e++)this.grid[t][e]=null}collapseRowsMarkedForDeath(){let t=!1;for(const e of this.markedForDeath)for(let n=e;n>=0;n--)if(0!==n){this.grid[n]=this.grid[n-1];for(const e of this.grid[n])null!=e&&(t=!0);this.markedForDeath.splice(e,1)}else this.grid[n]=new Array(this.width).fill(null);return this.markedForDeath=[],t}isEmpty(){if(null==this.grid)return!0;for(const t of this.grid)for(const e of t)if(null!=e)return!1;return!0}isCloseToSkyline(){return this.getHighest()-this.hiddenHeight-4<0}getHighest(){for(let t=0;t<this.grid.length;t++)for(const e of this.grid[t])if(null!==e)return t;return this.getHeight()}getDrawData(){const t=[];for(let e=0;e<this.grid.length;e++)for(let n=0;n<this.grid[e].length;n++){const r=this.grid[e][n];null==r?t.push({x:n,y:e-this.getHiddenHeight(),color:"invalid",timeLocked:Number.MIN_SAFE_INTEGER,shape:"none",skin:null}):t.push({x:n,y:e-this.getHiddenHeight(),color:r.getColor(),timeLocked:r.getLockedTime(),shape:r.getShape(),skin:r.getSkin()})}return t}}class yt{constructor({color:t="invalid",connectionsByte:e=0}={}){this.timeLocked=Number.MIN_SAFE_INTEGER,this.shape="none",this.skin=null,this.color=t,this.connectionsByte=e}getColor(){return this.color}setColor(t){this.color=t}getLockedTime(){return this.timeLocked}setLockedTime(){this.timeLocked=performance.now()}setShape(t){this.shape=t}getShape(){return this.shape}setSkin(t){this.skin=t}getSkin(){return this.skin}getConnectionState(t){return 0!=(this.connectionsByte&t)}setConnectionState(t,e){e?this.connectionsByte|=t:this.connectionsByte&=~t}setConnectionsByte(t){if(t<0||t>255)throw new Error("The connection byte specified is not within 0-255");this.connectionsByte=t}}class vt{constructor({shape:t}){this.shape="none",this.orientation=0,this.data=null,this.monominos=[],this.setShape(t);for(let t=0;t<this.getTotalMonominos();t++)this.monominos.push(new yt);this.setShape(t)}getMonominos(){return this.monominos}setShape(t){this.shape=t;for(const e of this.monominos)e.setShape(t);this.data=vt.DATA[this.shape]}setOrientation(t){this.orientation=t}getOrientation(){return this.orientation}getCurrentCoordinates(){return this.data[this.orientation]}getCoordinates(t){return this.data[t]}getShape(){return this.shape}getVisualData(t=this.orientation){return vt.VISUAL_LENGTHS[this.shape][t]}setColor(t){for(const e of this.monominos)e.setColor(t)}setSkin(t){for(const e of this.monominos)e.setSkin(t)}getTotalMonominos(){return vt.DATA[this.shape][this.orientation].length}placeToMatrix({x:t,y:e,matrix:n}){for(let r=0;r<this.getTotalMonominos();r++){const o=this.monominos[r],i=t+this.getCurrentCoordinates()[r].x,s=e+this.getCurrentCoordinates()[r].y;o.setLockedTime(),n.addMonominoTo(i,s,o)}}assignDefaultsFromRule(t){this.setOrientation(t.rotationSystem.initialOrientation[this.getShape()]),this.setColor(t.colors[this.getShape()]),this.setSkin(t.skin)}}function _t(t){return 60/t*1e3}vt.DATA={i:[[{x:0,y:1,connections:8},{x:1,y:1,connections:12},{x:2,y:1,connections:12},{x:3,y:1,connections:4}],[{x:2,y:0,connections:2},{x:2,y:1,connections:3},{x:2,y:2,connections:3},{x:2,y:3,connections:1}],[{x:3,y:2,connections:4},{x:2,y:2,connections:12},{x:1,y:2,connections:12},{x:0,y:2,connections:8}],[{x:1,y:3,connections:1},{x:1,y:2,connections:3},{x:1,y:1,connections:3},{x:1,y:0,connections:2}]],j:[[{x:0,y:0,connections:2},{x:0,y:1,connections:9},{x:1,y:1,connections:12},{x:2,y:1,connections:4}],[{x:2,y:0,connections:4},{x:1,y:0,connections:10},{x:1,y:1,connections:3},{x:1,y:2,connections:1}],[{x:2,y:2,connections:1},{x:2,y:1,connections:6},{x:1,y:1,connections:12},{x:0,y:1,connections:8}],[{x:0,y:2,connections:8},{x:1,y:2,connections:5},{x:1,y:1,connections:3},{x:1,y:0,connections:2}]],l:[[{x:2,y:0,connections:2},{x:2,y:1,connections:5},{x:1,y:1,connections:12},{x:0,y:1,connections:8}],[{x:2,y:2,connections:4},{x:1,y:2,connections:9},{x:1,y:1,connections:3},{x:1,y:0,connections:2}],[{x:0,y:2,connections:1},{x:0,y:1,connections:10},{x:1,y:1,connections:12},{x:2,y:1,connections:4}],[{x:0,y:0,connections:8},{x:1,y:0,connections:6},{x:1,y:1,connections:3},{x:1,y:2,connections:1}]],o:[[{x:0,y:0,connections:138},{x:1,y:0,connections:70},{x:1,y:1,connections:21},{x:0,y:1,connections:41}],[{x:1,y:0,connections:70},{x:1,y:1,connections:21},{x:0,y:1,connections:41},{x:0,y:0,connections:138}],[{x:1,y:1,connections:21},{x:0,y:1,connections:41},{x:0,y:0,connections:138},{x:1,y:0,connections:70}],[{x:0,y:1,connections:41},{x:0,y:0,connections:138},{x:1,y:0,connections:70},{x:1,y:1,connections:21}]],s:[[{x:2,y:0,connections:4},{x:1,y:0,connections:10},{x:1,y:1,connections:5},{x:0,y:1,connections:8}],[{x:2,y:2,connections:1},{x:2,y:1,connections:6},{x:1,y:1,connections:9},{x:1,y:0,connections:2}],[{x:0,y:2,connections:8},{x:1,y:2,connections:5},{x:1,y:1,connections:10},{x:2,y:1,connections:4}],[{x:0,y:0,connections:2},{x:0,y:1,connections:9},{x:1,y:1,connections:6},{x:1,y:2,connections:1}]],t:[[{x:1,y:0,connections:2},{x:0,y:1,connections:8},{x:1,y:1,connections:13},{x:2,y:1,connections:4}],[{x:2,y:1,connections:4},{x:1,y:0,connections:2},{x:1,y:1,connections:11},{x:1,y:2,connections:1}],[{x:1,y:2,connections:1},{x:2,y:1,connections:4},{x:1,y:1,connections:14},{x:0,y:1,connections:8}],[{x:0,y:1,connections:8},{x:1,y:2,connections:1},{x:1,y:1,connections:7},{x:1,y:0,connections:2}]],z:[[{x:0,y:0,connections:8},{x:1,y:0,connections:6},{x:1,y:1,connections:9},{x:2,y:1,connections:4}],[{x:2,y:0,connections:2},{x:2,y:1,connections:5},{x:1,y:1,connections:10},{x:1,y:2,connections:1}],[{x:2,y:2,connections:4},{x:1,y:2,connections:9},{x:1,y:1,connections:6},{x:0,y:1,connections:8}],[{x:0,y:2,connections:1},{x:0,y:1,connections:10},{x:1,y:1,connections:5},{x:1,y:0,connections:2}]]},vt.VISUAL_LENGTHS={i:[{startX:0,endX:3,startY:1,endY:1},{startX:2,endX:2,startY:0,endY:3},{startX:0,endX:3,startY:2,endY:2},{startX:1,endX:1,startY:0,endY:3}],j:[{startX:0,endX:2,startY:0,endY:1},{startX:1,endX:2,startY:0,endY:2},{startX:0,endX:2,startY:1,endY:2},{startX:0,endX:1,startY:0,endY:2}],l:[{startX:0,endX:2,startY:0,endY:1},{startX:1,endX:2,startY:0,endY:2},{startX:0,endX:2,startY:1,endY:2},{startX:0,endX:1,startY:0,endY:2}],o:[{startX:0,endX:1,startY:0,endY:1},{startX:0,endX:1,startY:0,endY:1},{startX:0,endX:1,startY:0,endY:1},{startX:0,endX:1,startY:0,endY:1}],s:[{startX:0,endX:2,startY:0,endY:1},{startX:1,endX:2,startY:0,endY:2},{startX:0,endX:2,startY:1,endY:2},{startX:0,endX:1,startY:0,endY:2}],t:[{startX:0,endX:2,startY:0,endY:1},{startX:1,endX:2,startY:0,endY:2},{startX:0,endX:2,startY:1,endY:2},{startX:0,endX:1,startY:0,endY:2}],z:[{startX:0,endX:2,startY:0,endY:1},{startX:1,endX:2,startY:0,endY:2},{startX:0,endX:2,startY:1,endY:2},{startX:0,endX:1,startY:0,endY:2}]},vt.SPIN_POINTS={i:[{major1:[{x:1,y:0},{x:2,y:0}],major2:[{x:2,y:2},{x:1,y:2}],minor1:[{x:-1,y:1}],minor2:[{x:4,y:1}]},{major1:[{x:1,y:1},{x:1,y:2}],major2:[{x:3,y:2},{x:3,y:1}],minor1:[{x:2,y:-1}],minor2:[{x:2,y:4}]},{major1:[{x:1,y:1},{x:2,y:1}],major2:[{x:2,y:3},{x:1,y:3}],minor1:[{x:-1,y:2}],minor2:[{x:4,y:2}]},{major1:[{x:0,y:1},{x:0,y:2}],major2:[{x:2,y:2},{x:2,y:1}],minor1:[{x:1,y:-1}],minor2:[{x:1,y:4}]}],j:[{major1:[{x:1,y:0}],major2:[{x:2,y:0}],minor1:[{x:0,y:2}],minor2:[{x:2,y:2}]},{major1:[{x:2,y:1}],major2:[{x:2,y:2}],minor1:[{x:0,y:0}],minor2:[{x:0,y:2}]},{major1:[{x:1,y:2}],major2:[{x:0,y:2}],minor1:[{x:2,y:0}],minor2:[{x:0,y:0}]},{major1:[{x:0,y:1}],major2:[{x:0,y:0}],minor1:[{x:2,y:2}],minor2:[{x:2,y:0}]}],l:[{major1:[{x:1,y:0}],major2:[{x:0,y:0}],minor1:[{x:2,y:2}],minor2:[{x:0,y:2}]},{major1:[{x:2,y:1}],major2:[{x:2,y:0}],minor1:[{x:0,y:2}],minor2:[{x:0,y:0}]},{major1:[{x:1,y:2}],major2:[{x:2,y:2}],minor1:[{x:0,y:0}],minor2:[{x:2,y:0}]},{major1:[{x:0,y:1}],major2:[{x:0,y:2}],minor1:[{x:2,y:0}],minor2:[{x:2,y:2}]}],o:[{major1:[],major2:[],minor1:[],minor2:[]},{major1:[],major2:[],minor1:[],minor2:[]},{major1:[],major2:[],minor1:[],minor2:[]},{major1:[],major2:[],minor1:[],minor2:[]}],s:[{major1:[{x:0,y:0}],major2:[{x:2,y:1}],minor1:[{x:3,y:0}],minor2:[{x:-1,y:1}]},{major1:[{x:1,y:2}],major2:[{x:2,y:0}],minor1:[{x:1,y:-1}],minor2:[{x:2,y:3}]},{major1:[{x:2,y:2}],major2:[{x:0,y:1}],minor1:[{x:-1,y:2}],minor2:[{x:3,y:1}]},{major1:[{x:1,y:0}],major2:[{x:0,y:2}],minor1:[{x:1,y:3}],minor2:[{x:0,y:-1}]}],t:[{major1:[{x:0,y:0}],major2:[{x:2,y:0}],minor1:[{x:0,y:2}],minor2:[{x:2,y:2}]},{major1:[{x:2,y:0}],major2:[{x:2,y:2}],minor1:[{x:0,y:0}],minor2:[{x:0,y:2}]},{major1:[{x:0,y:2}],major2:[{x:2,y:2}],minor1:[{x:0,y:0}],minor2:[{x:2,y:0}]},{major1:[{x:0,y:0}],major2:[{x:0,y:2}],minor1:[{x:2,y:0}],minor2:[{x:2,y:2}]}],z:[{major1:[{x:2,y:0}],major2:[{x:0,y:1}],minor1:[{x:-1,y:0}],minor2:[{x:3,y:1}]},{major1:[{x:2,y:2}],major2:[{x:1,y:0}],minor1:[{x:2,y:-1}],minor2:[{x:1,y:3}]},{major1:[{x:0,y:2}],major2:[{x:2,y:1}],minor1:[{x:3,y:2}],minor2:[{x:-1,y:1}]},{major1:[{x:0,y:0}],major2:[{x:1,y:2}],minor1:[{x:0,y:3}],minor2:[{x:1,y:-1}]}]},vt.TETROMINOES=["i","j","l","o","s","t","z"];class xt{constructor({matrix:t,rule:e,mode:n}){this._isDirty=!0,this.lastY=0,this.lowestY=0,this.inSoftDrop=!1,this.fallSpeed=1e3,this.mustUpgradeSpin=!1,this.matrix=t,this.rule=e,this.mode=n}lockdown(){this.polyomino.placeToMatrix({x:this.x,y:this.getIntY(),matrix:this.matrix}),this.polyomino=null,this.needsRedrawing()}isDead(){return null==this.polyomino}isDirty(){var t;return!(!this.isOnGround()||"retro"===this.rule.lockDelayType)||this.lastPolyomino!==this.polyomino||this.lastDrawnX!==this.x||this.lastDrawnY!==this.getIntY()||this.lastDrawnOrientation!==(null===(t=this.polyomino)||void 0===t?void 0:t.getOrientation())}updateDirtyLasts(){var t;this.lastPolyomino=this.polyomino,this.lastDrawnX=this.x,this.lastDrawnY=this.getIntY(),this.lastDrawnOrientation=null===(t=this.polyomino)||void 0===t?void 0:t.getOrientation()}wasDrawn(){this._isDirty=!1}needsRedrawing(){this._isDirty=!0}init(t){this.polyomino=t;const e=this.rule.spawnOffsets[this.polyomino.getShape()],n=this.rule.rotationSystem.offsets[this.polyomino.getShape()][this.polyomino.getOrientation()];this.x=e.x+n.x,this.y=e.y+this.matrix.getHiddenHeight()+n.y,this.shift(0,this.rule.immediateDropOnSpawn),this.is20G()&&!this.rule.suspendPieceUntilAction&&this.slamToFloor(),this.lowestY=0,this.updateLowestAndLastY(),this.resetLockDelay(),this.needsRedrawing(),this.needsToDie=!1,this.lastAction="spawn"}collidesWith(t,e,n){var r;if(void 0===n&&(n=null===(r=this.polyomino)||void 0===r?void 0:r.getOrientation()),this.isDead())return;const[o,i]=[this.x+t,this.getIntY()+e];for(let t=0;t<this.polyomino.getTotalMonominos();t++){const e=o+this.polyomino.getCoordinates(n)[t].x,r=i+this.polyomino.getCoordinates(n)[t].y;if("wall"===this.matrix.getCoordinateType(e,r))return!0;if(this.matrix.hasMonominoAt(e,r))return!0}return!1}updateLowestAndLastY(){var t;this.lowestY=Math.max(this.getIntY()+(null===(t=this.polyomino)||void 0===t?void 0:t.getVisualData().endY),this.lowestY),this.lastY=this.y}isOnGround(){return this.collidesWith(0,1)}isStuck(){return this.collidesWith(0,0)}canShiftLeft(){return!this.collidesWith(-1,0)}canShiftRight(){return!this.collidesWith(1,0)}shift(t,e){this.collidesWith(t,e)||(this.x+=t,this.y+=e,0===t&&0===e||this.needsRedrawing())}shiftLeft(){this.canShiftLeft()&&null!=this.polyomino&&(s.add("pieceMove"),this.lastAction="move",this.movementsAccum++,(this.collidesWith(-1,1)||this.isOnGround())&&s.add("pieceSlide")),this.shift(-1,0)}shiftRight(){this.canShiftRight()&&null!=this.polyomino&&(s.add("pieceMove"),this.lastAction="move",this.movementsAccum++,(this.collidesWith(1,1)||this.isOnGround())&&s.add("pieceSlide")),this.shift(1,0)}rotate(t){if(this.isDead())return;const e=(this.polyomino.getOrientation()+t)%4,n=this.rule.rotationSystem.offsets[this.getPolyominoShape()],r=n[e].x-n[this.polyomino.getOrientation()].x,o=n[e].y-n[this.polyomino.getOrientation()].y,i=this.rule.rotationSystem.wallkick.executeWallkick({xOffset:r,yOffset:o,rotateDirection:t,oldOrientation:this.polyomino.getOrientation(),newOrientation:e,allowFloorKicks:!0,polyominoController:this,matrix:this.matrix});if(null!=i){if(i.usedKick&&"disable-wallkick"===this.rule.resetExpirationPenalty&&this.hasExhaustedResets())return;this.polyomino.setOrientation(i.orientation),this.x+=i.xOffset+r,this.y+=i.yOffset+o,i.usedKick&&this.rule.resetLockDelayByKicking&&(this.lockDelayAccum=0),this.lastAction="rotate",this.mustUpgradeSpin=i.mustUpgradeSpin;const t=this.checkIfSpin();t.isSpin?t.isMini?s.add("pieceRotateTMini"):s.add("pieceRotateT"):s.add("pieceRotate"),i.usedKick&&s.add("pieceWallkick"),this.rotationsAccum++,this.needsRedrawing()}}checkIfSpin(){if("rotate"!==this.lastAction)return{isSpin:!1,isMini:!1};if(!this.collidesWith(0,1))return{isSpin:!1,isMini:!1};const t=this.polyomino.getShape();if(-1===this.mode.scoring.spinPolyominoList.indexOf(t))return{isSpin:!1,isMini:!1};const e=this.polyomino.getOrientation();if("threeCorner"===this.mode.scoring.spinBonusType){const n=t=>{for(const e of t)if(this.matrix.hasObstructionAt(this.x+e.x,this.getIntY()+e.y))return!0},r=n(vt.SPIN_POINTS[t][e].major1),o=n(vt.SPIN_POINTS[t][e].major2),i=n(vt.SPIN_POINTS[t][e].minor1),s=n(vt.SPIN_POINTS[t][e].minor2);if(r&&o&&(i||s))return{isSpin:!0,isMini:!1};if((r||o)&&i&&s)return{isSpin:!0,isMini:!this.mustUpgradeSpin}}else if("immobile"===this.mode.scoring.spinBonusType&&this.collidesWith(-1,0)&&this.collidesWith(1,0)&&this.collidesWith(0,-1))return{isSpin:!0,isMini:!1};return{isSpin:!1,isMini:!1}}doGravity(t){if(this.isDead())return;if(this.rule.suspendPieceUntilAction&&"spawn"===this.lastAction)return;const e=t/this.getFallSpeed();if("retro"===this.rule.lockDelayType)if(this.hasEnoughSpaceBelow(e)){const t=this.y;this.y+=e,this.isStuck()&&(this.y=t,this.slamToFloor(),this.needsToDie=!0)}else this.slamToFloor(),this.needsToDie=!0;else this.isOnGround()?this.y=this.getIntY():this.hasEnoughSpaceBelow(e)?this.y+=Math.min(e,this.getDropDistance(e+1)):this.slamToFloor();this.getIntY()>Math.floor(this.lastY)&&(this.isOnGround()&&s.add("pieceLand"),this.needsRedrawing(),this.lastAction="fall")}resetLockDelay(){this.resetLockDelayResets(),this.lockDelayAccum=0}resetLockDelayResets(){this.movementsAccum=0,this.rotationsAccum=0,this.movementsAccommodated=0,this.rotationsAccommodated=0}doLockDelay(t){var e;this.getIntY()+(null===(e=this.polyomino)||void 0===e?void 0:e.getVisualData().endY)>Math.floor(this.lowestY)&&(this.rule.resetLockDelayByFalling&&(this.lockDelayAccum=0),this.rule.resetResetsByFalling&&this.resetLockDelayResets()),this.isOnGround()&&(this.lockDelayAccum+=t,this.needsRedrawing()),this.hasExhaustedResets()&&"disable-resets"===this.rule.resetExpirationPenalty||(this.rule.resetLockDelayByMoving&&this.movementsAccum>this.movementsAccommodated&&(this.movementsAccommodated=this.movementsAccum,this.lockDelayAccum=0,this.needsRedrawing()),this.rule.resetLockDelayByRotating&&this.rotationsAccum>this.rotationsAccommodated&&(this.rotationsAccommodated=this.rotationsAccum,this.lockDelayAccum=0,this.needsRedrawing()))}getMoveResets(){return this.movementsAccum}getRotationResets(){return this.rotationsAccum}hasExhaustedResets(){return!!(this.rule.moveAndRotateResetsAreShared&&this.movementsAccum+this.rotationsAccum>=Math.min(this.rule.moveResets,this.rule.rotationResets)&&this.rule.resetLockDelayByMoving&&this.rule.resetLockDelayByRotating)||!(!(()=>this.movementsAccum>=this.rule.moveResets&&this.rule.resetLockDelayByMoving)()&&!(()=>this.rotationsAccum>=this.rule.rotationResets&&this.rule.resetLockDelayByRotating)())}lockDelayHasExpired(){return"retro"===this.rule.lockDelayType?this.needsToDie:!("limited"!==this.rule.lockDelayType||!this.isOnGround()||!this.hasExhaustedResets()||"instant-lock"!==this.rule.resetExpirationPenalty)||this.lockDelayAccum>=this.rule.lockDelay&&this.isOnGround()}getLockDelayAccumulated(){return this.lockDelayAccum}hasPolyomino(){return null!=this.polyomino}isAboveSkyline(){return this.y+this.polyomino.getVisualData().endY<this.matrix.getHiddenHeight()}isPartiallyAboveSkyline(){return this.y+this.polyomino.getVisualData().endY<this.matrix.getHiddenHeight()}getIntY(){return Math.floor(this.y)}getVisibleY(){return this.getIntY()-this.matrix.getHiddenHeight()}hasEnoughSpaceBelow(t){return t<1||this.getDropDistance(t)===Math.floor(t)}getDropDistance(t){if(this.isStuck()||this.isDead())return 0;let e;for(e=1;e<=t;e++)if(this.collidesWith(0,e))return e-1;return e-1}getDistanceToFloor(){return this.getDropDistance(this.matrix.getHeight()+Math.abs(this.getIntY()))}slamToFloor(){if(this.isDead())return;const t=this.getDistanceToFloor();this.y+=t,t>0&&(this.lastAction="fall")}getFallSpeed(){if(this.inSoftDrop)switch(this.rule.softDropType){case"multiplicative":return this.fallSpeed/this.rule.softDropSpeed;case"additive":return this.fallSpeed+this.rule.softDropSpeed;case"absolute":return Math.min(this.fallSpeed,this.rule.softDropSpeed);default:throw new Error("Unhandled soft drop type")}return this.fallSpeed}setFallSpeedAsMsPerLine(t){this.fallSpeed=t}setFallSpeedAsG(t){this.fallSpeed=1/t/60*1e3}setFallSpeedTo20G(){this.fallSpeed=.09}is20G(){return this.fallSpeed<.1}sendToHoldQueue(t){this.rule.holdResetsPieceOrientation&&this.polyomino.setOrientation(this.rule.rotationSystem.initialOrientation[this.polyomino.getShape()]),t.setPolyomino(this.polyomino),this.polyomino=null}swapWithHoldQueue(t){const e=t.getPolyomino();this.sendToHoldQueue(t),this.init(e)}getPolyominoShape(){return this.polyomino.getShape()}getHardDropLineClearRows(){const t=this.matrix.getGridWithPolyomino(this.x,this.getIntY()+this.getDistanceToFloor(),this.polyomino);return this.matrix.getFilledRows(t)}getDrawData(){if(null==this.polyomino)return[];const t=[],e=this.polyomino.getMonominos();for(let n=0;n<this.polyomino.getTotalMonominos();n++)this.rule.allowsGhost&&t.push({x:this.x+this.polyomino.getCurrentCoordinates()[n].x,y:this.getVisibleY()+this.polyomino.getCurrentCoordinates()[n].y+this.getDistanceToFloor(),color:e[n].getColor(),shape:e[n].getShape(),isGhost:!0,skin:e[n].getSkin()}),t.push({x:this.x+this.polyomino.getCurrentCoordinates()[n].x,y:this.getVisibleY()+this.polyomino.getCurrentCoordinates()[n].y,shape:e[n].getShape(),color:e[n].getColor(),skin:e[n].getSkin()});return t}}class bt{constructor({rule:t,mode:e}){this.queue=[],this.lastPolyominoes=[],this.rule=t,this.mode=e;for(let e=0;e<t.maxPiecePreviews;e++)this.addPolyominoFromRandomizer()}addPolyominoFromRandomizer(){this.rule.randomizer.setPolyominoSet(this.mode.polyominoSet);const t=new vt({shape:this.rule.randomizer.getNextPolyomino()});t.assignDefaultsFromRule(this.rule),this.queue.push(t)}shiftNextPolyomino(){const t=this.queue.shift();return this.queue.length<Math.max(1,this.rule.maxPiecePreviews)&&this.addPolyominoFromRandomizer(),t}getNextPolyomino(){return this.queue[0]}swapFirstPolyominoWithHold(t){const e=t.getPolyomino();t.setPolyomino(this.queue[0]),this.queue[0]=e}reassignPolyominoDefaults(){for(const t of this.queue)t.assignDefaultsFromRule(this.rule)}updateDirtyLasts(){this.lastPolyominoes=[...this.queue]}forceDirty(){this.lastPolyominoes=[null]}isDirty(){for(let t=0;t<this.queue.length;t++)if(this.lastPolyominoes[t]!==this.queue[t])return!0;return!1}getDrawInfo(){const t=[],e=this.rule.maxPiecePreviews;this.populateQueue();for(let n=0;n<e;n++){const e=this.queue[n],r=e.getMonominos(),o=[];for(let t=0;t<e.getTotalMonominos();t++){const n=r[t];o.push({x:e.getCoordinates(this.rule.rotationSystem.initialOrientation[e.getShape()])[t].x,y:e.getCoordinates(this.rule.rotationSystem.initialOrientation[e.getShape()])[t].y,color:n.getColor(),shape:n.getShape(),orientation:e.getOrientation(),skin:n.getSkin()})}t.push(o)}return t}populateQueue(){for(;this.queue.length<this.rule.maxPiecePreviews;)this.addPolyominoFromRandomizer()}}bt.INIT_SIZE=9;class wt{constructor({rule:t}){this.rule=t,this.polyomino=null}setPolyomino(t){this.polyomino=t}getPolyomino(){return this.polyomino}updateDirtyLasts(){this.lastPolyomino=this.polyomino}isDirty(){return this.polyomino!==this.lastPolyomino}forceDirty(){this.lastPolyomino=null}getDrawInfo(){if(null==this.polyomino)return[];const t=this.polyomino.getMonominos(),e=[];for(let n=0;n<this.polyomino.getTotalMonominos();n++){const r=t[n];e.push({x:this.polyomino.getCurrentCoordinates()[n].x,y:this.polyomino.getCurrentCoordinates()[n].y,color:r.getColor(),shape:r.getShape(),orientation:this.polyomino.getOrientation(),skin:r.getSkin()})}return e}reassignPolyominoDefaults(){var t;null===(t=this.polyomino)||void 0===t||t.assignDefaultsFromRule(this.rule)}}class kt{constructor(t){this.lineClearAmount=0,this.hasYetToCollapseRows=!1,this.softDropIsDown=!1,this.entryDelayAccum=0,this.hasBufferedHold=!1,this.bufferedRotateDirection=null,this.bufferedMoveDirection="none",this.hasExhaustedResetsThisTick=!1,this.holdIsLocked=!1,this.combo=-1,this.b2b=-1,this.readyTime=1500,this.renderActionList=[],this.stats={linesCleared:0,polyominoesPlaced:0,scoreAccumulated:0},this.waitingOnReady=!0,this.mode=new t,this.rule=new this.mode.Rule,this.rule.randomizer.setPolyominoSet(this.mode.polyominoSet),this.nextQueue=new bt({rule:this.rule,mode:this.mode}),this.holdQueue=new wt({rule:this.rule}),this.matrix=new mt({rule:this.rule}),this.polyominoController=new xt({matrix:this.matrix,rule:this.rule,mode:this.mode}),this.resetStandardAutoshiftVars(),this.resetRetroAutoshiftVars(),this.shiftDirection="none"}getAutoshiftDelay(){return Math.max(this.rule.minAutoshiftDelay,Math.min(this.rule.maxAutoshiftDelay,it.config.autoshiftDelay))}getAutoshiftRate(){return Math.max(this.rule.minAutoshiftRate,Math.min(this.rule.maxAutoshiftRate,it.config.autoshiftRate))}resetStandardAutoshiftVars(){this.autoshiftDelayAccum=0,this.autoshiftRateAccum=this.getAutoshiftRate(),this.hasReleasedShift=!0}resetRetroAutoshiftVars(){this.softDropIsDown||(this.autoshiftAccum=0,this.hasReleasedShift=!0,this.wallCharge=!1)}doStartOfTick(t){if(this.mode.onStartOfTickBegin(this),"gameOver"!==this.state){if("playing"===this.state&&this.polyominoController.doGravity(t),"entryDelay"===this.state){if(this.entryDelayAccum+=t,this.lineClearAmount&&this.entryDelayAccum>this.rule.lineClearDelay&&this.hasYetToCollapseRows&&(this.matrix.collapseRowsMarkedForDeath()&&s.add("collapse"),this.hasYetToCollapseRows=!1),!(this.entryDelayAccum>=this.getEntryDelay()))return;if(this.waitingOnReady&&(this.renderActionList.push(["spawnFirstPiece",null]),s.add("start"),this.waitingOnReady=!1),this.hasBufferedHold&&(null==this.holdQueue.getPolyomino()?this.holdQueue.setPolyomino(this.nextQueue.shiftNextPolyomino()):this.nextQueue.swapFirstPolyominoWithHold(this.holdQueue),s.add("bufferedHold"),this.holdIsLocked=!0),null!=this.bufferedRotateDirection){const t=this.nextQueue.getNextPolyomino(),e=(t.getOrientation()+this.bufferedRotateDirection)%4;t.setOrientation(e),s.add("bufferedRotate"),this.bufferedRotateDirection=null}if(this.polyominoController.init(this.nextQueue.shiftNextPolyomino()),this.hasBufferedHold?this.hasBufferedHold=!1:this.holdIsLocked=!1,"left"===this.bufferedMoveDirection?(this.polyominoController.shiftLeft(),this.bufferedMoveDirection="none"):"right"===this.bufferedMoveDirection&&(this.polyominoController.shiftRight(),this.bufferedMoveDirection="none"),this.rule.softDropCarriesBetweenPieces||(this.polyominoController.inSoftDrop=!1),this.polyominoController.isStuck())return void this.end("blockOut");this.state="playing",this.mode.onNewPolyomino(this)}this.hasExhaustedResetsThisTick=this.polyominoController.hasExhaustedResets(),this.polyominoController.lockDelayHasExpired()&&(s.add("lockWithoutHardDrop"),this.lockdown()),this.mode.onStartOfTickEnd(this)}}doEndOfTick(t){this.mode.onEndOfTickBegin(this),"gameOver"!==this.state&&"entryDelay"!==this.state&&(this.polyominoController.doLockDelay(t),this.polyominoController.is20G()&&!this.rule.suspendPieceUntilAction&&this.polyominoController.slamToFloor(),this.polyominoController.hasExhaustedResets()&&!this.hasExhaustedResetsThisTick&&s.add("outOfResets"),this.polyominoController.lockDelayHasExpired()&&(s.add("lockWithoutHardDrop"),this.lockdown()),this.polyominoController.updateLowestAndLastY(),this.mode.onEndOfTickEnd(this))}lockdown(){s.add("lock"),this.entryDelayAccum=0,this.stats.polyominoesPlaced++;let t=!1;(this.rule.hasLockOut||this.rule.hasPartialLockOut)&&(this.rule.hasPartialLockOut&&this.polyominoController.isPartiallyAboveSkyline()&&(t=!0),this.polyominoController.isAboveSkyline()&&(t=!0));const e=this.polyominoController.checkIfSpin();if(this.polyominoController.lockdown(),t)return void this.end("lockOut");this.state="entryDelay",this.matrix.markFilledRowsForDeath(),this.matrix.killRowsMarkedForDeath(),this.matrix.isEmpty()&&s.add("perfectClear"),this.lineClearAmount=this.matrix.getRowsMarkedForDeath().length,this.stats.linesCleared+=this.lineClearAmount;let n=[];if(this.lineClearAmount>3||e.isSpin&&this.lineClearAmount>0?(this.b2b++,this.b2b>0?s.add("b2bContinue"):s.add("b2bStart")):this.lineClearAmount>0&&(this.b2b>0&&s.add("b2bEnd"),this.b2b=-1),n=this.b2b>0?e.isSpin?e.isMini?["tSpinMini0","tSpinMini1b2b","tSpinMini2b2b",null,null]:["tSpin0","tSpin1b2b","tSpin2b2b","tSpin3b2b",null]:[null,"erase1","erase2","erase3","erase4b2b"]:e.isSpin?e.isMini?["tSpinMini0","tSpinMini1","tSpinMini2",null,null]:["tSpin0","tSpin1","tSpin2","tSpin3",null]:[null,"erase1","erase2","erase3","erase4"],this.lineClearAmount>0){if(this.combo++,this.combo>0)if(this.combo>20)s.add("combo20");else{const t=`combo${this.combo}`;s.add(t)}}else this.combo=-1;null!=n[this.lineClearAmount]&&s.add(n[this.lineClearAmount]),this.rule.lineClearDelay<=0&&this.matrix.collapseRowsMarkedForDeath(),this.hasYetToCollapseRows=!0,this.mode.onLockdown(this)}getEntryDelay(){return this.waitingOnReady?this.readyTime:0===this.lineClearAmount?this.rule.entryDelay:this.rule.lineClearDelay+this.rule.entryDelayOnLineClear}getEntryDelayAccum(){return this.entryDelayAccum}doHardDrop(){"gameOver"!==this.state&&(this.polyominoController.isDead()||this.rule.allowsHardDrop&&(s.add("pieceHardDrop"),this.polyominoController.slamToFloor(),this.rule.hardDropLocksPieceInstantly&&this.lockdown()))}onHardDropPress(){this.doHardDrop()}onHardDropRelease(){"gameOver"!==this.state&&this.polyominoController.isDead()}onHardDropDown(){this.rule.hardDropExecutesOnlyOncePerPress||this.doHardDrop()}onSoftDropPress(){this.softDropIsDown=!0,"gameOver"!==this.state&&("retro"===this.rule.autoshiftType&&"none"!==this.shiftDirection||(this.rule.allowsSoftDrop?this.polyominoController.inSoftDrop=!0:this.polyominoController.inSoftDrop=!1))}onSoftDropRelease(){this.softDropIsDown=!1,"gameOver"!==this.state&&(this.polyominoController.inSoftDrop=!1)}onSoftDropDown(){this.rule.softDropLocksPieceInstantly&&this.polyominoController.isOnGround()&&(s.add("lockWithoutHardDrop"),this.lockdown())}onHoldPress(){if("gameOver"!==this.state&&this.rule.allowsHold)return"entryDelay"===this.state?(this.rule.allowsHoldBuffering&&(this.hasBufferedHold=!0),void(this.rule.skipEntryDelayOnHold&&!this.waitingOnReady&&(this.entryDelayAccum=this.getEntryDelay(),this.hasBufferedHold=!0))):void(this.holdIsLocked||(null==this.holdQueue.getPolyomino()?(this.polyominoController.sendToHoldQueue(this.holdQueue),this.polyominoController.init(this.nextQueue.shiftNextPolyomino())):(this.polyominoController.swapWithHoldQueue(this.holdQueue),this.polyominoController.isStuck()&&this.end("blockOut")),s.add("pieceHold"),this.holdIsLocked=!0))}applyRotationBuffer(t){this.rule.skipEntryDelayOnRotate&&!this.waitingOnReady&&(this.entryDelayAccum=this.getEntryDelay()),(this.rule.allowsRotateBuffering||this.rule.skipEntryDelayOnRotate)&&(this.bufferedRotateDirection=t)}onRotateLeft(){"gameOver"!==this.state&&this.rule.allowsRotateLeft&&("entryDelay"!==this.state?this.polyominoController.rotate(3):this.applyRotationBuffer(3))}onRotateRight(){"gameOver"!==this.state&&this.rule.allowsRotateRight&&("entryDelay"!==this.state?this.polyominoController.rotate(1):this.applyRotationBuffer(1))}onRotate180(){"gameOver"!==this.state&&this.rule.allowsRotate180&&("entryDelay"!==this.state?this.polyominoController.rotate(2):this.applyRotationBuffer(2))}setDirection({leftPressedAmount:t,rightPressedAmount:e,hasRightReleased:n,isLeftDown:r,hasLeftReleased:o,isRightDown:i,resetShiftOnFullRelease:s,resetVariableMethod:a}){return t>e?(a(),this.shiftDirection="left"):e&&(a(),this.shiftDirection="right"),"right"===this.shiftDirection&&n&&r?(a(),this.shiftDirection="left",t=1):"left"===this.shiftDirection&&o&&i?(a(),this.shiftDirection="right",e=1):n&&r?this.shiftDirection="left":o&&i?this.shiftDirection="right":(o||n)&&(s&&a(),this.shiftDirection="none"),{left:t,right:e}}updateShift({leftPressedAmount:t=0,rightPressedAmount:e=0,hasLeftReleased:n=!1,hasRightReleased:r=!1,isLeftDown:o=!1,isRightDown:i=!1,msPassed:s}){if("gameOver"!==this.state)switch(this.rule.autoshiftType){case"standard":{if(this.polyominoController.isStuck())return;const a=this.setDirection({leftPressedAmount:t,rightPressedAmount:e,hasRightReleased:r,isLeftDown:o,hasLeftReleased:n,isRightDown:i,resetShiftOnFullRelease:!0,resetVariableMethod:this.resetStandardAutoshiftVars.bind(this)});if(t=a.left,e=a.right,"off"===it.config.autoshiftBuffering&&"entryDelay"===this.state)return;if("none"!==this.shiftDirection){"instant"!==it.config.autoshiftBuffering||"entryDelay"!==this.state||this.rule.skipEntryDelayOnMove||(this.autoshiftDelayAccum=this.getAutoshiftDelay());const n="left"===this.shiftDirection?this.polyominoController.shiftLeft.bind(this.polyominoController):this.polyominoController.shiftRight.bind(this.polyominoController);if(this.hasReleasedShift){const r="left"===this.shiftDirection?t:e;for(let t=0;t<r;t++)n();this.rule.skipEntryDelayOnMove&&!this.waitingOnReady&&"entryDelay"===this.state&&(this.entryDelayAccum=this.getEntryDelay(),this.bufferedMoveDirection=this.shiftDirection),this.hasReleasedShift=!1}else if(this.autoshiftDelayAccum<this.getAutoshiftDelay())this.autoshiftDelayAccum+=s;else if(this.autoshiftDelayAccum>=this.getAutoshiftDelay()){if(this.getAutoshiftRate()<=0){let t=0;for(;"left"===this.shiftDirection?this.polyominoController.canShiftLeft():this.polyominoController.canShiftRight();){if(t>this.matrix.getWidth())throw new Error("There is a problem with polyomino collision checks.");n(),this.polyominoController.is20G()&&this.polyominoController.slamToFloor(),t++}}else for(;this.autoshiftRateAccum>=this.getAutoshiftRate();)n(),this.polyominoController.is20G()&&this.polyominoController.slamToFloor(),this.autoshiftRateAccum-=this.getAutoshiftRate();this.autoshiftRateAccum+=s}}break}case"retro":if(this.polyominoController.isStuck())return;if("entryDelay"===this.state)return void(o?(this.hasReleasedShift=!1,this.shiftDirection="left"):i?(this.hasReleasedShift=!1,this.shiftDirection="right"):this.shiftDirection="none");if(this.setDirection({leftPressedAmount:t,rightPressedAmount:e,hasRightReleased:r,isLeftDown:o,hasLeftReleased:n,isRightDown:i,resetShiftOnFullRelease:!1,resetVariableMethod:this.resetRetroAutoshiftVars.bind(this)}),(o&&!this.polyominoController.canShiftLeft()||i&&!this.polyominoController.canShiftRight())&&(this.wallCharge=!0),"none"!==this.shiftDirection&&!this.softDropIsDown){const t="left"===this.shiftDirection?this.polyominoController.shiftLeft.bind(this.polyominoController):this.polyominoController.shiftRight.bind(this.polyominoController);for(this.hasReleasedShift||this.wallCharge?(t(),this.hasReleasedShift=!1,("left"===this.shiftDirection?this.polyominoController.canShiftLeft():this.polyominoController.canShiftRight())&&(this.wallCharge=!1)):this.autoshiftAccum<this.getAutoshiftDelay()&&(this.autoshiftAccum+=s);this.autoshiftAccum>=this.getAutoshiftDelay();)t(),this.autoshiftAccum-=this.getAutoshiftRate()}break;default:throw new Error(`Unhandled autoshift type: ${this.rule.autoshiftType}`)}}start(){s.add("ready"),this.state="entryDelay",this.mode.onGameStart(this),this.renderActionList.push(["start",null])}end(t){switch(this.state="gameOver",t){case"cleared":s.add("gameVictory");break;default:s.add("gameDeath")}this.renderActionList.push(["end",[t]])}getStats(){return this.stats}getState(){return this.state}getPolyominoController(){return this.polyominoController}getMatrix(){return this.matrix}getNextQueue(){return this.nextQueue}getHoldQueue(){return this.holdQueue}getHoldLockedState(){return this.holdIsLocked}getControllerDrawInfo(){return this.polyominoController.getDrawData()}getControllerDirtyState(){return this.polyominoController.isDirty()}hadControllerDrawn(){this.polyominoController.wasDrawn()}getControllerLockDelay(){return this.polyominoController.getLockDelayAccumulated()}getHardDropLineClearRows(){return this.polyominoController.getHardDropLineClearRows()}getMatrixDrawInfo(){return this.matrix.getDrawData()}getMatrixHiddenHeight(){return this.matrix.getHiddenHeight()}getNextDrawInfo(){return this.nextQueue.getDrawInfo()}getHoldDrawInfo(){return this.holdQueue.getDrawInfo()}}class St{constructor(t){this.text=t}getText(){return this.text}choose(){}}class At{constructor(){this.isPaused=!1,this.pauseSelection=null,this.hasQuit=!1,this.pauseMenuButtons=[],this.pauseMenuButtons[0]=new St(X.t("gameUi:continue")),this.pauseMenuButtons[0].choose=()=>{this.engine.updateShift({msPassed:1,hasLeftReleased:!0,hasRightReleased:!0}),s.add("menuConfirm",s.soundbanks.system),this.isPaused=!1},this.pauseMenuButtons[1]=new St(X.t("gameUi:retry")),this.pauseMenuButtons[1].choose=()=>{this.isPaused&&(this.isPaused=!1),s.add("menuChoose",s.soundbanks.system),this.engine=new kt(this.Mode),this.engine.start()},this.pauseMenuButtons[2]=new St(X.t("gameUi:quit")),this.pauseMenuButtons[2].choose=()=>{s.add("menuBack",s.soundbanks.system),this.hasQuit=!0}}init(t){this.Mode=t,this.engine=new kt(this.Mode)}doTick(t){if(!this.hasQuit){if(st.getGamePress("retry"))return this.isPaused&&(this.isPaused=!1),this.engine=new kt(this.Mode),void this.engine.start();if("gameOver"!==this.engine.getState()){if(this.isPaused)return st.getGamePress("menuDown")?(s.add("menuSelect",s.soundbanks.system),this.pauseSelection=this.pauseMenuButtons[(this.pauseMenuButtons.indexOf(this.pauseSelection)+1)%this.pauseMenuButtons.length]):st.getGamePress("menuUp")&&(s.add("menuSelect",s.soundbanks.system),this.pauseSelection=this.pauseMenuButtons[(this.pauseMenuButtons.indexOf(this.pauseSelection)+this.pauseMenuButtons.length-1)%this.pauseMenuButtons.length]),st.getGamePress("pause")?(this.engine.updateShift({msPassed:1,hasLeftReleased:!0,hasRightReleased:!0}),s.add("unpause"),void(this.isPaused=!1)):void(st.getGamePress("menuSelect")&&this.pauseSelection.choose());if(st.getGamePress("pause"))return s.add("pause"),this.pauseSelection=this.pauseMenuButtons[0],void(this.isPaused=!0);this.engine.doStartOfTick(t);for(let t=0;t<st.getGamePressAsNum("rotateLeft");t++)this.engine.onRotateLeft();for(let t=0;t<st.getGamePressAsNum("rotateRight");t++)this.engine.onRotateRight();for(let t=0;t<st.getGamePressAsNum("rotate180");t++)this.engine.onRotate180();this.engine.updateShift({msPassed:t,leftPressedAmount:st.getGamePressAsNum("shiftLeft"),rightPressedAmount:st.getGamePressAsNum("shiftRight"),isLeftDown:st.getGameDown("shiftLeft"),isRightDown:st.getGameDown("shiftRight"),hasLeftReleased:st.getGameRelease("shiftLeft"),hasRightReleased:st.getGameRelease("shiftRight")}),st.getGamePress("softDrop")&&this.engine.onSoftDropPress(),st.getGameRelease("softDrop")&&this.engine.onSoftDropRelease(),st.getGameDown("softDrop")&&this.engine.onSoftDropDown(),st.getGamePress("hardDrop")&&this.engine.onHardDropPress(),st.getGameRelease("hardDrop")&&this.engine.onHardDropRelease(),st.getGameDown("hardDrop")&&this.engine.onHardDropDown(),st.getGamePress("hold")&&this.engine.onHoldPress(),this.engine.doEndOfTick(t)}}}}class Dt{constructor(){this.path="abstract",this.gutterWidth=3,this.resolution=144}getUrl(){return`./res/img/skin/hyper/${this.path}.png`}getCoordinates(t){const{x:e,y:n}=t.holdIsLocked?this.assignments[t.color].holdLocked:this.assignments[t.color].regular;return{x:this.gutterWidth+e*this.resolution+e*this.gutterWidth*2,y:this.gutterWidth+n*this.resolution+n*this.gutterWidth*2}}getResolution(){return this.resolution}}class Ct extends Dt{constructor(){super(...arguments),this.assignments={red:{regular:{x:0,y:0},holdLocked:{x:4,y:1}},orange:{regular:{x:1,y:0},holdLocked:{x:4,y:1}},yellow:{regular:{x:2,y:0},holdLocked:{x:4,y:1}},green:{regular:{x:3,y:0},holdLocked:{x:4,y:1}},lightBlue:{regular:{x:4,y:0},holdLocked:{x:4,y:1}},blue:{regular:{x:5,y:0},holdLocked:{x:4,y:1}},purple:{regular:{x:6,y:0},holdLocked:{x:4,y:1}},white:{regular:{x:0,y:1},holdLocked:{x:4,y:1}},gray:{regular:{x:1,y:1},holdLocked:{x:4,y:1}},black:{regular:{x:2,y:1},holdLocked:{x:4,y:1}},bone:{regular:{x:3,y:1},holdLocked:{x:5,y:1}}}}}class Lt extends Ct{constructor(){super(...arguments),this.path="srs-x"}}class Rt{constructor(t){this.canvas=t,this.ctx=lt(t)}draw(t,e,n){if(ct(this.ctx),"retro"===t.rule.lockDelayType)return;const r=this.canvas.clientWidth,o=this.canvas.clientHeight,i=t.getPolyominoController().getMoveResets(),s=t.getPolyominoController().getRotationResets();if((t.rule.resetLockDelayByMoving||t.rule.resetLockDelayByRotating)&&t.rule.moveAndRotateResetsAreShared){const e=Math.min(t.rule.moveResets,t.rule.rotationResets),n=o/2,a=r/40,u=r/e-a,l=u+a+a/(e-1);for(let r=0;r<e;r++)this.ctx.fillStyle="#ffffff",(r>=e-(i+s)||!t.getPolyominoController().hasPolyomino())&&(this.ctx.fillStyle="#ffffff25"),this.ctx.fillRect(Math.floor(r*l),0,Math.floor(u),Math.floor(n))}const a=t.rule.resetLockDelayByMoving||t.rule.resetLockDelayByRotating?o/3*2:0,u=o/3;if(t.getPolyominoController().hasExhaustedResets()){this.ctx.fillStyle="#000",this.ctx.fillRect(0,Math.floor(a),r,Math.floor(u));const t=_t(n),o=("0"+Math.floor(255*(1-e%t/t)).toString(16)).slice(-2);this.ctx.fillStyle=`#ff0000${o}`,this.ctx.fillRect(0,Math.floor(a),r,u)}else this.ctx.fillStyle="#ffffff25",this.ctx.fillRect(0,Math.floor(a),r,Math.floor(u)),t.getPolyominoController().hasPolyomino()?(this.ctx.fillStyle="#ffffff",this.ctx.fillRect(0,Math.floor(a),(1-t.getControllerLockDelay()/t.rule.lockDelay)*r,Math.floor(u))):(this.ctx.fillStyle="#ffffff99",this.ctx.fillRect(0,Math.floor(a),t.getEntryDelayAccum()/t.getEntryDelay()*r,Math.floor(u)))}}class Tt extends pt{constructor(t){super(),this.pauseOptions=[],this.statElements={},this.skin=new Lt,this.lastControllerData={},this.lastMatrixData={},this.hardDropLineClearRows=[],this.accum=0,this.accum60check=0,this.lastHoldLocked=!1,this.initialWait=0,this.nextQueueToAnimate=-5,this.lastHoldAllowed=!0,this.containerDiv=document.createElement("div"),this.containerDiv.classList.add("game-container"),this.pauseMenuContainer=document.createElement("div"),this.pauseMenuContainer.classList.add("pause-menu-container","hidden"),this.gameOverContainer=document.createElement("div"),this.gameOverContainer.classList.add("game-over-container","hidden"),this.gameDiv=this.makeDiv(["game"],this.containerDiv),this.leftDiv=this.makeDiv(["game-left"],this.gameDiv),this.centerDiv=this.makeDiv(["game-center"],this.gameDiv),this.rightDiv=this.makeDiv(["game-right"],this.gameDiv),this.backgroundCanvas=this.makeCanvas(["game-background-canvas"],this.centerDiv),this.backgroundCtx=lt(this.backgroundCanvas),this.matrixCanvas=this.makeCanvas(["game-canvas"],this.centerDiv),this.matrixCtx=lt(this.matrixCanvas),this.controllerCanvas=this.makeCanvas(["game-canvas"],this.centerDiv),this.controllerCtx=lt(this.controllerCanvas),this.controllerCanvas.classList.add("pulse"),this.lockdownBarCanvas=this.makeCanvas(["lockdown-bar-canvas"],this.centerDiv),this.nextContainer=this.makeDiv(["next-container"],this.rightDiv),this.nextLabel=this.makeParagraph(["next-label"],this.nextContainer),this.nextCanvas=this.makeCanvas(["next-canvas"],this.nextContainer),this.nextCtx=lt(this.nextCanvas),this.holdContainer=this.makeDiv(["hold-container"],this.leftDiv),this.holdLabel=this.makeParagraph(["hold-label"],this.holdContainer),this.holdCanvas=this.makeCanvas(["hold-canvas"],this.holdContainer),this.holdCtx=lt(this.holdCanvas),this.statContainer=this.makeDiv(["stat-container"],this.leftDiv),this.modeNameLabel=this.makeDiv(["game-mode-label"],this.centerDiv),this.readyGoMessageDiv=this.makeDiv(["ready-go-message"],this.centerDiv),this.pauseText=this.makeDiv(["pause-text"],this.pauseMenuContainer),this.pauseText.textContent=X.t("gameUi:pause"),this.optionsContainer=this.makeUl(["options-list"],this.pauseMenuContainer),this.gameOverText=this.makeDiv(["game-over-text"],this.gameOverContainer),this.manager=new At,this.manager.init(t);for(const t of this.manager.pauseMenuButtons)t.element=this.makeLi([],this.optionsContainer),t.element.textContent=t.getText(),t.element.onclick=()=>{this.manager.isPaused&&(this.manager.hasQuit||t.choose())},t.element.onmouseenter=()=>{this.manager.isPaused&&(this.manager.hasQuit||this.manager.pauseSelection!==t&&(this.manager.pauseSelection=t,s.add("menuSelect",s.soundbanks.system)))};this.lockdownBar=new Rt(this.lockdownBarCanvas),this.createStatContainer(),this.width=this.manager.engine.getMatrix().getWidth(),this.height=this.manager.engine.getMatrix().getVisibleHeight(),this.manager.engine.start(),this.centerDiv.classList.add("board-entrance-animation"),this.leftDiv.classList.add("queue-entrance-animation"),this.rightDiv.classList.add("queue-entrance-animation"),this.bpm=140}doLogicTick(t){this.manager.doTick(t)}handleActions(){const{engine:t}=this.manager;for(const e of t.renderActionList)switch(e[0]){case"start":{this.gameOverContainer.classList.add("hidden"),this.containerDiv.classList.remove("game-over");let t=X.t("gameUi:ready");const e=.05;let n=-e;const r=t.replace(/\S/g,(t=>(n+=e,`<span class="ready-animation-letter" style="--animation-delay: ${n}s;">`+t+"</span>")));t=r,this.readyGoMessageDiv.innerHTML=r,this.readyGoMessageDiv.classList.remove("start-animation"),dt(this.readyGoMessageDiv,"ready-animation");break}case"spawnFirstPiece":this.readyGoMessageDiv.innerHTML=X.t("gameUi:start"),this.readyGoMessageDiv.classList.remove("ready-animation"),dt(this.readyGoMessageDiv,"start-animation"),this.centerDiv.classList.remove("board-entrance-animation"),this.leftDiv.classList.remove("queue-entrance-animation"),this.rightDiv.classList.remove("queue-entrance-animation");break;case"end":{const t=e[1][0];this.containerDiv.classList.add("game-over");let n="";switch(t){case"blockOut":n=X.t("gameUi:blockOut");break;case"lockOut":n=X.t("gameUi:lockOut");break;case"topOut":n=X.t("gameUi:topOut");break;case"timeUp":n=X.t("gameUi:timeUp");break;case"cleared":n=X.t("gameUi:excellent")}this.gameOverText.innerHTML=X.t("gameUi:gameOver"),this.gameOverContainer.classList.remove("hidden");break}}t.renderActionList=[]}doDrawTick(t,e=!1){const{engine:n}=this.manager;if(this.handleActions(),this.manager.hasQuit){this.containerDiv.classList.add("quit"),this.pauseText.classList.add("quit");for(const t of this.manager.pauseMenuButtons)t.element.classList.add("quit");this.manager.pauseSelection.element.classList.add("quit-selection")}else if(this.manager.isPaused){this.containerDiv.classList.add("paused"),this.pauseMenuContainer.classList.remove("hidden");for(const t of this.manager.pauseMenuButtons)t.element.classList.remove("selected");this.manager.pauseSelection.element.classList.add("selected")}else{for(const t of this.manager.pauseMenuButtons)t.element.classList.remove("selected");this.containerDiv.classList.remove("paused"),this.pauseMenuContainer.classList.add("hidden")}this.accum+=t,this.accum60check+=t,this.accum60check>1e3/60&&(this.flickerAmount=Math.random()/2+.5,this.accum60check-=1e3/60);const r=this.getCellSize();n.getPolyominoController().checkIfSpin().isSpin?this.controllerCanvas.classList.add("tspin"):this.controllerCanvas.classList.remove("tspin"),(n.getPolyominoController().isDirty()||e)&&(this.hardDropLineClearRows=n.getPolyominoController().getHardDropLineClearRows(),this.drawController(n,r)),this.drawMatrix(n,r),(n.getNextQueue().isDirty()||e||this.nextQueueToAnimate<9)&&this.drawNext(n,r),(n.getHoldQueue().isDirty()||this.lastHoldLocked!==n.getHoldLockedState()||this.lastHoldAllowed!==n.rule.allowsHold||e)&&this.drawHold(n,r),this.lockdownBar.draw(n,this.accum,this.bpm),this.updateLasts(),this.updateStats()}drawMatrix(t,e){ct(this.matrixCtx);const n=this.hardDropLineClearRows,r=t.getMatrix().getDrawData();for(const o of r){if("invalid"===o.color)continue;this.drawMonomino(this.matrixCtx,o.color,o.skin,o.shape,o.x,o.y+Tt.BUFFER_PEEK,e);const r=o.x*e,i=(o.y+Tt.BUFFER_PEEK)*e;if(this.matrixCtx.globalCompositeOperation="multiply",this.matrixCtx.fillStyle="#0003",this.matrixCtx.fillRect(Math.floor(r),Math.floor(i),e,e),-1!==n.indexOf(o.y+t.getMatrix().getHiddenHeight())){const t=("0"+Math.floor(255*(1-(this.accum+(this.width-o.x)/this.width*_t(this.bpm))%_t(this.bpm)/_t(this.bpm))).toString(16)).slice(-2);this.matrixCtx.globalCompositeOperation="overlay",this.matrixCtx.fillStyle=`#ffffff${t}`,this.matrixCtx.fillRect(Math.floor(o.x*e),Math.floor((o.y+Tt.BUFFER_PEEK)*e),e,e),this.matrixCtx.globalCompositeOperation="source-over"}if(performance.now()-o.timeLocked<400){const t=("0"+Math.floor(255*(1-(performance.now()-o.timeLocked)/400)).toString(16)).slice(-2);this.matrixCtx.globalCompositeOperation="overlay",this.matrixCtx.fillStyle=`#ffffff${t}`,this.matrixCtx.fillRect(Math.floor(r),Math.floor(i),e,e),((t,n)=>{const s=(performance.now()-o.timeLocked+0)/200,a=(t=0)=>Math.min(Math.min(Math.max(Math.max(0,2*s-1+t),0),1)*e,e),u=(t=0)=>Math.min(e-Math.min(Math.max(Math.min(2*s+t,1),0),1)*e,e),l=a(-.2),c=u(-.2),h=a(.2),f=u(.2),d=Math.min(l,h),p=Math.min(c,f);this.matrixCtx.beginPath(),this.matrixCtx.moveTo(r+l,Math.floor(i+c)),this.matrixCtx.lineTo(r+e-c,Math.floor(i+e-l)),this.matrixCtx.lineTo(r+e-p,Math.floor(i+e-d)),this.matrixCtx.lineTo(r+e-f,Math.floor(i+e-h)),this.matrixCtx.lineTo(r+h,Math.floor(i+f)),this.matrixCtx.lineTo(r+d,Math.floor(i+p)),this.matrixCtx.fillStyle="#fff",this.matrixCtx.fill()})()}performance.now()-o.timeLocked<50&&(this.matrixCtx.globalCompositeOperation="source-atop",this.matrixCtx.fillStyle="#fff",this.matrixCtx.fillRect(Math.floor(r),Math.floor(i),e,e),this.matrixCtx.globalCompositeOperation="source-over")}for(const n of t.getMatrix().getRowsMarkedForDeath()){const r=("0"+Math.floor((t.rule.lineClearDelay-t.getEntryDelayAccum())/t.rule.lineClearDelay*255).toString(16)).slice(-2);this.matrixCtx.fillStyle=`#ffffff${r}`,this.matrixCtx.fillRect(0,Math.floor((n-t.getMatrix().getHiddenHeight()+Tt.BUFFER_PEEK)*e),this.matrixCanvas.clientWidth,e)}if(t.getMatrix().isCloseToSkyline()&&t.rule.hasLockOut){this.matrixCtx.globalCompositeOperation="source-over";const t=Tt.BUFFER_PEEK*e+2;this.matrixCtx.globalAlpha=this.flickerAmount,this.matrixCtx.beginPath(),this.matrixCtx.moveTo(0,t),this.matrixCtx.lineTo(this.matrixCanvas.clientWidth,t),this.matrixCtx.strokeStyle="#f00",this.matrixCtx.lineWidth=4,this.matrixCtx.stroke(),this.matrixCtx.globalAlpha=1}const o=t.getPolyominoController().getDrawData();if(t.getHoldLockedState()){this.matrixCtx.globalAlpha=this.flickerAmount;for(const t of o){if(t.isGhost)continue;this.matrixCtx.globalCompositeOperation="source-over",this.matrixCtx.fillStyle="#ffff00";const[n,r]=[t.x*e,(t.y+Tt.BUFFER_PEEK)*e],o=e/16;this.matrixCtx.fillRect(n-o,r-o,e+2*o,e+2*o)}this.matrixCtx.globalAlpha=1}}drawController(t,e){ct(this.controllerCtx);const n=t.getPolyominoController().getLockDelayAccumulated();let r=("0"+Math.floor(n/t.rule.lockDelay*255).toString(16)).slice(-2);t.getPolyominoController().hasExhaustedResets()&&(r="ff");for(const n of t.getPolyominoController().getDrawData())n.isGhost?this.controllerCtx.globalAlpha=.5:this.controllerCtx.globalAlpha=1,this.drawMonomino(this.controllerCtx,n.color,n.skin,n.shape,n.x,n.y+Tt.BUFFER_PEEK,e),n.isGhost||"retro"===t.rule.lockDelayType||(this.controllerCtx.globalCompositeOperation="saturation",this.controllerCtx.fillStyle=`#000000${r}`,this.controllerCtx.fillRect(Math.floor(n.x*e),Math.floor((n.y+Tt.BUFFER_PEEK)*e),e,e));t.getPolyominoController().updateDirtyLasts()}drawHold(t,e){if(ct(this.holdCtx),t.rule.allowsHold){this.holdLabel.classList.remove("hidden");for(const n of t.getHoldQueue().getDrawInfo())"invalid"!==n.color&&this.drawMonomino(this.holdCtx,n.color,n.skin,n.shape,n.x+Tt.QUEUE_OFFSETS[n.shape][n.orientation].x,n.y+Tt.QUEUE_OFFSETS[n.shape][n.orientation].y,e,t.getHoldLockedState())}else this.holdLabel.classList.add("hidden");t.getHoldQueue().updateDirtyLasts()}drawNext(t,e){ct(this.nextCtx);const n=t.getNextQueue().getDrawInfo();for(let t=0;t<n.length&&!(t>this.nextQueueToAnimate);t++)for(const r of n[t])"invalid"!==r.color&&(0===t?this.drawMonomino(this.nextCtx,r.color,r.skin,r.shape,r.x+Tt.QUEUE_OFFSETS[r.shape][r.orientation].x,r.y+Tt.QUEUE_OFFSETS[r.shape][r.orientation].y,e):this.drawMonomino(this.nextCtx,r.color,r.skin,r.shape,r.x+Tt.QUEUE_OFFSETS[r.shape][r.orientation].x+2,r.y+Tt.QUEUE_OFFSETS[r.shape][r.orientation].y+4+4*t,e/2));this.nextQueueToAnimate<9&&(this.nextQueueToAnimate+=.25),t.getNextQueue().updateDirtyLasts()}updateStats(){for(const t of this.manager.engine.mode.getStatsToDraw()){const e=this.statElements[t.name];e.value.innerHTML!==t.value&&(""!==e.value.innerHTML&&dt(e.value,"stat-update"),e.value.innerHTML=t.value)}}createStatContainer(){this.statElements={};let t=.5;for(const e of this.manager.engine.mode.getStatsToDraw()){const n=document.createElement("div");n.classList.add("stat-group"),n.style.setProperty("--delay",`${t}s`),n.classList.add("stat-entrance-animation");const r=document.createElement("div");r.classList.add("label"),r.innerHTML=e.name,n.appendChild(r);const o=document.createElement("div");o.classList.add("value"),e.isLarge&&o.classList.add("large"),o.innerHTML=e.value,n.appendChild(o),this.statElements[e.name]={group:n,label:r,value:o},setTimeout((()=>{n.classList.remove("stat-entrance-animation")}),1e3*(t+.5)),t+=.25,this.statContainer.appendChild(n)}}drawMonomino(t,e,n,r,o,i,s,a){const u=n.skin.getCoordinates({color:e,holdIsLocked:a,shape:r,level:this.manager.engine.mode.getLevel()}),l=n.skin.getResolution();t.drawImage(n.img,u.x,u.y,l,l,o*s,Math.floor(i*s),s,s)}clearCell(t,e,n,r){t.clearRect(Math.floor(e*r),Math.floor(n*r),r,r)}construct(){ut.getRendererContainer().appendChild(this.gameOverContainer),ut.getRendererContainer().appendChild(this.pauseMenuContainer),ut.getRendererContainer().appendChild(this.containerDiv),this.onResize(),this.onResize()}onResize(){this.updateText();const t=document.documentElement;t.style.setProperty("--cell-size",`${this.getCellSize()}px`),t.style.setProperty("--matrix-width",this.width.toString()),t.style.setProperty("--matrix-height",this.height.toString()),t.style.setProperty("--peek-zone",Tt.BUFFER_PEEK.toString()),t.style.setProperty("--off-screen",Tt.OFF_SCREEN.toString()),t.style.setProperty("--bpm",this.bpm.toString());for(const t of[this.controllerCanvas,this.matrixCanvas,this.backgroundCanvas,this.nextCanvas,this.holdCanvas,this.lockdownBarCanvas])t.width=t.clientWidth,t.height=t.clientHeight;this.manager.engine.getPolyominoController().needsRedrawing(),this.drawBackground(),this.doDrawTick(0,!0)}getSkin(){return this.skin}makeElement(t,e){const n=document.createElement(e);for(const e of t)n.classList.add(e);return n}makeDiv(t,e){const n=this.makeElement(t,"div");return e.appendChild(n),n}makeCanvas(t,e){const n=this.makeElement(t,"canvas");return e.appendChild(n),n}makeParagraph(t,e){const n=this.makeElement(t,"p");return e.appendChild(n),n}makeUl(t,e){const n=this.makeElement(t,"ul");return e.appendChild(n),n}makeLi(t,e){const n=this.makeElement(t,"li");return e.appendChild(n),n}updateText(){const t=X.t("gameUi:next"),e=X.t("gameUi:hold");this.nextLabel.style.justifyContent=t.length<=5?"center":"flex-start",this.holdLabel.style.justifyContent=e.length<=5?"center":"flex-end",this.nextLabel.textContent=t,this.holdLabel.textContent=e,this.modeNameLabel.textContent=this.manager.engine.mode.getName()}getCellSize(){const t=(Math.max(this.leftDiv.offsetWidth,this.statContainer.offsetWidth)+this.centerDiv.offsetWidth+this.rightDiv.offsetWidth)/this.centerDiv.offsetHeight,e=Math.min(window.innerWidth/t,window.innerHeight);return Math.floor(e/1.2/this.height)}drawBackground(){const t=1/4,e=this.getCellSize(),n=this.backgroundCtx;n.strokeStyle="#ffffff7f",n.lineWidth=2;for(let r=0;r<=this.width;r++)for(let o=0;o<=this.height;o++)n.beginPath(),n.moveTo(r*e-e*t,o*e),n.lineTo(r*e+e*t,o*e),n.stroke(),n.beginPath(),n.moveTo(r*e,o*e-e*t),n.lineTo(r*e,o*e+e*t),n.stroke()}updateLasts(){this.lastHoldLocked=this.manager.engine.getHoldLockedState(),this.lastHoldAllowed=this.manager.engine.rule.allowsHold}}Tt.BUFFER_PEEK=4,Tt.OFF_SCREEN=1.75,Tt.QUEUE_OFFSETS={i:[{x:0,y:.5},{x:-.5,y:0},{x:0,y:-.5},{x:.5,y:0}],j:[{x:.5,y:1},{x:0,y:.5},{x:0,y:.5},{x:1,y:.5}],l:[{x:.5,y:1},{x:0,y:.5},{x:0,y:.5},{x:1,y:.5}],o:[{x:1,y:1},{x:1,y:1},{x:1,y:1},{x:1,y:1}],s:[{x:.5,y:1},{x:0,y:.5},{x:0,y:.5},{x:1,y:.5}],t:[{x:.5,y:1},{x:0,y:.5},{x:0,y:.5},{x:1,y:.5}],z:[{x:.5,y:1},{x:0,y:.5},{x:0,y:.5},{x:1,y:.5}]};class Ot{constructor(){this.spinPolyominoList=["t"],this.spinBonusType="threeCorner",this.hardDropRowBonus=2,this.softDropRowBonus=1}getLockdownScore({lineClearAmount:t,isSpin:e,isMini:n,levelMultiplier:r=1}){let o=0;return o+=[0,100,300,500,800][t=Math.min(4,t)],e&&(o+=[400,700,900,1100,1200][t]),n&&(o+=100),o*r}}class Pt{constructor({xOffset:t,yOffset:e,orientation:n,usedKick:r,mustUpgradeSpin:o}){this.mustUpgradeSpin=null!=o&&o,this.xOffset=t,this.yOffset=e,this.orientation=n,this.usedKick=r}getIsUpward(){return this.yOffset<0}}class Mt{getKickTable({shape:t,rotateDirection:e,oldOrientation:n}){switch(t){case"i":switch(e){case 3:return Mt.LEFT_I_KICKS[n];case 1:return Mt.RIGHT_I_KICKS[n];case 2:return Mt.DOUBLE_I_KICKS[n];default:throw new Error("Rotation direction unhandled in kick table retrieval")}case"j":case"l":case"s":case"t":case"z":switch(e){case 3:return Mt.LEFT_X_KICKS[n];case 1:return Mt.RIGHT_X_KICKS[n];case 2:return Mt.DOUBLE_X_KICKS[n];default:throw new Error("Rotation direction unhandled in kick table retrieval")}default:return null}}executeWallkick({xOffset:t,yOffset:e,polyominoController:n,rotateDirection:r,oldOrientation:o,newOrientation:i,allowFloorKicks:s}){if(!n.collidesWith(t,e,i))return new Pt({xOffset:0,yOffset:0,orientation:i,usedKick:!1});const a=this.getKickTable({shape:n.getPolyominoShape(),rotateDirection:r,oldOrientation:o});if(null!=a)for(let r=0;r<a.length;r++){const o=a[r];if((o.y>=0||s)&&!n.collidesWith(o.x+t,o.y+e,i))return new Pt({xOffset:o.x,yOffset:o.y,orientation:i,usedKick:!0,mustUpgradeSpin:r>=3})}return null}}Mt.LEFT_X_KICKS=[[{x:1,y:0},{x:1,y:-1},{x:0,y:2},{x:1,y:2}],[{x:1,y:0},{x:1,y:1},{x:0,y:-2},{x:1,y:-2}],[{x:-1,y:0},{x:-1,y:-1},{x:0,y:2},{x:-1,y:2}],[{x:-1,y:0},{x:-1,y:1},{x:0,y:-2},{x:-1,y:-2}]],Mt.RIGHT_X_KICKS=[[{x:-1,y:0},{x:-1,y:-1},{x:0,y:2},{x:-1,y:2}],[{x:1,y:0},{x:1,y:1},{x:0,y:-2},{x:1,y:-2}],[{x:1,y:0},{x:1,y:-1},{x:0,y:2},{x:1,y:2}],[{x:-1,y:0},{x:-1,y:1},{x:0,y:-2},{x:-1,y:-2}]],Mt.DOUBLE_X_KICKS=[[{x:1,y:0},{x:-1,y:0},{x:0,y:-1},{x:0,y:1},{x:0,y:-2},{x:0,y:2}],[{x:0,y:1},{x:0,y:-1},{x:0,y:-2},{x:0,y:2},{x:-1,y:0},{x:1,y:0}],[{x:-1,y:0},{x:1,y:0},{x:0,y:1},{x:0,y:-1},{x:0,y:2},{x:0,y:-2}],[{x:0,y:1},{x:0,y:-1},{x:0,y:-2},{x:0,y:2},{x:1,y:0},{x:-1,y:0}]],Mt.LEFT_I_KICKS=[[{x:-1,y:0},{x:2,y:0},{x:-1,y:-2},{x:2,y:1}],[{x:2,y:0},{x:-1,y:0},{x:2,y:-1},{x:-1,y:2}],[{x:1,y:0},{x:-2,y:0},{x:1,y:2},{x:-2,y:-1}],[{x:-2,y:0},{x:1,y:0},{x:-2,y:1},{x:1,y:-2}]],Mt.RIGHT_I_KICKS=[[{x:-2,y:0},{x:1,y:0},{x:-2,y:1},{x:1,y:-2}],[{x:-1,y:0},{x:2,y:0},{x:-1,y:-2},{x:2,y:1}],[{x:2,y:0},{x:-1,y:0},{x:2,y:-1},{x:-1,y:2}],[{x:1,y:0},{x:-2,y:0},{x:1,y:2},{x:-2,y:-1}]],Mt.DOUBLE_I_KICKS=[[{x:-1,y:0},{x:-2,y:0},{x:1,y:0},{x:2,y:0}],[{x:0,y:1},{x:0,y:-1},{x:0,y:-2},{x:0,y:2}],[{x:1,y:0},{x:2,y:0},{x:-1,y:0},{x:-2,y:0}],[{x:0,y:1},{x:0,y:-1},{x:0,y:-2},{x:0,y:2}]];class Et extends class{constructor(){this.initialOrientation={i:0,j:0,l:0,o:0,s:0,t:0,z:0},this.offsets={i:[{x:0,y:0},{x:0,y:0},{x:0,y:0},{x:0,y:0}],j:[{x:0,y:0},{x:0,y:0},{x:0,y:0},{x:0,y:0}],l:[{x:0,y:0},{x:0,y:0},{x:0,y:0},{x:0,y:0}],o:[{x:0,y:0},{x:0,y:0},{x:0,y:0},{x:0,y:0}],s:[{x:0,y:0},{x:0,y:0},{x:0,y:0},{x:0,y:0}],t:[{x:0,y:0},{x:0,y:0},{x:0,y:0},{x:0,y:0}],z:[{x:0,y:0},{x:0,y:0},{x:0,y:0},{x:0,y:0}]}}}{constructor(){super(...arguments),this.wallkick=new Mt}}class It extends Array{shuffle(){for(let t=this.length-1;t>0;t--){const e=Math.floor(Math.random()*(t+1));[this[t],this[e]]=[this[e],this[t]]}}}class jt{constructor(){this.bagMultiplier=1,this.generator=this.generatorFunc()}*generatorFunc(){const t=new It;for(;;){if(0===t.length){for(let e=0;e<this.bagMultiplier;e++)t.push(...this.polyominoSet);t.shuffle()}yield t.pop()}}setPolyominoSet(t){this.polyominoSet=t}getNextPolyomino(){return this.generator.next().value}}class Ft extends Dt{constructor(){super(...arguments),this.path="retro-console"}getCoordinates(t){const{x:e,y:n}=Ft.getXY(t);return{x:this.gutterWidth+e*this.resolution+e*this.gutterWidth*2,y:this.gutterWidth+n*this.resolution+n*this.gutterWidth*2}}static getXY(t){if("bone"===t.color)return Ft.DATA.bone[t.level%2];if(t.holdIsLocked)switch(t.shape){case"i":case"t":case"o":return{x:2,y:4};default:return{x:3,y:4}}switch(t.shape){case"i":case"t":case"o":return Ft.DATA.ito[t.level%10];case"j":case"s":return Ft.DATA.js[t.level%10];case"l":case"z":return Ft.DATA.lz[t.level%10];case"brokenGarbage":return{x:0,y:4};case"solidGarbage":return{x:1,y:4};default:return{x:5,y:2}}}}Ft.DATA={ito:[{x:0,y:0},{x:3,y:0},{x:0,y:1},{x:0,y:0},{x:4,y:1},{x:1,y:2},{x:3,y:2},{x:0,y:3},{x:0,y:0},{x:3,y:2}],js:[{x:1,y:0},{x:4,y:0},{x:1,y:1},{x:1,y:0},{x:5,y:1},{x:0,y:2},{x:4,y:2},{x:1,y:3},{x:1,y:0},{x:4,y:2}],lz:[{x:2,y:0},{x:5,y:0},{x:2,y:1},{x:3,y:1},{x:0,y:2},{x:2,y:2},{x:5,y:2},{x:2,y:3},{x:4,y:2},{x:3,y:3}],bone:[{x:4,y:3},{x:5,y:3}]};class Ht{static load(t){if(null!==t.img)return;const e=document.createElement("img");e.src=t.skin.getUrl(),t.img=e}static loadAll(){for(const t of Object.keys(Ht.skins))Ht.load(Ht.skins[t])}}Ht.skins={standard:{skin:new class extends Ct{constructor(){super(...arguments),this.path="standard"}},img:null},srsX:{skin:new Lt,img:null},tetraX:{skin:new class extends Ct{constructor(){super(...arguments),this.path="tetra-x"}},img:null},arcadeWorld:{skin:new class extends Ct{constructor(){super(...arguments),this.path="arcade-world"}},img:null},arcadeClassic:{skin:new class extends Ct{constructor(){super(...arguments),this.path="arcade-classic"}},img:null},diamond:{skin:new class extends Ct{constructor(){super(...arguments),this.path="diamond"}},img:null},retroConsole:{skin:new Ft,img:null}};class Bt{constructor(){this.allowsGhost=!0,this.allowsHardDrop=!0,this.allowsHold=!0,this.allowsHoldBuffering=!0,this.allowsRotate180=!0,this.allowsRotateBuffering=!0,this.allowsRotateLeft=!0,this.allowsRotateRight=!0,this.allowsSoftDrop=!0,this.autoshiftType="standard",this.colors={i:"lightBlue",j:"blue",l:"orange",o:"yellow",s:"green",t:"purple",z:"red"},this.skin=Ht.skins.standard,this.entryDelay=100,this.entryDelayOnLineClear=100,this.hardDropLocksPieceInstantly=!0,this.hardDropExecutesOnlyOncePerPress=!0,this.hasLockOut=!0,this.hasPartialLockOut=!1,this.holdResetsPieceOrientation=!0,this.immediateDropOnSpawn=1,this.lineClearDelay=300,this.lockDelay=500,this.resetExpirationPenalty="instant-lock",this.lockDelayType="limited",this.matrixWidth=10,this.matrixHeight=20,this.matrixHiddenHeight=20,this.matrixHasCeiling=!1,this.maxAutoshiftDelay=Number.MAX_SAFE_INTEGER,this.maxAutoshiftRate=Number.MAX_SAFE_INTEGER,this.maxPiecePreviews=6,this.minAutoshiftDelay=-1,this.minAutoshiftRate=-1,this.moveAndRotateResetsAreShared=!0,this.moveResets=15,this.randomizer=new jt,this.resetLockDelayByFalling=!0,this.resetLockDelayByKicking=!1,this.resetLockDelayByMoving=!0,this.resetLockDelayByRotating=!0,this.resetResetsByFalling=!0,this.rotationResets=15,this.rotationSystem=new Et,this.skipEntryDelayOnHold=!1,this.skipEntryDelayOnMove=!1,this.skipEntryDelayOnRotate=!1,this.softDropCarriesBetweenPieces=!0,this.softDropLocksPieceInstantly=!1,this.softDropSpeed=20,this.softDropType="multiplicative",this.spawnOffsets={i:{x:3,y:-2},j:{x:3,y:-2},l:{x:3,y:-2},o:{x:4,y:-2},s:{x:3,y:-2},t:{x:3,y:-2},z:{x:3,y:-2}},this.suspendPieceUntilAction=!1}}class Nt extends class{constructor(){this.name="Dummy",this.polyominoSet=vt.TETROMINOES}getName(){return this.name}getLevel(){return 1}getStatsToDraw(){return[]}onGameStart(t){}onLockdown(t){}onNewPolyomino(t){}onStartOfTickBegin(t){}onStartOfTickEnd(t){}onEndOfTickBegin(t){}onEndOfTickEnd(t){}}{constructor(){super(...arguments),this.Rule=Bt,this.scoring=new Ot,this.name=X.t("modes:marathon.name"),this.level=1,this.standardLockDelay=0,this.standardLineClearDelay=0,this.engineStats={scoreAccumulated:0,linesCleared:0,polyominoesPlaced:0}}getStatsToDraw(){var t,e;return[{name:X.t("stats:level"),value:this.level.toString(),isLarge:!0},{name:X.t("stats:lines"),value:(null===(t=this.engineStats)||void 0===t?void 0:t.linesCleared.toString())+`<small>/${10*this.level}</small>`,isLarge:!0},{name:X.t("stats:placed"),value:null===(e=this.engineStats)||void 0===e?void 0:e.polyominoesPlaced.toString(),isLarge:!0}]}getLevel(){return this.level-1}onEndOfTickEnd(t){this.engineStats=t.getStats()}onGameStart(t){this.standardLockDelay=t.rule.lockDelay,this.standardLineClearDelay=t.rule.lineClearDelay}onNewPolyomino(t){const e=this.level;this.level>=40&&(t.rule.colors={i:"bone",j:"bone",l:"bone",o:"bone",s:"bone",t:"bone",z:"bone"}),this.level=Math.floor(t.getStats().linesCleared/10+1);const n=Math.pow(.8-.007*(this.level-1),this.level-1);t.getPolyominoController().setFallSpeedAsMsPerLine(1e3*n),this.level>=20?(t.getPolyominoController().setFallSpeedTo20G(),t.rule.lockDelay=this.standardLockDelay*Math.pow(.93,Math.pow(this.level-20,.8)),t.rule.lineClearDelay=this.standardLineClearDelay*Math.pow(.93,Math.pow(this.level-20,.8))):(t.rule.lockDelay=this.standardLockDelay,t.rule.lineClearDelay=this.standardLineClearDelay),this.level>e&&s.add("levelUp")}}class Ut extends pt{constructor(){super(),this.timePassed=0,Ht.loadAll()}doLogicTick(t){ut.isDevBuild()?Ut.goToNextRenderer():(this.timePassed+=t,this.timePassed>=500&&this.constructBrandLogo(),this.timePassed>=1500&&this.addFadeToBrandLogo(),this.timePassed>=2e3&&this.constructAuthorLogo(),this.timePassed>=3500&&this.addFadeToAuthorLogo(),this.timePassed>=4e3&&Ut.goToNextRenderer())}static goToNextRenderer(){ut.setRender(new Tt(Nt))}constructBrandLogo(){this.brandLogoElement=document.createElement("h1"),this.brandLogoElement.textContent="Tetra Developer Studio",ut.getRendererContainer().appendChild(this.brandLogoElement),this.constructBrandLogo=()=>{}}addFadeToBrandLogo(){this.brandLogoElement.classList.add("splash-fade-out"),this.addFadeToBrandLogo=()=>{}}constructAuthorLogo(){ht(ut.getRendererContainer()),this.authorLogoElement=document.createElement("h1"),this.authorLogoElement.innerHTML=X.t("rootMenu:createdBy",{author:"<div>Dr Ocelot</div>",interpolation:{escapeValue:!1}}),this.authorLogoElement.classList.add("splash-fade-in"),ut.getRendererContainer().appendChild(this.authorLogoElement),this.constructAuthorLogo=()=>{}}addFadeToAuthorLogo(){this.authorLogoElement.classList.remove("splash-fade-in"),ft(this.authorLogoElement),this.authorLogoElement.classList.add("splash-fade-out"),this.addFadeToAuthorLogo=()=>{}}}(function(){return t=this,e=void 0,r=function*(){return yield X.init({lng:"en-US",fallbackLng:"en-US",debug:ut.isDevBuild(),resources:{"en-US":{controls:q,rootMenu:Z,gameUi:tt,modes:nt,stats:ot}}})},new((n=void 0)||(n=Promise))((function(o,i){function s(t){try{u(r.next(t))}catch(t){i(t)}}function a(t){try{u(r.throw(t))}catch(t){i(t)}}function u(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(s,a)}u((r=r.apply(t,e||[])).next())}));var t,e,n,r})().then((()=>{ut.isDevBuild()&&(it.controls.rotateRight=["KeyX"],it.controls.hardDrop=["ArrowUp"],it.controls.rotate180=["KeyS"],it.config.autoshiftDelay=150,it.config.autoshiftRate=15,it.config.autoshiftBuffering="instant"),ut.init(),ut.setRender(new Ut),s.loadSounds(s.soundbanks.system),s.setSoundbank(s.soundbanks.tetrax)}))}},r={};function o(t){var e=r[t];if(void 0!==e)return e.exports;var i=r[t]={id:t,loaded:!1,exports:{}};return n[t].call(i.exports,i,i.exports,o),i.loaded=!0,i.exports}e=Object.getPrototypeOf?t=>Object.getPrototypeOf(t):t=>t.__proto__,o.t=function(n,r){if(1&r&&(n=this(n)),8&r)return n;if("object"==typeof n&&n){if(4&r&&n.__esModule)return n;if(16&r&&"function"==typeof n.then)return n}var i=Object.create(null);o.r(i);var s={};t=t||[null,e({}),e([]),e(e)];for(var a=2&r&&n;"object"==typeof a&&!~t.indexOf(a);a=e(a))Object.getOwnPropertyNames(a).forEach((t=>s[t]=()=>n[t]));return s.default=()=>n,o.d(i,s),i},o.d=(t,e)=>{for(var n in e)o.o(e,n)&&!o.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:e[n]})},o.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),o.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),o.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},o.nmd=t=>(t.paths=[],t.children||(t.children=[]),t),o(607)})();